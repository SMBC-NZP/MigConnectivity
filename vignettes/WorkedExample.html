<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeffrey A. Hostetler, Michael T. Hallworth" />

<meta name="date" content="2023-08-01" />

<title>Preparing data to estimate transition probabilites and/or migratory connecitivity using the ‘MigConnectivity’ package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Preparing data to estimate transition
probabilites and/or migratory connecitivity using the ‘MigConnectivity’
package</h1>
<h4 class="author">Jeffrey A. Hostetler, Michael T. Hallworth</h4>
<h4 class="date">2023-08-01</h4>



<p>This vignette is intended to help users structure their data for
analysis using the MigConnectivity package. There are many ways to
derive the data needed for analyis and below, we provided examples and
code as a reference for users. However, the most appropriate methods and
approaches for particular questions and data types should be considered
by the users.</p>
<p>There are examples at the end of this vignette that illustrate ways
to calculate bias and variance metrics using light-level geolocator data
derived from the <a href="#SGAT_bias">SGAT</a> and <a href="#FLightR_bias">FLightR</a> packages.</p>
<div id="using-data-integration-to-estimate-the-strength-of-migratory-connectivitiy" class="section level2">
<h2>Using data integration to estimate the strength of migratory
connectivitiy</h2>
<p>This MigConnectivity package provides tools for estimating the
pattern and strength of migratory connectivity. We’ve developed methods
to integrate intrinsic markers, tracking, and long-distance band
reencounter data collected from the same or different individuals. The
package functionality includes integrated analyses that account for
differences in precision, bias, reencounter probability, and
directionality among different data types (banding reencounter,
light-level geolocator, stable isotopes in tissues, genetics, and GPS).
The package separates estimation of migratory connectivity into two new
functions: estTransition and estStrength. The <code>estTransition</code>
function estimates transition probabilities from seasonal movement data
(i.e. pattern of movement) and the <code>estStrength</code> estimates
the strength of migratory connectivity from transition probabilities.
Below we provide a worked example using Yellow Warbler (<i>Setophaga
petechia</i>) data to help users format their data to use the new
functionality in the MigConnectivity package.</p>
<div id="define-target-sites" class="section level3">
<h3>Define Target Sites</h3>
<p>There are multiple published Yellow Warbler data sets that can be
used to estimate Mmgratory connecitivity (MC). Here, we illustrate how
to integrate stable-isotopes, genetic data, and light-level geolocators
to estimate MC. The Yellow Warbler genoscape identifies 5 genetically
distinct breeding populations (Arctic, Pacific Northwest, Southwest,
Central, and East) from 419 sampled individuals at 50 breeding locations
<span class="citation">(Bay et al. 2021)</span>. We identified 4
nonbreeding regions using ecoregions which include the Pacific and
Central Mexico, Atlantic Lowland Mexico, Central America and South
America.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Yellow Warbler target regions. The breeding regions
are defined by genoscape-defined populations and the nonbreeding regions
were identified by ecoregions across the ranges</p>
</div>
</div>
<div id="define-origin-sites" class="section level3">
<h3>Define Origin Sites</h3>
<p>The Yellow Warbler has published genoscape and isotope data on
migratory movements from birds captured and sampled in the nonbreeding
season and geolocators on birds captured in the breeding season. Genetic
sampling of 203 individuals occurred at 20 locations across the
nonbreeding range, from Baja Mexico, south through central Mexico,
Central America (Costa Rica and Nicaragua), and South America (Trinidad
and Venezuela) <span class="citation">(Bay et al. 2021)</span> and the
isotope samples were collected at one nonbreeding site in western Mexico
(n = 210) <span class="citation">(Valdez-Juárez et al. 2018)</span>.</p>
<p>Below we create a vector of the origin names. These names correspond
with the genoscape.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load shapefile of origin sites derived from genoscape data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>YEWA_origin_sites <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">&quot;originSitesYEWA.shp&quot;</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vector of origin names </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>originNames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Arctic&quot;</span>, <span class="st">&quot;Pacific Northwest&quot;</span>, <span class="st">&quot;Southwest&quot;</span>, <span class="st">&quot;Central&quot;</span>, <span class="st">&quot;East&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># object with the number of originSites </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>nOriginSites <span class="ot">&lt;-</span> <span class="dv">5</span></span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Yellow Warbler target regions. The breeding regions
are defined by genoscape-defined populations and the nonbreeding regions
were identified by ecoregions across the ranges</p>
</div>
</div>
<div id="sample-data" class="section level3">
<h3>Sample data</h3>
<p>For information about sampling and assignment methods see Bay et
al. (2021) for genetics, Valdez-Juárez et al. (2018) for isotopes, and
Witynski and Bonter (2018) for geolocators.</p>
</div>
<div id="load-the-genetic-sample-data" class="section level3">
<h3>Load the genetic sample data</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read in the data </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>genetic_samples <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;YEWA_nonbreeding_genetic_samples.txt&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(genetric_samples,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    203 obs. of  12 variables:
##  $ mixture_collection: Factor w/ 1 level &quot;mixture&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ indiv             : Factor w/ 203 levels &quot;02N0291&quot;,&quot;04N8955&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Alaska            : num  6.16e-03 1.91e-17 1.86e-18 1.38e-20 5.45e-11 ...
##  $ Central           : num  1.34e-29 1.00 1.00 1.00 9.98e-01 ...
##  $ Southwest         : num  1.29e-03 1.50e-09 3.67e-09 4.26e-11 1.62e-03 ...
##  $ East              : num  9.57e-66 2.24e-11 7.78e-11 1.69e-10 1.49e-17 ...
##  $ WesternBoreal     : num  9.93e-01 1.41e-16 5.49e-18 2.65e-20 1.07e-08 ...
##  $ State             : Factor w/ 14 levels &quot;Ahuachapan&quot;,&quot;Baja California Sur&quot;,..: 4 5 5 5 5 5 5 5 5 5 ...
##  $ Town              : Factor w/ 20 levels &quot;Celestun&quot;,&quot;Chamela&quot;,..: 5 6 6 6 6 6 6 6 6 6 ...
##  $ Stage             : Factor w/ 1 level &quot;Wintering&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ longitude         : num  -86 -85.6 -85.6 -85.6 -85.6 ...
##  $ latitude          : num  11.8 10.6 10.6 10.6 10.6 10.6 10.6 10.6 10.6 10.6 ...</code></pre>
<p>The genetic data have the probabilty that each individual is assigned
to a specific genetic population. These data are used during the
resampling process to estimate transition probabilities and the strength
of MC. Below, we format the data so we can easily use it in our
analysis.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that we re-order the probabilites to match the order of originNames #</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>YEWA_genetics <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(genetic_samples[,<span class="fu">c</span>(<span class="st">&quot;Alaska&quot;</span>,<span class="st">&quot;WesternBoreal&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;Southwest&quot;</span>,<span class="st">&quot;Central&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;East&quot;</span>)])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># give names to the object</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(YEWA_genetics) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">as.character</span>(genetic_samples<span class="sc">$</span>indiv), </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                                originNames)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Double-check that all rows sum to 1</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rowSums</span>(YEWA_genetics))</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##       1       1       1       1       1       1</code></pre>
<p>Convert the data into a spatial object</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data into spatial object </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>targetPoints_genetic <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(genetic_samples[,<span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>)],</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">crs =</span> <span class="dv">4326</span>) <span class="co"># WGS84</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the data type to the spatial layer </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>targetPoints_genetic<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;Genetics Capture&quot;</span></span></code></pre></div>
</div>
<div id="load-the-hydrogen-stable-isotope-data" class="section level3">
<h3>Load the hydrogen stable isotope data</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>isotope_samples <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;YEWA isotopes Jalisco.csv&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(isotope_samples)</span></code></pre></div>
<p>convert the data into a spatial object</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data into spatial object </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>targetPoints_iso <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(isotope_samples[,<span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)],</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">crs =</span> <span class="dv">4326</span>) <span class="co"># WGS84</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the data type to the spatial layer </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>targetPoints_iso<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;Isotope Capture&quot;</span></span></code></pre></div>
<p>For hydrogen stable isotope, we generate probabilistic origin
surfaces (i.e., rasters) for each isotope sample using the
<code>isoAssign</code> function available in the R package
MigConnectivity.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make isotope assignments </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>isoRasterYEWA <span class="ot">&lt;-</span> <span class="fu">isoAssign</span>(<span class="at">isovalues =</span> isotope_samples<span class="sc">$</span>Delta,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">isoSTD =</span> <span class="fl">18.3</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">intercept =</span> <span class="sc">-</span><span class="fl">28.67</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">slope =</span> <span class="fl">0.59</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sppShapefile =</span> YEWA_origin_sites)</span></code></pre></div>
</div>
<div id="load-the-light-level-geolocator-data" class="section level3">
<h3>Load the light-level geolocator data</h3>
<p>We obtained location estimates from seven individuals tracked using
light-level geolocators deployed and recovered in Maine (n = 4) and
Wisconsin (n = 3; Witynski &amp; Bonter, 2018). We used the daily
location estimates while individuals remained on the breeding grounds to
derive location bias and uncertainty estimates. The geolocator data were
processed and reported by <span class="citation">Witynski and Bonter
(2018)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture locations #</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># See dates and summary data from Table 1. page 44.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #129</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #132</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #136</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #137</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Wisconsin #139</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Wisconsin #144</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Wisconsin #146</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>caplocs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">70.6142</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">87.8123</span>,<span class="dv">3</span>)),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">42.9891</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="fl">42.5000</span>,<span class="dv">3</span>)))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Departures #</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>departs <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">&quot;2015-09-04&quot;</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;2015-08-22&quot;</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;2015-09-04&quot;</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;2015-08-28&quot;</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;2015-08-24&quot;</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;2015-08-24&quot;</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;2015-08-30&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the daily location data #</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>EstLocs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Yellow Warbler_Witynski.csv&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make it spatial </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>YEWA_gl_locs <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(EstLocs,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;location.long&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;location.lat&quot;</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">crs =</span> <span class="dv">4326</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarized nonbreeding locations reported in Witynski and Bonter</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>YEWA_GL_nb <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">bird =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">129</span>,<span class="dv">132</span>,<span class="dv">136</span>,<span class="dv">137</span>,<span class="dv">139</span>,<span class="dv">144</span>,<span class="dv">146</span>)),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">long =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">75.09</span>,<span class="sc">-</span><span class="fl">74.81</span>,<span class="sc">-</span><span class="fl">74.30</span>,<span class="sc">-</span><span class="fl">74.21</span>,<span class="sc">-</span><span class="fl">68.72</span>,<span class="sc">-</span><span class="fl">67.08</span>,<span class="sc">-</span><span class="fl">65.39</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">lat =</span> <span class="fu">c</span>(<span class="fl">10.03</span>,<span class="fl">8.52</span>,<span class="fl">10.51</span>,<span class="fl">3.14</span>,<span class="fl">0.96</span>,<span class="fl">5.73</span>,<span class="fl">6.67</span>)),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;long&quot;</span>,<span class="st">&quot;lat&quot;</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># assign type to GL spatial object</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>YEWA_GL_nb<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;GL Estimated Target&quot;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the capture locations to a spatial object</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>YEWA_GL_breed <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">bird =</span> <span class="fu">c</span>(<span class="dv">129</span>,<span class="dv">132</span>,<span class="dv">136</span>,<span class="dv">137</span>,<span class="dv">139</span>,<span class="dv">144</span>,<span class="dv">146</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">longitude =</span> caplocs[,<span class="dv">1</span>],</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">latitude =</span> caplocs[,<span class="dv">2</span>]),</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># assign type to GL spatial object</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>YEWA_GL_breed<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;GL Capture&quot;</span></span></code></pre></div>
<p>Calculate location bias and covariance which are used to estimate MC
(<code>estStrength</code>) or estimate transition probabilities
(<code>estTransition</code>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># project from WGS84 into meters #</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>YEWAmeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWA_gl_locs,<span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>CapMeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWA_GL_breed, <span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># split birds into their own data #</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>YEWAests <span class="ot">&lt;-</span> <span class="fu">split</span>(YEWAmeters,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">f =</span> YEWAmeters<span class="sc">$</span><span class="st">&#39;individual.local.identifier&#39;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Empirical estimates of bias and vcov, but on mean locations by bird</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>ests2 <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="at">x =</span> YEWAests,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">lats =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">2</span>],</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">lng =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">1</span>],</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">z =</span> departs,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x,lats,lng,z){</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>              <span class="co"># keep only data from deployment until departure from breeding #</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                  newdata <span class="ot">&lt;-</span> x[x<span class="sc">$</span>timestamp<span class="sc">&lt;</span>z,]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>              <span class="co"># calculate the difference in meters from estimated location</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>              <span class="co"># to actual capture location</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                  long <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">1</span>]) <span class="sc">-</span> lng</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                  lat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">2</span>]) <span class="sc">-</span> lats</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">difflong =</span> long,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">difflat =</span> lat))},</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">SIMPLIFY =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>(geoBiasYEWA <span class="ot">&lt;-</span> <span class="fu">apply</span>(ests2, <span class="dv">1</span>, mean)) <span class="co">#Bias</span></span></code></pre></div>
<pre><code>##  difflong   difflat 
## -6512.898 50964.969</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(geoVCovYEWA <span class="ot">&lt;-</span> <span class="fu">cov</span>(<span class="fu">t</span>(ests2))) <span class="co">#Variance-covariance matrix</span></span></code></pre></div>
<pre><code>##            difflong    difflat
## difflong  259401516 -894387951
## difflat  -894387951 4708578511</code></pre>
</div>
<div id="set-up-input-to-run-esttransition" class="section level3">
<h3>Set up input to run estTransition</h3>
<p>The following code creates objects that are needed and/or helpful
when using the <code>estStrength</code> or <code>estTransition</code>
functions.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set up input for running in estTransition or estStrength</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of geolocator birds </span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>nGL <span class="ot">&lt;-</span> <span class="fu">nrow</span>(YEWA_GL_breed)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We have 0 birds with telemetry data</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>nTelemetry <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># How many birds have raster data (isotopes)</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>nRaster <span class="ot">&lt;-</span> <span class="fu">nrow</span>(isotope_samples)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># How many birds have probability data (genetics)</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>nProb <span class="ot">&lt;-</span> <span class="fu">nrow</span>(YEWA_genetics)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of animals </span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>nAnimals <span class="ot">&lt;-</span> nGL <span class="sc">+</span> nTelemetry <span class="sc">+</span> nRaster <span class="sc">+</span> nProb</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a vector of TRUE/FALSE indicating if the individual </span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># has Geolocator data </span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>isGLYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">c</span>(nGL, nTelemetry <span class="sc">+</span> nRaster <span class="sc">+</span> nProb))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector indicating whether an individual has telemetry data </span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>isTelemetryYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, nAnimals)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector indicating whether an individual has raster assignment data </span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>isRasterYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">c</span>(nGL <span class="sc">+</span> nTelemetry, nRaster, nProb))</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector indicating whether an individual has probability data </span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>isProbYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="fu">c</span>(nGL <span class="sc">+</span> nTelemetry <span class="sc">+</span> nRaster, nProb))</span></code></pre></div>
<p>Now that we have objects that tell the function which type of data
are associated with each individual we can set up the spatial data.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine all the target locations into a single object </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co"> - we reorder the columns to match between the data sets</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>targetPointsYEWA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(YEWA_GL_nb[,<span class="fu">c</span>(<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;geometry&quot;</span>)],</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                          targetPoints_iso[,<span class="fu">c</span>(<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;geometry&quot;</span>)],</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                          targetPoints_genetic[,<span class="fu">c</span>(<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;geometry&quot;</span>)])</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform (re-project the data) into Equidistant conic projection</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>targetPointsYEWA <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(targetPointsYEWA, <span class="st">&quot;ESRI:102010&quot;</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A vector indicating where the birds were captured </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>capturedYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;origin&quot;</span>, <span class="st">&quot;target&quot;</span>), <span class="fu">c</span>(nGL, nTelemetry <span class="sc">+</span> nRaster <span class="sc">+</span> nProb))</span></code></pre></div>
<p>Here we do some spatial analyses to determine target sites from the
data we’ve gathered so far. These data are needed for the analysis.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Where birds were captured in the origin sites (i.e., geolocators)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>originPointsYEWA <span class="ot">&lt;-</span> CapMeters</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform (re-project) data into Equidistant conic projection </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>targetSitesYEWA <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(YEWA_target_sites, <span class="st">&quot;ESRI:102010&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of the target assignments of the input data</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>targetAssignment <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">unclass</span>(sf<span class="sc">::</span><span class="fu">st_intersects</span>(<span class="at">x =</span> targetPointsYEWA,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">y =</span> targetSitesYEWA,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">sparse =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set any target assignment that results in 0 to NA</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>targetAssignment[<span class="fu">lengths</span>(targetAssignment)<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from a list to an array #</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>targetAssignment <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">unlist</span>(targetAssignment))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># If the assignment is NA - assign to the nearsest targetSite</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>targetAssignment[<span class="fu">is.na</span>(targetAssignment)] <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_nearest_feature</span>(<span class="at">x =</span> targetPointsYEWA[<span class="fu">is.na</span>(targetAssignment),],</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">y =</span> targetSitesYEWA)</span></code></pre></div>
</div>
<div id="abundance-estimates" class="section level3">
<h3>Abundance estimates</h3>
<p>Accounting for relative abundance is an important component when
estimating migratory connectivity or estimating transition probabilities
between two or more phases of the annual cycle.</p>
<p>Below, we use eBird.org products to estimate abundance. Note - users
may need to create an account and get permission to access eBird data.
See information on to <a href="https://science.ebird.org/en/use-ebird-data/download-ebird-data-products">Download
eBird data products</a>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data from eBird </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ebirdst)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the ebird median abundance weekly cube data</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>rastAbundMed <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">brick</span>(<span class="st">&quot;yelwar-ERD2019-STATUS-20200930-e26043a8_lr_2019_abundance_median.tif&quot;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># assign the correct dates to the raster layers</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>rastAbundMed <span class="ot">&lt;-</span> <span class="fu">label_raster_stack</span>(rastAbunMed)</span></code></pre></div>
<pre><code>## Please cite the eBird Status &amp; Trends data using: 
##   Fink, D., T. Auer, A. Johnston, M. Strimas-Mackey, O. Robinson, S. Ligocki, W. Hochachka, 
##   C. Wood, I. Davies, M. Iliff, L. Seitz. 2020. eBird Status and Trends, 
##   Data Version: 2019; Released: 2020 Cornell Lab of Ornithology, Ithaca, New York. 
##   https://doi.org/10.2173/ebirdst.2019</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.4.0     v purrr   0.3.4
## v tibble  3.1.6     v dplyr   1.0.8
## v tidyr   1.2.0     v stringr 1.4.0
## v readr   2.1.2     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x ggplot2::arrow() masks terra::arrow()
## x tidyr::extract() masks terra::extract()
## x dplyr::filter()  masks stats::filter()
## x dplyr::lag()     masks stats::lag()
## x dplyr::src()     masks terra::src()</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dates for each abundance layer </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>weeks <span class="ot">&lt;-</span> <span class="fu">parse_raster_dates</span>(rastAbundMed)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>run_review <span class="ot">&lt;-</span> <span class="fu">subset</span>(ebirdst_runs, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                     species_code <span class="sc">==</span> <span class="st">&quot;yelwar&quot;</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>yelwar_dates <span class="ot">&lt;-</span> run_review <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># just keep the seasonal definition columns</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">setdiff</span>(<span class="fu">matches</span>(<span class="st">&quot;(start)|(end)&quot;</span>), <span class="fu">matches</span>(<span class="st">&quot;year_round&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># transpose</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;label&quot;</span>, <span class="st">&quot;date&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spread data so start and end dates are in separate columns</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(label, <span class="fu">c</span>(<span class="st">&quot;season&quot;</span>, <span class="st">&quot;start_end&quot;</span>), <span class="st">&quot;_(?=s|e)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(start_end, date) <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(season, <span class="at">start_dt =</span> start, <span class="at">end_dt =</span> end) <span class="sc">%&gt;%</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(season <span class="sc">!=</span> <span class="st">&quot;resident&quot;</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># did the season pass review</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>quality_rating <span class="ot">&lt;-</span> run_review[<span class="fu">paste0</span>(yelwar_dates<span class="sc">$</span>season, <span class="st">&quot;_quality&quot;</span>)]</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>yelwar_dates<span class="sc">$</span>pass <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(quality_rating) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the weeks that represent breeding and non-breeding</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>weeks_season <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA_character_</span>, <span class="fu">length</span>(weeks))</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(yelwar_dates))) {</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> yelwar_dates[i, ]</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># skip seasonal assignment if season failed</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>s<span class="sc">$</span>pass) {</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>()</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># handle seasons cross jan 1 separately</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (s<span class="sc">$</span>start_dt <span class="sc">&lt;=</span> s<span class="sc">$</span>end_dt) {</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    in_season <span class="ot">&lt;-</span> weeks <span class="sc">&gt;=</span> s<span class="sc">$</span>start_dt <span class="sc">&amp;</span> weeks <span class="sc">&lt;=</span> s<span class="sc">$</span>end_dt</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    in_season <span class="ot">&lt;-</span> weeks <span class="sc">&gt;=</span> s<span class="sc">$</span>start_dt <span class="sc">|</span> weeks <span class="sc">&lt;=</span> s<span class="sc">$</span>end_dt</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>  weeks_season[in_season] <span class="ot">&lt;-</span> s<span class="sc">$</span>season</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">which</span>(weeks_season <span class="sc">==</span> <span class="st">&#39;breeding&#39;</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">which</span>(weeks_season <span class="sc">==</span> <span class="st">&#39;nonbreeding&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Project the target and origin sites in the projection of the eBird abundance</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so abundance data aren&#39;t changed while projecting </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>originSitesProj <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWA_origin_sites, <span class="fu">st_crs</span>(rastAbundMed))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>targetSitesProj <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWA_target_sites, <span class="fu">st_crs</span>(rastAbundMed))</span></code></pre></div>
</div>
<div id="extract-nonbreeding-relative-abundance-estimates" class="section level3">
<h3>Extract nonbreeding relative abundance estimates</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract winter raster values for each region </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>weekly_region_vals  <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(rastAbundMed[[w]],targetSitesProj)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   35.55    3.97   39.87</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(weekly_region_vals)</span></code></pre></div>
<pre><code>## List of 4
##  $ : num [1:677, 1:14] 0.00464 0.01825 0 0 0 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:14] &quot;w2019.01.04&quot; &quot;w2019.01.11&quot; &quot;w2019.01.18&quot; &quot;w2019.01.25&quot; ...
##  $ : num [1:493, 1:14] 0.00825 0.0094 0 0 0 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:14] &quot;w2019.01.04&quot; &quot;w2019.01.11&quot; &quot;w2019.01.18&quot; &quot;w2019.01.25&quot; ...
##  $ : num [1:753, 1:14] 0.843 0.754 0.62 0.927 0.458 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:14] &quot;w2019.01.04&quot; &quot;w2019.01.11&quot; &quot;w2019.01.18&quot; &quot;w2019.01.25&quot; ...
##  $ : num [1:3188, 1:14] 0.553 0.512 0.486 0.515 0.672 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:14] &quot;w2019.01.04&quot; &quot;w2019.01.11&quot; &quot;w2019.01.18&quot; &quot;w2019.01.25&quot; ...</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sumByWeek <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weekly_region_vals, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">apply</span>(x, <span class="dv">2</span>, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)})</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>regionSum <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sumByWeek, max)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>relAbundYEWAWint <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">unlist</span>(regionSum))</span></code></pre></div>
<p>Extract breeding relative abundance estimates</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract breeding raster values for each region </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>weekly_region_vals  <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(rastAbundMed[[b]],originSitesProj)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   14.46    0.15   14.67</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(weekly_region_vals)</span></code></pre></div>
<pre><code>## List of 5
##  $ : num [1:3795, 1:4] NA NA NA NA NA 0 0 0 NA NA ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:4] &quot;w2019.06.21&quot; &quot;w2019.06.28&quot; &quot;w2019.07.06&quot; &quot;w2019.07.13&quot;
##  $ : num [1:3308, 1:4] 1.26 1.21 1.38 1.65 1.31 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:4] &quot;w2019.06.21&quot; &quot;w2019.06.28&quot; &quot;w2019.07.06&quot; &quot;w2019.07.13&quot;
##  $ : num [1:5366, 1:4] 2.279 0.12 0.291 0.767 1.524 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:4] &quot;w2019.06.21&quot; &quot;w2019.06.28&quot; &quot;w2019.07.06&quot; &quot;w2019.07.13&quot;
##  $ : num [1:4143, 1:4] 0.625 0.64 0.702 0.232 0.227 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:4] &quot;w2019.06.21&quot; &quot;w2019.06.28&quot; &quot;w2019.07.06&quot; &quot;w2019.07.13&quot;
##  $ : num [1:4654, 1:4] NA NA NA NA NA NA NA NA NA NA ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:4] &quot;w2019.06.21&quot; &quot;w2019.06.28&quot; &quot;w2019.07.06&quot; &quot;w2019.07.13&quot;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>sumByWeek <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weekly_region_vals, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">apply</span>(x, <span class="dv">2</span>, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)})</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>regionSum <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sumByWeek, max)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>relAbundYEWABreed <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">unlist</span>(regionSum))</span></code></pre></div>
<p>We now have all the data in order to run the
<code>estTransition</code> or <code>estStrength</code> functions.</p>
<p>Note - there was no overlap of data sources for individuals, i.e., we
only had one type of data for each bird - so we set the overlap setting
to “none”.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Run analysis for psi</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>((psiYEWA <span class="ot">&lt;-</span> <span class="fu">estTransition</span>(<span class="at">originSites =</span> YEWA_origin_sites,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">targetSites =</span> YEWA_target_sites,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">originPoints =</span> originPointsYEWA,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">targetPoints =</span> targetPointsYEWA,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">originAssignment =</span> YEWA_genetics,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">originNames =</span> originNames,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">targetNames =</span> targetNames,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nSamples =</span> <span class="dv">10</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">isGL =</span> isGLYEWA,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">isTelemetry =</span> isTelemetryYEWA,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">isRaster =</span> isRasterYEWA,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">isProb =</span> isProbYEWA,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">captured =</span> capturedYEWA,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">geoBias =</span> geoBiasYEWA,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">geoVCov =</span> geoVCovYEWA,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">originRaster =</span> isoRasterYEWA,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">verbose =</span> <span class="dv">2</span>, </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">maxTries =</span> <span class="dv">400</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">resampleProjection =</span> <span class="fu">st_crs</span>(YEWA_origin_sites),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">nSim =</span> <span class="dv">10</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">dataOverlapSetting =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">targetRelAbund =</span> relAbundYEWAWint)))</span></code></pre></div>
<pre><code>## Configuring data overlap settings</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 1</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 2</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 3</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 4</code></pre>
<pre><code>## Creating targetAssignment
## Not all target capture locations are within targetSites. Assigning to closest site</code></pre>
<pre><code>## Warning in estTransitionBoot(isGL = isGL, isTelemetry = isTelemetry, isRaster = isRaster, : Not all target capture locations are within targetSites. Assigning to closest site.
## Affects animals: 343,344,345,346,347,348,349,350,351,352,353,354,355,356,394,399,400,401,402</code></pre>
<pre><code>## Checking if single cell origin points in originSites, may take a moment
## Starting bootstrap
## Bootstrap Run 1 of 10 at Tue Aug 01 16:31:52 2023 
## Bootstrap Run 2 of 10 at Tue Aug 01 16:31:53 2023 
## Bootstrap Run 3 of 10 at Tue Aug 01 16:31:55 2023 
## Bootstrap Run 4 of 10 at Tue Aug 01 16:31:56 2023 
## Bootstrap Run 5 of 10 at Tue Aug 01 16:31:57 2023 
## Bootstrap Run 6 of 10 at Tue Aug 01 16:32:00 2023 
## Bootstrap Run 7 of 10 at Tue Aug 01 16:32:01 2023 
## Bootstrap Run 8 of 10 at Tue Aug 01 16:32:03 2023 
## Bootstrap Run 9 of 10 at Tue Aug 01 16:32:05 2023 
## Bootstrap Run 10 of 10 at Tue Aug 01 16:32:07 2023</code></pre>
<pre><code>##    user  system elapsed 
##  219.39   32.52  254.75</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at the results # </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>psiYEWA</span></code></pre></div>
<pre><code>## Migratory Connectivity Estimates
## 
## Transition probability (psi) estimates (mean):
##                   Pacific and Central Mexico Atlantic Lowland Mexico
## Arctic                               0.41694                  0.4610
## Pacific Northwest                    0.25444                  0.2292
## Southwest                            0.18294                  0.1075
## Central                              0.00520                  0.1366
## East                                 0.00372                  0.0000
##                   Central America South America
## Arctic                     0.1220        0.0000
## Pacific Northwest          0.5163        0.0000
## Southwest                  0.7095        0.0000
## Central                    0.6318        0.2264
## East                       0.0000        0.9963
## +/- SE:
##                   Pacific and Central Mexico Atlantic Lowland Mexico
## Arctic                              0.046852                 0.04312
## Pacific Northwest                   0.045349                 0.06522
## Southwest                           0.049670                 0.04185
## Central                             0.006021                 0.02258
## East                                0.006007                 0.00000
##                   Central America South America
## Arctic                    0.03565      0.000000
## Pacific Northwest         0.07317      0.000000
## Southwest                 0.06083      0.000000
## Central                   0.05779      0.040729
## East                      0.00000      0.006007
## 95% confidence interval (simple quantile):
##                   Pacific and Central Mexico Atlantic Lowland Mexico
## Arctic            0.33333 - 0.50000          0.38983 - 0.52809      
## Pacific Northwest 0.16456 - 0.30769          0.12941 - 0.32836      
## Southwest         0.09615 - 0.23214          0.03846 - 0.19608      
## Central           0.00000 - 0.01695          0.10687 - 0.17822      
## East              0.00000 - 0.01333          0.00000 - 0.00000      
##                   Central America   South America    
## Arctic            0.06542 - 0.17284 0.00000 - 0.00000
## Pacific Northwest 0.43077 - 0.63291 0.00000 - 0.00000
## Southwest         0.64286 - 0.86538 0.00000 - 0.00000
## Central           0.51282 - 0.71845 0.15534 - 0.30769
## East              0.00000 - 0.00000 0.98667 - 1.00000
## 
## This is a subset of what&#39;s available inside this estMigConnectivity output.
## For more info, try ?estTransition or ?estMC or str(obj_name, max.levels = 2).</code></pre>
<p>Plot the results using the built-in plotting function</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(psiYEWA, <span class="at">legend =</span> <span class="st">&quot;topleft&quot;</span>, <span class="at">cex =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Estimated transition probabilities of the Yellow
Warbler between breeding and nonbreeding periods</p>
</div>
</div>
</div>
<div id="calculating-location-bias-and-covariance-structure-to-resample-light-level-geolocator-data" class="section level2">
<h2>Calculating location bias and covariance structure to resample
light-level geolocator data</h2>
<div id="SGAT_bias" class="section level4">
<h4>SGAT</h4>
<p>The code below is a repeatable example for how to calculate location
bias and location error using coordinates derived from light-level
geolocators (see <span class="citation">Cohen et al. (2018)</span>)
analyzed using the SGAT package <span class="citation">(Wotherspoon
2017, Lisovski et al. 2020)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in projections</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;projections&quot;</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define deployment locations (winter) # </span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>captureLocations<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.93</span>,<span class="fl">18.04</span>,   <span class="co"># Jamaica</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">-</span><span class="fl">80.94</span>,<span class="fl">25.13</span>,   <span class="co"># Florida</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">-</span><span class="fl">66.86</span>,<span class="fl">17.97</span>),  <span class="co"># Puerto Rico</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(captureLocations) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert capture locations into SpatialPoints #</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>CapLocs <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(captureLocations),</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Project Capture locations # </span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>CapLocsM<span class="ot">&lt;-</span>sf<span class="sc">::</span><span class="fu">st_transform</span>(CapLocs, <span class="st">&#39;ESRI:54027&#39;</span>)</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve raw non-breeding locations from github </span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="co"># First grab the identity of the bird so we can loop through the files </span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="co"># For this example we are only interested in the error </span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="co"># around non-breeding locations </span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># here we grab only the birds captured during the non-breeding season </span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Using paste0 for vignette formatting purposes</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>winterBirds <span class="ot">&lt;-</span> <span class="fu">dget</span>(<span class="fu">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/&quot;</span>,</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;SMBC-NZP/MigConnectivity/master/&quot;</span>,</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;data-raw/GL_NonBreedingFiles/winterBirds.txt&quot;</span>))</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="co"># create empty list to store the location data #</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>Non_breeding_files <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&#39;list&#39;</span>,<span class="fu">length</span>(winterBirds))</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Get raw location data from Github #</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(winterBirds)){</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>Non_breeding_files[[i]] <span class="ot">&lt;-</span> <span class="fu">dget</span>(<span class="fu">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/&quot;</span>,</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;SMBC-NZP/MigConnectivity/master/data-raw/&quot;</span>,</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;GL_NonBreedingFiles/NonBreeding_&quot;</span>,</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>                                        winterBirds[i],<span class="st">&quot;.txt&quot;</span>))</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove locations around spring Equinox and potential migration points</span></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a><span class="co"># same NB time frame as Hallworth et al. 2015 </span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="co"># two steps because subset on shapefile doesn&#39;t like it in a single step</span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>Non_breeding_files <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Non_breeding_files,</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>                      <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>                      month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(x<span class="sc">$</span>Date,<span class="at">format =</span> <span class="st">&quot;%m&quot;</span>))</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>                               x[<span class="fu">which</span>(month <span class="sc">!=</span> <span class="dv">3</span> <span class="sc">&amp;</span> month <span class="sc">!=</span> <span class="dv">4</span>),]})</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>Jam <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)   <span class="co"># locations w/in list of winterBirds captured in Jamaica</span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>Fla <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>) <span class="co"># locations w/in list of winterBirds in Florida</span></span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>PR <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>)  <span class="co"># locations w/in list of winterBirds in Puerto Rico</span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn the locations into shapefiles #</span></span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>NB_GL <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Non_breeding_files, </span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>                  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(x),</span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>                               <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,</span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>                               <span class="at">crs =</span> <span class="dv">4326</span>)})</span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Project into UTM projection #</span></span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>NB_GLmeters <span class="ot">&lt;-</span> <span class="fu">lapply</span>(NB_GL,</span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a>                      <span class="at">FUN =</span> <span class="cf">function</span>(x){sf<span class="sc">::</span><span class="fu">st_transform</span>(x,<span class="st">&#39;ESRI:54027&#39;</span>)})</span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Process to determine geolocator bias and variance-covariance in meters #</span></span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a><span class="co"># generate empty vector to store data #</span></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>LongError<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(winterBirds)) </span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>LatError<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(winterBirds))  </span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error in longitude derived </span></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a><span class="co"># from geolocators from the true capture location </span></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a>LongError[Jam] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Jam],</span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a>                         <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">1</span>,<span class="dv">1</span>])}))</span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a>LongError[Fla] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Fla],</span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a>                         <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">2</span>,<span class="dv">1</span>])}))</span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a>LongError[PR] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[PR],</span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a>                                                 sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">3</span>,<span class="dv">1</span>])}))</span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error in latitude derived from</span></span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a><span class="co"># geolocators from the true capture location </span></span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a>LatError[Jam] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Jam],</span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">1</span>,<span class="dv">2</span>])}))</span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a>LatError[Fla] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Fla],</span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a>                                                 sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">2</span>,<span class="dv">2</span>])}))</span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a>LatError[PR] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[PR],</span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">3</span>,<span class="dv">2</span>])}))</span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Get co-variance matrix for error of </span></span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a><span class="co"># known non-breeding deployment sites </span></span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a><span class="co"># lm does multivariate normal models if you give it a matrix dependent variable!</span></span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a>geo.error.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(LongError,LatError) <span class="sc">~</span> <span class="dv">1</span>) </span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a>geo.bias <span class="ot">&lt;-</span> <span class="fu">coef</span>(geo.error.model)</span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a>geo.vcov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(geo.error.model)</span></code></pre></div>
</div>
<div id="FLightR_bias" class="section level4">
<h4>FLightR</h4>
<p>The code below is a repeatable example for how to calculate location
bias and location error using location estimates derived from
light-level geolocators analyzed in FLightR <span class="citation">(Rakhimberdiev et al. 2017, Lisovski et al.
2020)</span>. The geolocator data were processed and reported by <span class="citation">Witynski and Bonter (2018)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture locations #</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># See dates and summary data from Table 1. page 44.</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #129</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #132</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #136</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Maine #137</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Wisconsin #139</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Wisconsin #144</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Wisconsin #146</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>caplocs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">70.6142</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">87.8123</span>,<span class="dv">3</span>)),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">42.9891</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="fl">42.5000</span>,<span class="dv">3</span>)))</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Departures #</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>departs <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">&quot;2015-09-04&quot;</span>,<span class="st">&quot;2015-08-22&quot;</span>,<span class="st">&quot;2015-09-04&quot;</span>,<span class="st">&quot;2015-08-28&quot;</span>,<span class="st">&quot;2015-08-24&quot;</span>,<span class="st">&quot;2015-08-24&quot;</span>,<span class="st">&quot;2015-08-30&quot;</span>))</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the daily location data #</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>EstLocs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Yellow Warbler_Witynski (1).csv&quot;</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>YEWAsf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(EstLocs, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;location.long&quot;</span>,<span class="st">&quot;location.lat&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>caplocs_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">bird =</span> <span class="fu">c</span>(<span class="dv">129</span>,<span class="dv">132</span>,<span class="dv">136</span>,<span class="dv">137</span>,<span class="dv">139</span>,<span class="dv">144</span>,<span class="dv">146</span>),</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">longitude =</span> caplocs[,<span class="dv">1</span>],</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">latitude =</span> caplocs[,<span class="dv">2</span>]),</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>),</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co"># project into meters #</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>YEWAmeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWAsf,<span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>CapMeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(caplocs_sf, <span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co"># split birds into their own data #</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>YEWAests <span class="ot">&lt;-</span> <span class="fu">split</span>(YEWAmeters, <span class="at">f=</span>YEWAmeters<span class="sc">$</span><span class="st">&#39;individual.local.identifier&#39;</span>)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Empirical estimates of bias and vcov, but on mean locations by bird</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>ests2 <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="at">x =</span> YEWAests,</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">lats =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">2</span>],</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">lng =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">1</span>],</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">z =</span> departs,</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x,lats,lng,z){</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># keep only data from deployment until departure from breeding #</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>                  newdata <span class="ot">&lt;-</span> x[x<span class="sc">$</span>timestamp<span class="sc">&lt;</span>z,]</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># calculate the difference in meters from estimated location</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># to actual capture location</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>                  long <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">1</span>]) <span class="sc">-</span> lng</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>                  lat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">2</span>]) <span class="sc">-</span> lats</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">difflong =</span> long,</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">difflat =</span> lat))},</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>               <span class="at">SIMPLIFY =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>(geoBiasYEWA <span class="ot">&lt;-</span> <span class="fu">apply</span>(ests2, <span class="dv">1</span>, mean)) <span class="co">#Bias</span></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a><span class="co">#  difflong   difflat</span></span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="co"># -6512.898 50964.969</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(ests2, <span class="dv">1</span>, var) <span class="co">#Variances</span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(ests2, <span class="dv">1</span>, sd)</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>(geoVCovYEWA <span class="ot">&lt;-</span> <span class="fu">cov</span>(<span class="fu">t</span>(ests2))) <span class="co">#Variance-covariance matrix</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="co">#            difflong    difflat</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a><span class="co"># difflong  259401516 -894387951</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="co"># difflat  -894387951 4708578511</span></span></code></pre></div>
</div>
<div id="literature-cited" class="section level3">
<h3>Literature Cited</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-bay_genetic_2021" class="csl-entry">
Bay, R. A., D. S. Karp, J. F. Saracco, W. R. L. Anderegg, L. O.
Frishkoff, D. Wiedenfeld, T. B. Smith, and K. Ruegg. 2021. <a href="https://doi.org/10.1111/ele.13706">Genetic variation reveals
individual-level climate tracking across the annual cycle of a migratory
bird</a>. Ecology Letters 24:819–828.
</div>
<div id="ref-cohen_quantifying_2018" class="csl-entry">
Cohen, E. B., J. A. Hostetler, M. T. Hallworth, C. S. Rushing, T. S.
Sillett, and P. P. Marra. 2018. <a href="https://doi.org/10.1111/2041-210X.12916">Quantifying the strength
of migratory connectivity</a>. Methods in Ecology and Evolution
9:513–524.
</div>
<div id="ref-lisovski_lightlevel_2020" class="csl-entry">
Lisovski, S., S. Bauer, M. Briedis, S. C. Davidson, K. L. Dhanjal-Adams,
M. T. Hallworth, J. Karagicheva, C. M. Meier, B. Merkel, J. Ouwehand, L.
Pedersen, E. Rakhimberdiev, A. Roberto-Charron, N. E. Seavy, M. D.
Sumner, C. M. Taylor, S. J. Wotherspoon, and E. S. Bridge. 2020. <a href="https://doi.org/10.1111/1365-2656.13036">Light-level geolocator
analyses: <span>A</span> user’s guide</a>. Journal of Animal Ecology
89:221–236.
</div>
<div id="ref-rakhimberdiev_flightr_2017" class="csl-entry">
Rakhimberdiev, E., A. Saveliev, T. Piersma, and J. Karagicheva. 2017. <a href="https://doi.org/10.1111/2041-210X.12765"><span>FLightR</span>: An
r package for reconstructing animal paths from solar geolocation
loggers</a>. Methods in Ecology and Evolution 8:1482–1487.
</div>
<div id="ref-valdez-juarez_use_2018" class="csl-entry">
Valdez-Juárez, S. O., A. Drake, K. J. Kardynal, K. A. Hobson, E. A.
Krebs, and D. J. Green. 2018. <a href="https://doi.org/10.1650/CONDOR-17-180.1">Use of natural and
anthropogenic land cover by wintering <span>Yellow Warblers</span>:
<span>The</span> influence of sex and breeding origin</a>. The Condor
120:427–438.
</div>
<div id="ref-witynski_crosswise_2018" class="csl-entry">
Witynski, M. L., and D. N. Bonter. 2018. <a href="https://doi.org/10.1111/jofo.12237">Crosswise migration by
<span>Yellow Warblers</span>, <span>Nearctic-Neotropical</span>
passerine migrants</a>. Journal of Field Ornithology 89:37–46.
</div>
<div id="ref-wotherspoon_sgat_2017" class="csl-entry">
Wotherspoon, S. 2017, June. <span>SGAT</span>:
<span>Solar</span>/<span>Satellite Geolocation</span> for <span>Animal
Tracking</span>.
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
