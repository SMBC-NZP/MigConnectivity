<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeffrey A. Hostetler, Michael T. Hallworth" />

<meta name="date" content="2023-08-15" />

<title>Preparing data to estimate transition probabilites and/or migratory connecitivity strength using the ‘MigConnectivity’ package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Preparing data to estimate transition
probabilites and/or migratory connecitivity strength using the
‘MigConnectivity’ package</h1>
<h4 class="author">Jeffrey A. Hostetler, Michael T. Hallworth</h4>
<h4 class="date">2023-08-15</h4>



<p>This vignette is intended to help users structure their data for
analysis using the MigConnectivity package. There are many ways to
derive the data needed for analysis and below, we provided examples and
code as a reference for users. However, the most appropriate methods and
approaches for particular questions and data types should be considered
by the users.</p>
<p>There are examples at the end of this vignette that illustrate ways
to calculate bias and variance metrics using light-level geolocator data
derived from the <a href="#SGAT_bias">SGAT</a> and <a href="#FLightR_bias">FLightR</a> packages.</p>
<div id="using-data-integration-to-estimate-the-strength-of-migratory-connectivitiy" class="section level2">
<h2>Using data integration to estimate the strength of migratory
connectivitiy</h2>
<p>This MigConnectivity package provides tools for estimating the
pattern and strength of migratory connectivity. We’ve developed methods
to integrate intrinsic markers, tracking, and long-distance band
reencounter data collected from the same or different individuals. The
package functionality includes integrated analyses that account for
differences in precision, bias, reencounter probability, and
directionality among different data types (banding reencounter,
light-level geolocator, stable isotopes in tissues, genetics, and GPS).
The package separates estimation of migratory connectivity into two
functions: estTransition and estStrength. The <code>estTransition</code>
function estimates transition probabilities (ψ) from seasonal movement
data (i.e. pattern of movement) and the <code>estStrength</code>
estimates the strength of migratory connectivity (MC) from transition
probabilities.</p>
<p>Below we provide a worked example using Yellow Warbler (<i>Setophaga
petechia</i>) data to help users format their data to use the new
functionality in the MigConnectivity package. There are multiple
published Yellow Warbler data sets that can be used to estimate
migratory connectivity. Here, we illustrate how to integrate genetic
data and light-level geolocators to estimate MC. Genetic sampling of 203
individuals occurred at 20 locations across the nonbreeding range, from
Baja Mexico, south through central Mexico, Central America (Costa Rica
and Nicaragua), and South America (Trinidad and Venezuela) <span class="citation">(Bay et al. 2021)</span>.</p>
<div id="define-nonbreeding-regions" class="section level3">
<h3>Define nonbreeding regions</h3>
<p>We identified 4 nonbreeding regions using ecoregions which include
the Pacific and Central Mexico, Atlantic Lowland Mexico, Central America
and South America.</p>
<div class="float">
<img src="data:image/png;base64,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" alt="Yellow Warbler nonbreeding regions. The breeding regions (washed out) are defined by genoscape-defined populations and the nonbreeding regions were identified by ecoregions across the ranges" />
<div class="figcaption">Yellow Warbler nonbreeding regions. The breeding
regions (washed out) are defined by genoscape-defined populations and
the nonbreeding regions were identified by ecoregions across the
ranges</div>
</div>
</div>
<div id="define-breeding-regions" class="section level3">
<h3>Define breeding regions</h3>
<p>The Yellow Warbler genoscape identifies 5 genetically distinct
breeding populations (Arctic, Pacific Northwest, Southwest, Central, and
East) from 419 sampled individuals at 50 breeding locations <span class="citation">(Bay et al. 2021)</span>.</p>
<p>Below we create a vector of the origin names. These names correspond
with the genoscape.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Load shapefile of origin sites derived from genoscape data</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>YEWA_origin_sites <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">&quot;originSitesYEWA.shp&quot;</span>, </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>                                 <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># vector of origin names </span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>originNames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Arctic&quot;</span>, <span class="st">&quot;Pacific Northwest&quot;</span>, <span class="st">&quot;Southwest&quot;</span>, <span class="st">&quot;Central&quot;</span>, <span class="st">&quot;East&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># object with the number of originSites </span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>nOriginSites <span class="ot">&lt;-</span> <span class="dv">5</span></span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Yellow Warbler breeding regions. The breeding regions are defined by genoscape-defined populations and the nonbreeding regions (washed out) were identified by ecoregions across the ranges" />
<div class="figcaption">Yellow Warbler breeding regions. The breeding
regions are defined by genoscape-defined populations and the nonbreeding
regions (washed out) were identified by ecoregions across the
ranges</div>
</div>
</div>
<div id="sample-data" class="section level3">
<h3>Sample data</h3>
<p>For information about sampling and assignment methods see Bay et
al. (2021) for genetics and Witynski and Bonter (2018) for
geolocators.</p>
</div>
<div id="load-the-genetic-sample-data" class="section level3">
<h3>Load the genetic sample data</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#read in the data </span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>genetic_samples <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;YEWA_nonbreeding_genetic_samples.txt&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                              <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">str</span>(genetic_samples, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    203 obs. of  12 variables:
##  $ mixture_collection: Factor w/ 1 level &quot;mixture&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ indiv             : Factor w/ 203 levels &quot;02N0291&quot;,&quot;04N8955&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Alaska            : num  6.16e-03 1.91e-17 1.86e-18 1.38e-20 5.45e-11 ...
##  $ Central           : num  1.34e-29 1.00 1.00 1.00 9.98e-01 ...
##  $ Southwest         : num  1.29e-03 1.50e-09 3.67e-09 4.26e-11 1.62e-03 ...
##  $ East              : num  9.57e-66 2.24e-11 7.78e-11 1.69e-10 1.49e-17 ...
##  $ WesternBoreal     : num  9.93e-01 1.41e-16 5.49e-18 2.65e-20 1.07e-08 ...
##  $ State             : Factor w/ 14 levels &quot;Ahuachapan&quot;,&quot;Baja California Sur&quot;,..: 4 5 5 5 5 5 5 5 5 5 ...
##  $ Town              : Factor w/ 20 levels &quot;Celestun&quot;,&quot;Chamela&quot;,..: 5 6 6 6 6 6 6 6 6 6 ...
##  $ Stage             : Factor w/ 1 level &quot;Wintering&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ longitude         : num  -86 -85.6 -85.6 -85.6 -85.6 ...
##  $ latitude          : num  11.8 10.6 10.6 10.6 10.6 10.6 10.6 10.6 10.6 10.6 ...</code></pre>
<p>The genetic data have the probabilty that each individual is assigned
to a specific genetic population. These data are used during the
resampling process to estimate transition probabilities and the strength
of MC. Below, we format the data so we can easily use it in our
analysis.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Note that we re-order the probabilities to match the order of originNames #</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>YEWA_genetics <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(genetic_samples[,<span class="fu">c</span>(<span class="st">&quot;Alaska&quot;</span>,<span class="st">&quot;WesternBoreal&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                                              <span class="st">&quot;Southwest&quot;</span>,<span class="st">&quot;Central&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                                              <span class="st">&quot;East&quot;</span>)])</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># give names to the object</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">dimnames</span>(YEWA_genetics) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">as.character</span>(genetic_samples<span class="sc">$</span>indiv), </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                                originNames)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># Double-check that all rows sum to 1</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rowSums</span>(YEWA_genetics))</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##       1       1       1       1       1       1</code></pre>
<p>Convert the data into a spatial object</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Convert the data into spatial object </span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>targetPoints_genetic <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(genetic_samples[,<span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>)],</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                                  <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                                  <span class="at">crs =</span> <span class="dv">4326</span>) <span class="co"># WGS84</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># Assign the data type to the spatial layer </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>targetPoints_genetic<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;Genetics Capture&quot;</span></span></code></pre></div>
</div>
<div id="load-the-light-level-geolocator-data" class="section level3">
<h3>Load the light-level geolocator data</h3>
<p>We obtained location estimates from seven individuals tracked using
light-level geolocators deployed and recovered in Maine (n = 4) and
Wisconsin (n = 3; Witynski &amp; Bonter, 2018). We used the daily
location estimates while individuals remained on the breeding grounds to
derive location bias and uncertainty estimates. The geolocator data were
processed and reported by <span class="citation">Witynski and Bonter
(2018)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Capture locations #</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># See dates and summary data from Table 1. page 44.</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Maine #129</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># Maine #132</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># Maine #136</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># Maine #137</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># Wisconsin #139</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Wisconsin #144</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># Wisconsin #146</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>caplocs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">70.6142</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">87.8123</span>,<span class="dv">3</span>)),</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">42.9891</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="fl">42.5000</span>,<span class="dv">3</span>)))</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># Departures #</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>departs <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">&quot;2015-09-04&quot;</span>,</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>                        <span class="st">&quot;2015-08-22&quot;</span>,</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>                        <span class="st">&quot;2015-09-04&quot;</span>,</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>                        <span class="st">&quot;2015-08-28&quot;</span>,</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>                        <span class="st">&quot;2015-08-24&quot;</span>,</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>                        <span class="st">&quot;2015-08-24&quot;</span>,</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>                        <span class="st">&quot;2015-08-30&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># read in the daily location data #</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>EstLocs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Yellow Warbler_Witynski.csv&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># make it spatial </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>YEWA_gl_locs <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(EstLocs,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                             <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;location.long&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                                        <span class="st">&quot;location.lat&quot;</span>),</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>                             <span class="at">crs =</span> <span class="dv">4326</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Summarized nonbreeding locations reported in Witynski and Bonter</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>YEWA_GL_nb <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">bird =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">129</span>,<span class="dv">132</span>,<span class="dv">136</span>,<span class="dv">137</span>,<span class="dv">139</span>,<span class="dv">144</span>,<span class="dv">146</span>)),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                                      <span class="at">long =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">75.09</span>,<span class="sc">-</span><span class="fl">74.81</span>,<span class="sc">-</span><span class="fl">74.30</span>,<span class="sc">-</span><span class="fl">74.21</span>,<span class="sc">-</span><span class="fl">68.72</span>,<span class="sc">-</span><span class="fl">67.08</span>,<span class="sc">-</span><span class="fl">65.39</span>),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                                      <span class="at">lat =</span> <span class="fu">c</span>(<span class="fl">10.03</span>,<span class="fl">8.52</span>,<span class="fl">10.51</span>,<span class="fl">3.14</span>,<span class="fl">0.96</span>,<span class="fl">5.73</span>,<span class="fl">6.67</span>)),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                               <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;long&quot;</span>,<span class="st">&quot;lat&quot;</span>),</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                               <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co"># assign type to GL spatial object</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>YEWA_GL_nb<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;GL Estimated Target&quot;</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># Convert the capture locations to a spatial object</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>YEWA_GL_breed <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">bird =</span> <span class="fu">c</span>(<span class="dv">129</span>,<span class="dv">132</span>,<span class="dv">136</span>,<span class="dv">137</span>,<span class="dv">139</span>,<span class="dv">144</span>,<span class="dv">146</span>),</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>                                  <span class="at">longitude =</span> caplocs[,<span class="dv">1</span>],</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>                                  <span class="at">latitude =</span> caplocs[,<span class="dv">2</span>]),</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>),</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co"># assign type to GL spatial object</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>YEWA_GL_breed<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;GL Capture&quot;</span></span></code></pre></div>
<p>Calculate location bias and covariance which are used to estimate
transition probabilities (<code>estTransition</code>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># project from WGS84 into meters #</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>YEWAmeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWA_gl_locs,<span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>CapMeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWA_GL_breed, <span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># split birds into their own data #</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>YEWAests <span class="ot">&lt;-</span> <span class="fu">split</span>(YEWAmeters,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                  <span class="at">f =</span> YEWAmeters<span class="sc">$</span><span class="st">&#39;individual.local.identifier&#39;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># Empirical estimates of bias and vcov, but on mean locations by bird</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>ests2 <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="at">x =</span> YEWAests,</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>                <span class="at">lats =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">2</span>],</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                <span class="at">lng =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">1</span>],</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>                <span class="at">z =</span> departs,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x,lats,lng,z){</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>              <span class="co"># keep only data from deployment until departure from breeding #</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>                  newdata <span class="ot">&lt;-</span> x[x<span class="sc">$</span>timestamp<span class="sc">&lt;</span>z,]</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>              <span class="co"># calculate the difference in meters from estimated location</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>              <span class="co"># to actual capture location</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>                  long <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">1</span>]) <span class="sc">-</span> lng</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>                  lat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">2</span>]) <span class="sc">-</span> lats</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>                  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">difflong =</span> long,</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>                                    <span class="at">difflat =</span> lat))},</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>               <span class="at">SIMPLIFY =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>(geoBiasYEWA <span class="ot">&lt;-</span> <span class="fu">apply</span>(ests2, <span class="dv">1</span>, mean)) <span class="co">#Bias</span></span></code></pre></div>
<pre><code>##  difflong   difflat 
## -6512.898 50964.969</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>(geoVCovYEWA <span class="ot">&lt;-</span> <span class="fu">cov</span>(<span class="fu">t</span>(ests2))) <span class="co">#Variance-covariance matrix</span></span></code></pre></div>
<pre><code>##            difflong    difflat
## difflong  259401516 -894387951
## difflat  -894387951 4708578511</code></pre>
</div>
<div id="set-up-input-to-run-esttransition" class="section level3">
<h3>Set up input to run estTransition</h3>
<p>The following code creates objects that are needed and/or helpful
when using the <code>estStrength</code> or <code>estTransition</code>
functions.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="do">## Set up input for running in estTransition</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Number of geolocator birds </span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>nGL <span class="ot">&lt;-</span> <span class="fu">nrow</span>(YEWA_GL_breed)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co"># We have 0 birds with telemetry data</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>nTelemetry <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># How many birds have raster data (isotopes; for this example, none)</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>nRaster <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co"># How many birds have probability data (genetics)</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>nProb <span class="ot">&lt;-</span> <span class="fu">nrow</span>(YEWA_genetics)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co"># Total number of animals </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>nAnimals <span class="ot">&lt;-</span> nGL <span class="sc">+</span> nTelemetry <span class="sc">+</span> nRaster <span class="sc">+</span> nProb</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co"># Set up a vector of TRUE/FALSE indicating if the individual </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co"># has geolocator data </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>isGLYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">c</span>(nGL, nTelemetry <span class="sc">+</span> nRaster <span class="sc">+</span> nProb))</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co"># Vector indicating whether an individual has telemetry data </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>isTelemetryYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, nAnimals)</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co"># Vector indicating whether an individual has raster assignment data </span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>isRasterYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, nAnimals)</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co"># Vector indicating whether an individual has probability data </span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>isProbYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="fu">c</span>(nGL <span class="sc">+</span> nTelemetry <span class="sc">+</span> nRaster, nProb))</span></code></pre></div>
<p>Now that we have objects that tell the function which type of data
are associated with each individual we can set up the spatial data.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># combine all the target locations into a single object </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co"> - we reorder the columns to match between the data sets</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>targetPointsYEWA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(YEWA_GL_nb[,<span class="fu">c</span>(<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;geometry&quot;</span>)],</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                          targetPoints_genetic[,<span class="fu">c</span>(<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;geometry&quot;</span>)])</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co"># Transform (re-project the data) into Equidistant conic projection</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>targetPointsYEWA <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(targetPointsYEWA, <span class="st">&quot;ESRI:102010&quot;</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># A vector indicating where the birds were captured </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>capturedYEWA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;origin&quot;</span>, <span class="st">&quot;target&quot;</span>), <span class="fu">c</span>(nGL, nTelemetry <span class="sc">+</span> nRaster <span class="sc">+</span> nProb))</span></code></pre></div>
<p>Here we do some spatial analyses to determine target sites from the
data we’ve gathered so far. These data are needed for the analysis.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Where birds were captured in the origin sites (i.e., geolocators)</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>originPointsYEWA <span class="ot">&lt;-</span> CapMeters</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># Transform (re-project) data into Equidistant conic projection </span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>targetSitesYEWA <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(YEWA_target_sites, <span class="st">&quot;ESRI:102010&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co"># Create a vector of the target assignments of the input data</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>targetAssignment <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">unclass</span>(sf<span class="sc">::</span><span class="fu">st_intersects</span>(<span class="at">x =</span> targetPointsYEWA,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>                                                               <span class="at">y =</span> targetSitesYEWA,</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>                                                               <span class="at">sparse =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co"># Set any target assignment that results in 0 to NA</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>targetAssignment[<span class="fu">lengths</span>(targetAssignment)<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co"># convert from a list to an array #</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>targetAssignment <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">unlist</span>(targetAssignment))</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co"># If the assignment is NA - assign to the nearest targetSite</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>targetAssignment[<span class="fu">is.na</span>(targetAssignment)] <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_nearest_feature</span>(<span class="at">x =</span> targetPointsYEWA[<span class="fu">is.na</span>(targetAssignment),],</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>                                                                    <span class="at">y =</span> targetSitesYEWA)</span></code></pre></div>
</div>
<div id="abundance-estimates" class="section level3">
<h3>Abundance estimates</h3>
<p>Accounting for relative abundance is an important component when
estimating migratory connectivity strength or estimating transition
probabilities between two or more phases of the annual cycle.</p>
<p>Below, we use eBird.org products to estimate abundance. Note - users
may need to create an account and get permission to access eBird data.
See information to <a href="https://science.ebird.org/en/use-ebird-data/download-ebird-data-products">Download
eBird data products</a>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Read in data from eBird </span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">library</span>(ebirdst)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>sp_path <span class="ot">&lt;-</span> <span class="fu">ebirdst_download</span>(<span class="at">species =</span> <span class="st">&quot;yelwar&quot;</span>, <span class="at">path =</span> <span class="st">&quot;./&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>run_review <span class="ot">&lt;-</span> <span class="fu">subset</span>(ebirdst_runs, species_code <span class="sc">==</span> <span class="st">&quot;yelwar&quot;</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>yelwar_dates <span class="ot">&lt;-</span> run_review <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="co"># just keep the seasonal definition columns</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">setdiff</span>(<span class="fu">matches</span>(<span class="st">&quot;(start)|(end)&quot;</span>), <span class="fu">matches</span>(<span class="st">&quot;year_round&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>  <span class="co"># transpose</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;label&quot;</span>, <span class="st">&quot;date&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>  <span class="co"># spread data so start and end dates are in separate columns</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>  <span class="fu">separate</span>(label, <span class="fu">c</span>(<span class="st">&quot;season&quot;</span>, <span class="st">&quot;start_end&quot;</span>), <span class="st">&quot;_(?=s|e)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>  <span class="fu">spread</span>(start_end, date) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>  <span class="fu">select</span>(season, <span class="at">start_dt =</span> start, <span class="at">end_dt =</span> end) <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>  <span class="fu">filter</span>(season <span class="sc">!=</span> <span class="st">&quot;resident&quot;</span>)</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co"># did the season pass review</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>quality_rating <span class="ot">&lt;-</span> run_review[<span class="fu">paste0</span>(yelwar_dates<span class="sc">$</span>season, <span class="st">&quot;_quality&quot;</span>)]</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>yelwar_dates<span class="sc">$</span>pass <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(quality_rating) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>yelwar_dates</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>rastAbundMed <span class="ot">&lt;-</span> <span class="fu">load_raster</span>(<span class="at">path =</span> sp_path, </span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>                            <span class="at">product =</span> <span class="st">&quot;abundance&quot;</span>,</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>                            <span class="at">period =</span> <span class="st">&quot;weekly&quot;</span>, </span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>                            <span class="at">resolution =</span> <span class="st">&quot;mr&quot;</span>)</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co"># dates for each abundance layer</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a>weeks <span class="ot">&lt;-</span> <span class="fu">parse_raster_dates</span>(rastAbundMed)</span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co"># assign to seasons</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>weeks_season <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA_character_</span>, <span class="fu">length</span>(weeks))</span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(yelwar_dates))) {</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a>  s <span class="ot">&lt;-</span> yelwar_dates[i, ]</span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a>  <span class="co"># skip seasonal assignment if season failed</span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>s<span class="sc">$</span>pass) {</span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a>    <span class="cf">next</span>()</span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a>  }</span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a>  <span class="co"># handle seasons cross jan 1 separately</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a>  <span class="cf">if</span> (s<span class="sc">$</span>start_dt <span class="sc">&lt;=</span> s<span class="sc">$</span>end_dt) {</span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a>    in_season <span class="ot">&lt;-</span> weeks <span class="sc">&gt;=</span> s<span class="sc">$</span>start_dt <span class="sc">&amp;</span> weeks <span class="sc">&lt;=</span> s<span class="sc">$</span>end_dt</span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a>    in_season <span class="ot">&lt;-</span> weeks <span class="sc">&gt;=</span> s<span class="sc">$</span>start_dt <span class="sc">|</span> weeks <span class="sc">&lt;=</span> s<span class="sc">$</span>end_dt</span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a>  }</span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a>  weeks_season[in_season] <span class="ot">&lt;-</span> s<span class="sc">$</span>season</span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a>}</span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a><span class="fu">table</span>(weeks_season)</span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">which</span>(weeks_season <span class="sc">==</span> <span class="st">&#39;breeding&#39;</span>)</span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">which</span>(weeks_season <span class="sc">==</span> <span class="st">&#39;nonbreeding&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>eBirdRelAbund <span class="ot">&lt;-</span> <span class="cf">function</span>(wks, abund, regions, <span class="at">names=</span>regions[,<span class="dv">1</span>], <span class="at">fun =</span> max,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                          <span class="at">regionFirst =</span> <span class="cn">FALSE</span>, <span class="at">seasonalAlready =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  regionSum <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(regions),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                     <span class="fu">list</span>(names))</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  thing <span class="ot">&lt;-</span> abund[[wks]]</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(regions)){</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    region <span class="ot">&lt;-</span> regions[j, ]</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    rastvals <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(thing, region)[,<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(wks)]</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    <span class="cf">if</span> (seasonalAlready) {</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>      regionSum[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(rastvals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>    }</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (regionFirst) {</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>      sumByWeek <span class="ot">&lt;-</span> <span class="fu">apply</span>(rastvals, <span class="dv">2</span>, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>      regionSum[j] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(fun, <span class="fu">list</span>(<span class="at">x =</span> sumByWeek, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>    }</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>    {</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>      valid <span class="ot">&lt;-</span> <span class="fu">apply</span>(rastvals, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)))</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>      maxed <span class="ot">&lt;-</span> <span class="fu">apply</span>(rastvals[valid, ], <span class="dv">1</span>, fun, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>      regionSum[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(maxed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>    }</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>  }</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>  testII <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(regionSum)</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>  <span class="fu">return</span>(testII)</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>}</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>relAbundYEWAWint <span class="ot">&lt;-</span> <span class="fu">eBirdRelAbund</span>(w, rastAbundMed, targetSitesProj,</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>                                  targetNames)</span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>relAbundYEWABreed <span class="ot">&lt;-</span> <span class="fu">eBirdRelAbund</span>(b, rastAbundMed, originSitesProj,</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>                                   originNames)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>relAbundYEWAWint</span></code></pre></div>
<pre><code>## Pacific and Central Mexico    Atlantic Lowland Mexico 
##                 0.08807831                 0.16450576 
##            Central America              South America 
##                 0.42872615                 0.31868978</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>relAbundYEWABreed</span></code></pre></div>
<pre><code>##            Arctic Pacific Northwest         Southwest           Central 
##         0.1690379         0.1245764         0.2838745         0.2471317 
##              East 
##         0.1753794</code></pre>
<p>There are a few other things we would need for eventually running
<code>estStrength</code>: the distances between breeding regions, and
the distances between nonbreeding regions.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># calculate distance between originSites</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>originCentersYEWA <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(YEWA_origin_sites)</span></code></pre></div>
<pre><code>## Warning: st_centroid assumes attributes are constant over geometries</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>originCentersYEWA <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(originCentersYEWA, <span class="dv">4326</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>originDistYEWA <span class="ot">&lt;-</span> <span class="fu">distFromPos</span>(<span class="fu">st_coordinates</span>(originCentersYEWA<span class="sc">$</span>geometry))</span></code></pre></div>
<pre><code>## The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
## which was just loaded, will retire in October 2023.
## Please refer to R-spatial evolution reports for details, especially
## https://r-spatial.org/r/2023/05/15/evolution4.html.
## It may be desirable to make the sf package available;
## package maintainers should consider adding sf to Suggests:.
## The sp package is now running under evolution status 2
##      (status 2 uses the sf package in place of rgdal)</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># calculate distance between targetSites </span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>targetCentersYEWA <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(YEWA_target_sites)</span></code></pre></div>
<pre><code>## Warning: st_centroid assumes attributes are constant over geometries</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>targetCentersYEWA <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(targetCentersYEWA, <span class="dv">4326</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>targetDistYEWA <span class="ot">&lt;-</span> <span class="fu">distFromPos</span>(<span class="fu">st_coordinates</span>(targetCentersYEWA<span class="sc">$</span>geometry))</span></code></pre></div>
<p>We now have all the data in order to run <code>estTransition</code>
and then <code>estStrength</code>.</p>
<p>Note - there was no overlap of data sources for individuals, i.e., we
only had one type of data for each bird - so we set the overlap setting
to “none”. If there are multiple types for an individual animal or only
one type of data overall, it’s best to leave
<code>dataOverlapSetting</code> at its default (“dummy”).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="do">## Run analysis for psi</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">system.time</span>((psiYEWA <span class="ot">&lt;-</span> <span class="fu">estTransition</span>(<span class="at">originSites =</span> YEWA_origin_sites,</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>                                     <span class="at">targetSites =</span> YEWA_target_sites,</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>                                     <span class="at">originPoints =</span> originPointsYEWA,</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>                                     <span class="at">targetPoints =</span> targetPointsYEWA,</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>                                     <span class="at">originAssignment =</span> YEWA_genetics,</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>                                     <span class="at">originNames =</span> originNames,</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>                                     <span class="at">targetNames =</span> targetNames,</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>                                     <span class="at">nSamples =</span> <span class="dv">10</span>, <span class="co"># Set low for demonstration speed</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>                                     <span class="at">isGL =</span> isGLYEWA,</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>                                     <span class="at">isTelemetry =</span> isTelemetryYEWA,</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>                                     <span class="at">isRaster =</span> isRasterYEWA,</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>                                     <span class="at">isProb =</span> isProbYEWA,</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>                                     <span class="at">captured =</span> capturedYEWA,</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>                                     <span class="at">geoBias =</span> geoBiasYEWA,</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>                                     <span class="at">geoVCov =</span> geoVCovYEWA,</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>                                     <span class="at">verbose =</span> <span class="dv">2</span>, </span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>                                     <span class="at">maxTries =</span> <span class="dv">400</span>,</span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>                                     <span class="at">resampleProjection =</span> <span class="fu">st_crs</span>(YEWA_origin_sites),</span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>                                     <span class="at">nSim =</span> <span class="dv">40</span>,</span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>                                     <span class="at">dataOverlapSetting =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>                                     <span class="at">targetRelAbund =</span> relAbundYEWAWint)))</span></code></pre></div>
<pre><code>## Configuring data overlap settings</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 1</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 2</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 3</code></pre>
<pre><code>## Warning in reassignInds(dataOverlapSetting = dataOverlapSetting, originPoints = originPoints, : Not all origin capture locations are within originSites. Assigning to closest site.
## Affects animal: 4</code></pre>
<pre><code>## Creating targetAssignment
## Not all target capture locations are within targetSites. Assigning to closest site</code></pre>
<pre><code>## Warning in estTransitionBoot(isGL = isGL, isTelemetry = isTelemetry, isRaster = isRaster, : Not all target capture locations are within targetSites. Assigning to closest site.
## Affects animals: 133,134,135,136,137,138,139,140,141,142,143,144,145,146,184,189,190,191,192</code></pre>
<pre><code>## Starting bootstrap
## Bootstrap Run 1 of 10 at Tue Aug 15 13:13:07 2023 
## Bootstrap Run 2 of 10 at Tue Aug 15 13:13:07 2023 
## Bootstrap Run 3 of 10 at Tue Aug 15 13:13:07 2023 
## Bootstrap Run 4 of 10 at Tue Aug 15 13:13:07 2023 
## Bootstrap Run 5 of 10 at Tue Aug 15 13:13:07 2023 
## Bootstrap Run 6 of 10 at Tue Aug 15 13:13:08 2023 
## Bootstrap Run 7 of 10 at Tue Aug 15 13:13:08 2023 
## Bootstrap Run 8 of 10 at Tue Aug 15 13:13:08 2023 
## Bootstrap Run 9 of 10 at Tue Aug 15 13:13:08 2023 
## Bootstrap Run 10 of 10 at Tue Aug 15 13:13:08 2023</code></pre>
<pre><code>##    user  system elapsed 
##    2.60    0.10    2.75</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># Take a look at the results # </span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>psiYEWA</span></code></pre></div>
<pre><code>## Migratory Connectivity Estimates
## 
## Transition probability (psi) estimates (mean):
##                   Pacific and Central Mexico Atlantic Lowland Mexico
## Arctic                               0.00000                 0.69052
## Pacific Northwest                    0.03399                 0.20007
## Southwest                            0.40454                 0.05044
## Central                              0.00000                 0.07954
## East                                 0.00000                 0.00000
##                   Central America South America
## Arctic                     0.3095        0.0000
## Pacific Northwest          0.7659        0.0000
## Southwest                  0.5450        0.0000
## Central                    0.6548        0.2657
## East                       0.0000        1.0000
## +/- SE:
##                   Pacific and Central Mexico Atlantic Lowland Mexico
## Arctic                               0.00000                 0.10022
## Pacific Northwest                    0.03399                 0.10069
## Southwest                            0.08618                 0.05105
## Central                              0.00000                 0.03132
## East                                 0.00000                 0.00000
##                   Central America South America
## Arctic                    0.10022       0.00000
## Pacific Northwest         0.09439       0.00000
## Southwest                 0.08967       0.00000
## Central                   0.04502       0.05268
## East                      0.00000       0.00000
## 95% confidence interval (simple quantile):
##                   Pacific and Central Mexico Atlantic Lowland Mexico
## Arctic            0.00000 - 0.00000          0.52596 - 0.81554      
## Pacific Northwest 0.00000 - 0.08445          0.06290 - 0.36175      
## Southwest         0.27221 - 0.53978          0.00000 - 0.15060      
## Central           0.00000 - 0.00000          0.02733 - 0.13160      
## East              0.00000 - 0.00000          0.00000 - 0.00000      
##                   Central America   South America    
## Arctic            0.18446 - 0.47404 0.00000 - 0.00000
## Pacific Northwest 0.61241 - 0.90730 0.00000 - 0.00000
## Southwest         0.38899 - 0.64245 0.00000 - 0.00000
## Central           0.58500 - 0.70402 0.21425 - 0.36849
## East              0.00000 - 0.00000 1.00000 - 1.00000
## 
## This is a subset of what&#39;s available inside this estMigConnectivity output.
## For more info, try ?estTransition or str(obj_name, max.levels = 2).</code></pre>
<p>Plot the results using the built-in plotting function</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">plot</span>(psiYEWA, <span class="at">legend =</span> <span class="st">&quot;top&quot;</span>, <span class="at">cex =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Estimated transition probabilities of the Yellow Warbler between breeding and nonbreeding periods" />
<div class="figcaption">Estimated transition probabilities of the Yellow
Warbler between breeding and nonbreeding periods</div>
</div>
</div>
</div>
<div id="calculating-location-bias-and-covariance-structure-to-resample-light-level-geolocator-data" class="section level2">
<h2>Calculating location bias and covariance structure to resample
light-level geolocator data</h2>
<div id="SGAT_bias" class="section level4">
<h4>SGAT</h4>
<p>The code below is a repeatable example for how to calculate location
bias and location error using coordinates derived from light-level
geolocators (see <span class="citation">Cohen et al. (2018)</span>)
analyzed using the SGAT package <span class="citation">(Wotherspoon
2017, <strong>lisovski_lightlevel_2020?</strong>)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Load in projections</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;projections&quot;</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="co"># Define deployment locations (winter) # </span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>captureLocations<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.93</span>,<span class="fl">18.04</span>,   <span class="co"># Jamaica</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>                           <span class="sc">-</span><span class="fl">80.94</span>,<span class="fl">25.13</span>,   <span class="co"># Florida</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>                           <span class="sc">-</span><span class="fl">66.86</span>,<span class="fl">17.97</span>),  <span class="co"># Puerto Rico</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>                            <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a><span class="fu">colnames</span>(captureLocations) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a><span class="co"># Convert capture locations into SpatialPoints #</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>CapLocs <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(captureLocations),</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>                      <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a><span class="co"># Project Capture locations # </span></span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>CapLocsM<span class="ot">&lt;-</span>sf<span class="sc">::</span><span class="fu">st_transform</span>(CapLocs, <span class="st">&#39;ESRI:54027&#39;</span>)</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a><span class="co"># Retrieve raw non-breeding locations from github </span></span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a><span class="co"># First grab the identity of the bird so we can loop through the files </span></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a><span class="co"># For this example we are only interested in the error </span></span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a><span class="co"># around non-breeding locations </span></span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a><span class="co"># here we grab only the birds captured during the non-breeding season </span></span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a><span class="co"># Using paste0 for vignette formatting purposes</span></span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>winterBirds <span class="ot">&lt;-</span> <span class="fu">dget</span>(<span class="fu">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/&quot;</span>,</span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>                    <span class="st">&quot;SMBC-NZP/MigConnectivity/master/&quot;</span>,</span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a>                    <span class="st">&quot;data-raw/GL_NonBreedingFiles/winterBirds.txt&quot;</span>))</span>
<span id="cb43-32"><a href="#cb43-32" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" tabindex="-1"></a><span class="co"># create empty list to store the location data #</span></span>
<span id="cb43-34"><a href="#cb43-34" tabindex="-1"></a>Non_breeding_files <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&#39;list&#39;</span>,<span class="fu">length</span>(winterBirds))</span>
<span id="cb43-35"><a href="#cb43-35" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" tabindex="-1"></a><span class="co"># Get raw location data from Github #</span></span>
<span id="cb43-37"><a href="#cb43-37" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(winterBirds)){</span>
<span id="cb43-38"><a href="#cb43-38" tabindex="-1"></a>Non_breeding_files[[i]] <span class="ot">&lt;-</span> <span class="fu">dget</span>(<span class="fu">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/&quot;</span>,</span>
<span id="cb43-39"><a href="#cb43-39" tabindex="-1"></a>                                        <span class="st">&quot;SMBC-NZP/MigConnectivity/master/data-raw/&quot;</span>,</span>
<span id="cb43-40"><a href="#cb43-40" tabindex="-1"></a>                                        <span class="st">&quot;GL_NonBreedingFiles/NonBreeding_&quot;</span>,</span>
<span id="cb43-41"><a href="#cb43-41" tabindex="-1"></a>                                        winterBirds[i],<span class="st">&quot;.txt&quot;</span>))</span>
<span id="cb43-42"><a href="#cb43-42" tabindex="-1"></a>}</span>
<span id="cb43-43"><a href="#cb43-43" tabindex="-1"></a></span>
<span id="cb43-44"><a href="#cb43-44" tabindex="-1"></a><span class="co"># Remove locations around spring Equinox and potential migration points</span></span>
<span id="cb43-45"><a href="#cb43-45" tabindex="-1"></a><span class="co"># same NB time frame as Hallworth et al. 2015 </span></span>
<span id="cb43-46"><a href="#cb43-46" tabindex="-1"></a></span>
<span id="cb43-47"><a href="#cb43-47" tabindex="-1"></a><span class="co"># two steps because subset on shapefile doesn&#39;t like it in a single step</span></span>
<span id="cb43-48"><a href="#cb43-48" tabindex="-1"></a></span>
<span id="cb43-49"><a href="#cb43-49" tabindex="-1"></a>Non_breeding_files <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Non_breeding_files,</span>
<span id="cb43-50"><a href="#cb43-50" tabindex="-1"></a>                      <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb43-51"><a href="#cb43-51" tabindex="-1"></a>                      month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(x<span class="sc">$</span>Date,<span class="at">format =</span> <span class="st">&quot;%m&quot;</span>))</span>
<span id="cb43-52"><a href="#cb43-52" tabindex="-1"></a>                               x[<span class="fu">which</span>(month <span class="sc">!=</span> <span class="dv">3</span> <span class="sc">&amp;</span> month <span class="sc">!=</span> <span class="dv">4</span>),]})</span>
<span id="cb43-53"><a href="#cb43-53" tabindex="-1"></a></span>
<span id="cb43-54"><a href="#cb43-54" tabindex="-1"></a>   </span>
<span id="cb43-55"><a href="#cb43-55" tabindex="-1"></a>Jam <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)   <span class="co"># locations w/in list of winterBirds captured in Jamaica</span></span>
<span id="cb43-56"><a href="#cb43-56" tabindex="-1"></a>Fla <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>) <span class="co"># locations w/in list of winterBirds in Florida</span></span>
<span id="cb43-57"><a href="#cb43-57" tabindex="-1"></a>PR <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>)  <span class="co"># locations w/in list of winterBirds in Puerto Rico</span></span>
<span id="cb43-58"><a href="#cb43-58" tabindex="-1"></a></span>
<span id="cb43-59"><a href="#cb43-59" tabindex="-1"></a><span class="co"># Turn the locations into shapefiles #</span></span>
<span id="cb43-60"><a href="#cb43-60" tabindex="-1"></a></span>
<span id="cb43-61"><a href="#cb43-61" tabindex="-1"></a>NB_GL <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Non_breeding_files, </span>
<span id="cb43-62"><a href="#cb43-62" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb43-63"><a href="#cb43-63" tabindex="-1"></a>                  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(x),</span>
<span id="cb43-64"><a href="#cb43-64" tabindex="-1"></a>                               <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,</span>
<span id="cb43-65"><a href="#cb43-65" tabindex="-1"></a>                                          <span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb43-66"><a href="#cb43-66" tabindex="-1"></a>                               <span class="at">crs =</span> <span class="dv">4326</span>)})</span>
<span id="cb43-67"><a href="#cb43-67" tabindex="-1"></a></span>
<span id="cb43-68"><a href="#cb43-68" tabindex="-1"></a><span class="co"># Project into UTM projection #</span></span>
<span id="cb43-69"><a href="#cb43-69" tabindex="-1"></a></span>
<span id="cb43-70"><a href="#cb43-70" tabindex="-1"></a>NB_GLmeters <span class="ot">&lt;-</span> <span class="fu">lapply</span>(NB_GL,</span>
<span id="cb43-71"><a href="#cb43-71" tabindex="-1"></a>                      <span class="at">FUN =</span> <span class="cf">function</span>(x){sf<span class="sc">::</span><span class="fu">st_transform</span>(x,<span class="st">&#39;ESRI:54027&#39;</span>)})</span>
<span id="cb43-72"><a href="#cb43-72" tabindex="-1"></a></span>
<span id="cb43-73"><a href="#cb43-73" tabindex="-1"></a><span class="co"># Process to determine geolocator bias and variance-covariance in meters #</span></span>
<span id="cb43-74"><a href="#cb43-74" tabindex="-1"></a></span>
<span id="cb43-75"><a href="#cb43-75" tabindex="-1"></a><span class="co"># generate empty vector to store data #</span></span>
<span id="cb43-76"><a href="#cb43-76" tabindex="-1"></a>LongError<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(winterBirds)) </span>
<span id="cb43-77"><a href="#cb43-77" tabindex="-1"></a>LatError<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(winterBirds))  </span>
<span id="cb43-78"><a href="#cb43-78" tabindex="-1"></a></span>
<span id="cb43-79"><a href="#cb43-79" tabindex="-1"></a><span class="co"># Calculate the error in longitude derived </span></span>
<span id="cb43-80"><a href="#cb43-80" tabindex="-1"></a><span class="co"># from geolocators from the true capture location </span></span>
<span id="cb43-81"><a href="#cb43-81" tabindex="-1"></a></span>
<span id="cb43-82"><a href="#cb43-82" tabindex="-1"></a>LongError[Jam] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Jam],</span>
<span id="cb43-83"><a href="#cb43-83" tabindex="-1"></a>                         <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb43-84"><a href="#cb43-84" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">1</span>,<span class="dv">1</span>])}))</span>
<span id="cb43-85"><a href="#cb43-85" tabindex="-1"></a></span>
<span id="cb43-86"><a href="#cb43-86" tabindex="-1"></a>LongError[Fla] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Fla],</span>
<span id="cb43-87"><a href="#cb43-87" tabindex="-1"></a>                         <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb43-88"><a href="#cb43-88" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">2</span>,<span class="dv">1</span>])}))</span>
<span id="cb43-89"><a href="#cb43-89" tabindex="-1"></a></span>
<span id="cb43-90"><a href="#cb43-90" tabindex="-1"></a>LongError[PR] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[PR],</span>
<span id="cb43-91"><a href="#cb43-91" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb43-92"><a href="#cb43-92" tabindex="-1"></a>                                                 sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">3</span>,<span class="dv">1</span>])}))</span>
<span id="cb43-93"><a href="#cb43-93" tabindex="-1"></a></span>
<span id="cb43-94"><a href="#cb43-94" tabindex="-1"></a><span class="co"># Calculate the error in latitude derived from</span></span>
<span id="cb43-95"><a href="#cb43-95" tabindex="-1"></a><span class="co"># geolocators from the true capture location </span></span>
<span id="cb43-96"><a href="#cb43-96" tabindex="-1"></a></span>
<span id="cb43-97"><a href="#cb43-97" tabindex="-1"></a>LatError[Jam] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Jam],</span>
<span id="cb43-98"><a href="#cb43-98" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb43-99"><a href="#cb43-99" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">1</span>,<span class="dv">2</span>])}))</span>
<span id="cb43-100"><a href="#cb43-100" tabindex="-1"></a></span>
<span id="cb43-101"><a href="#cb43-101" tabindex="-1"></a>LatError[Fla] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Fla],</span>
<span id="cb43-102"><a href="#cb43-102" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb43-103"><a href="#cb43-103" tabindex="-1"></a>                                                 sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">2</span>,<span class="dv">2</span>])}))</span>
<span id="cb43-104"><a href="#cb43-104" tabindex="-1"></a></span>
<span id="cb43-105"><a href="#cb43-105" tabindex="-1"></a>LatError[PR] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[PR],</span>
<span id="cb43-106"><a href="#cb43-106" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb43-107"><a href="#cb43-107" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">3</span>,<span class="dv">2</span>])}))</span>
<span id="cb43-108"><a href="#cb43-108" tabindex="-1"></a></span>
<span id="cb43-109"><a href="#cb43-109" tabindex="-1"></a><span class="co"># Get co-variance matrix for error of </span></span>
<span id="cb43-110"><a href="#cb43-110" tabindex="-1"></a><span class="co"># known non-breeding deployment sites </span></span>
<span id="cb43-111"><a href="#cb43-111" tabindex="-1"></a></span>
<span id="cb43-112"><a href="#cb43-112" tabindex="-1"></a><span class="co"># lm does multivariate normal models if you give it a matrix dependent variable!</span></span>
<span id="cb43-113"><a href="#cb43-113" tabindex="-1"></a></span>
<span id="cb43-114"><a href="#cb43-114" tabindex="-1"></a>geo.error.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(LongError,LatError) <span class="sc">~</span> <span class="dv">1</span>) </span>
<span id="cb43-115"><a href="#cb43-115" tabindex="-1"></a></span>
<span id="cb43-116"><a href="#cb43-116" tabindex="-1"></a>geo.bias <span class="ot">&lt;-</span> <span class="fu">coef</span>(geo.error.model)</span>
<span id="cb43-117"><a href="#cb43-117" tabindex="-1"></a>geo.vcov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(geo.error.model)</span></code></pre></div>
</div>
<div id="FLightR_bias" class="section level4">
<h4>FLightR</h4>
<p>The code below is a repeatable example for how to calculate location
bias and location error using location estimates derived from
light-level geolocators analyzed in FLightR <span class="citation">(Rakhimberdiev et al. 2017,
<strong>lisovski_lightlevel_2020?</strong>)</span>. The geolocator data
were processed and reported by <span class="citation">Witynski and
Bonter (2018)</span>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># Capture locations #</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="co"># See dates and summary data from Table 1. page 44.</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="co"># Maine #129</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="co"># Maine #132</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="co"># Maine #136</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="co"># Maine #137</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="co"># Wisconsin #139</span></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a><span class="co"># Wisconsin #144</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="co"># Wisconsin #146</span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>caplocs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">70.6142</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">87.8123</span>,<span class="dv">3</span>)),</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">42.9891</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="fl">42.5000</span>,<span class="dv">3</span>)))</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a><span class="co"># Departures #</span></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>departs <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">&quot;2015-09-04&quot;</span>,<span class="st">&quot;2015-08-22&quot;</span>,<span class="st">&quot;2015-09-04&quot;</span>,<span class="st">&quot;2015-08-28&quot;</span>,<span class="st">&quot;2015-08-24&quot;</span>,<span class="st">&quot;2015-08-24&quot;</span>,<span class="st">&quot;2015-08-30&quot;</span>))</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a><span class="co"># read in the daily location data #</span></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>EstLocs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Yellow Warbler_Witynski (1).csv&quot;</span>)</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>YEWAsf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(EstLocs, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;location.long&quot;</span>,<span class="st">&quot;location.lat&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>caplocs_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">bird =</span> <span class="fu">c</span>(<span class="dv">129</span>,<span class="dv">132</span>,<span class="dv">136</span>,<span class="dv">137</span>,<span class="dv">139</span>,<span class="dv">144</span>,<span class="dv">146</span>),</span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>                                  <span class="at">longitude =</span> caplocs[,<span class="dv">1</span>],</span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>                                  <span class="at">latitude =</span> caplocs[,<span class="dv">2</span>]),</span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>),</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a><span class="co"># project into meters #</span></span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>YEWAmeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(YEWAsf,<span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a>CapMeters <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(caplocs_sf, <span class="st">&#39;ESRI:102010&#39;</span>)</span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a><span class="co"># split birds into their own data #</span></span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a>YEWAests <span class="ot">&lt;-</span> <span class="fu">split</span>(YEWAmeters, <span class="at">f=</span>YEWAmeters<span class="sc">$</span><span class="st">&#39;individual.local.identifier&#39;</span>)</span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" tabindex="-1"></a><span class="co"># Empirical estimates of bias and vcov, but on mean locations by bird</span></span>
<span id="cb44-37"><a href="#cb44-37" tabindex="-1"></a>ests2 <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="at">x =</span> YEWAests,</span>
<span id="cb44-38"><a href="#cb44-38" tabindex="-1"></a>                <span class="at">lats =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">2</span>],</span>
<span id="cb44-39"><a href="#cb44-39" tabindex="-1"></a>                <span class="at">lng =</span> <span class="fu">st_coordinates</span>(CapMeters)[,<span class="dv">1</span>],</span>
<span id="cb44-40"><a href="#cb44-40" tabindex="-1"></a>                <span class="at">z =</span> departs,</span>
<span id="cb44-41"><a href="#cb44-41" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x,lats,lng,z){</span>
<span id="cb44-42"><a href="#cb44-42" tabindex="-1"></a>                  <span class="co"># keep only data from deployment until departure from breeding #</span></span>
<span id="cb44-43"><a href="#cb44-43" tabindex="-1"></a>                  newdata <span class="ot">&lt;-</span> x[x<span class="sc">$</span>timestamp<span class="sc">&lt;</span>z,]</span>
<span id="cb44-44"><a href="#cb44-44" tabindex="-1"></a></span>
<span id="cb44-45"><a href="#cb44-45" tabindex="-1"></a>                  <span class="co"># calculate the difference in meters from estimated location</span></span>
<span id="cb44-46"><a href="#cb44-46" tabindex="-1"></a>                  <span class="co"># to actual capture location</span></span>
<span id="cb44-47"><a href="#cb44-47" tabindex="-1"></a>                  long <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">1</span>]) <span class="sc">-</span> lng</span>
<span id="cb44-48"><a href="#cb44-48" tabindex="-1"></a>                  lat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">st_coordinates</span>(newdata)[,<span class="dv">2</span>]) <span class="sc">-</span> lats</span>
<span id="cb44-49"><a href="#cb44-49" tabindex="-1"></a></span>
<span id="cb44-50"><a href="#cb44-50" tabindex="-1"></a>                  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">difflong =</span> long,</span>
<span id="cb44-51"><a href="#cb44-51" tabindex="-1"></a>                                    <span class="at">difflat =</span> lat))},</span>
<span id="cb44-52"><a href="#cb44-52" tabindex="-1"></a></span>
<span id="cb44-53"><a href="#cb44-53" tabindex="-1"></a>               <span class="at">SIMPLIFY =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-54"><a href="#cb44-54" tabindex="-1"></a></span>
<span id="cb44-55"><a href="#cb44-55" tabindex="-1"></a>(geoBiasYEWA <span class="ot">&lt;-</span> <span class="fu">apply</span>(ests2, <span class="dv">1</span>, mean)) <span class="co">#Bias</span></span>
<span id="cb44-56"><a href="#cb44-56" tabindex="-1"></a><span class="co">#  difflong   difflat</span></span>
<span id="cb44-57"><a href="#cb44-57" tabindex="-1"></a><span class="co"># -6512.898 50964.969</span></span>
<span id="cb44-58"><a href="#cb44-58" tabindex="-1"></a></span>
<span id="cb44-59"><a href="#cb44-59" tabindex="-1"></a><span class="fu">apply</span>(ests2, <span class="dv">1</span>, var) <span class="co">#Variances</span></span>
<span id="cb44-60"><a href="#cb44-60" tabindex="-1"></a><span class="fu">apply</span>(ests2, <span class="dv">1</span>, sd)</span>
<span id="cb44-61"><a href="#cb44-61" tabindex="-1"></a></span>
<span id="cb44-62"><a href="#cb44-62" tabindex="-1"></a>(geoVCovYEWA <span class="ot">&lt;-</span> <span class="fu">cov</span>(<span class="fu">t</span>(ests2))) <span class="co">#Variance-covariance matrix</span></span>
<span id="cb44-63"><a href="#cb44-63" tabindex="-1"></a></span>
<span id="cb44-64"><a href="#cb44-64" tabindex="-1"></a><span class="co">#            difflong    difflat</span></span>
<span id="cb44-65"><a href="#cb44-65" tabindex="-1"></a><span class="co"># difflong  259401516 -894387951</span></span>
<span id="cb44-66"><a href="#cb44-66" tabindex="-1"></a><span class="co"># difflat  -894387951 4708578511</span></span></code></pre></div>
</div>
<div id="literature-cited" class="section level3">
<h3>Literature Cited</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-bay_genetic_2021" class="csl-entry">
Bay, R. A., D. S. Karp, J. F. Saracco, W. R. L. Anderegg, L. O.
Frishkoff, D. Wiedenfeld, T. B. Smith, and K. Ruegg. 2021. <a href="https://doi.org/10.1111/ele.13706">Genetic <span>Variation</span>
<span>Reveals</span> <span>Individual</span>-<span>Level</span>
<span>Climate</span> <span>Tracking</span> across the
<span>Annual</span> <span>Cycle</span> of a <span>Migratory</span>
<span>Bird</span></a>. Ecology Letters 24:819–828.
</div>
<div id="ref-cohen_quantifying_2018" class="csl-entry">
Cohen, E. B., J. A. Hostetler, M. T. Hallworth, C. S. Rushing, T. S.
Sillett, and P. P. Marra. 2018. Quantifying the strength of migratory
connectivity. Methods in Ecology and Evolution 9:513–524.
</div>
<div id="ref-rakhimberdiev_flightr_2017" class="csl-entry">
Rakhimberdiev, E., A. Saveliev, T. Piersma, and J. Karagicheva. 2017. <a href="https://doi.org/10.1111/2041-210X.12765"><span>FLightR</span>:
<span>An</span> r <span>Package</span> for <span>Reconstructing</span>
<span>Animal</span> <span>Paths</span> from <span>Solar</span>
<span>Geolocation</span> <span>Loggers</span></a>. Methods in Ecology
and Evolution 8:1482–1487.
</div>
<div id="ref-witynski_crosswise_2018" class="csl-entry">
Witynski, M. L., and D. N. Bonter. 2018. <a href="https://doi.org/10.1111/jofo.12237">Crosswise
<span>Migration</span> by <span>Yellow</span> <span>Warblers</span>,
<span>Nearctic</span>-<span>Neotropical</span> <span>Passerine</span>
<span>Migrants</span></a>. Journal of Field Ornithology 89:37–46.
</div>
<div id="ref-wotherspoon_sgat_2017" class="csl-entry">
Wotherspoon, S. 2017. <span>SGAT</span>:
<span>Solar</span>/<span>Satellite</span> <span>Geolocation</span> for
<span>Animal</span> <span>Tracking</span>.
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
