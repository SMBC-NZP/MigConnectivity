<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Jeff Hostetler, Mike Hallworth, Clark Rushing, Emily Cohen" />

<meta name="date" content="2017-02-20" />

<title>MigConnectivity package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">‘MigConnectivity’ package</h1>
<h4 class="author"><em>Jeff Hostetler, Mike Hallworth, Clark Rushing, Emily Cohen</em></h4>
<h4 class="date"><em>2017-02-20</em></h4>
</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Technological advancements have spurred rapid growth in the study of migratory connectivity, the spatial and temporal linkage of migratory populations throughout the annual cycle. However, the lack of a quantitative definition for the strength of migratory connectivity (MC) has limited our ability to draw inferences across species, studies, and data types about the seasonal co-occurrence of populations. MC is a standardized metric to quantify migratory connectivity between two phases of the annual cycle. It is independent of data type and accounts for the relative abundance of populations distributed across a seasonal range. Negative values of MC indicate that individuals close to each other in one season are further apart in the other season. If MC = 0, no relationship exists between distances in one season and another; if MC = 1, the relative distances between individuals in one season are the same in the other, although the scale can differ.</p>
<p>Three data inputs are needed to calculate MC:</p>
<ol style="list-style-type: decimal">
<li><p>The probabilities of movement between regions (i.e., transition probabilities);</p></li>
<li><p>Distances between regions within the two distinct seasonal ranges (e.g., a matrix of distances between all regions within the breeding range and a matrix of distances between all regions within the non-breeding range);</p></li>
<li><p>Relative abundance among regions within the seasonal range from which the transition probabilities originate (e.g., relative abundance among breeding regions).</p></li>
</ol>
<p>MC takes the distances between the regions within the seasonal range from which the transition probabilities originate (e.g. breeding) and the distances between the regions within the other seasonal range (e.g. non-breeding) and determines the correlation between those distances. Earlier methods used the correlation between two distance matrices of individual birds captured during the breeding phase and recaptured during the non-breeding phase as a measure of the strength of migratory connectivity. Our method builds on this method with a distance-based correlation coefficient, but is not specific to a data type and uses transition probabilities from discreet regions, as opposed to distance matrices between individuals. Further, we include relative abundance within one seasonal range to account for uneven sampling among regions.</p>
<p>Cohen, E. B., J.A. Hostetler, M.T. Hallworth, C.S. Rushing, T.S. Sillett, P.P. Marra. In revision. A quantitative definition for the strength of migratory connectivity.</p>
<div id="overview-of-functions" class="section level3">
<h3>Overview of Functions</h3>
<ol style="list-style-type: decimal">
<li><p><code>calcMC</code> calculates the strength of migratory connectivity (MC) with the probabilities of movement between regions, distances between regions within the two seasonal ranges, and relative abundance among regions within the seasonal range from which the transition probabilities originate.</p></li>
<li><p><code>estMC</code> estimates the strength of migratory connectivity (MC) with estimates of uncertainty. MC estimated either with transition probability estimates or individual assignments to regions from tracking data. Uses resampling to measure MC uncertainty from RMark transition probability matrix estimates and/or JAGS relative abundance MCMC samples OR geolocator and/or GPS data.</p></li>
<li><p><code>simMove</code> Simulates annual movement of animals between regions across seasons for years and months with individual variability and strength of migratory connectivity (MC). Incorporates movement among regions within a season and movement among regions between seasons. Between seasons, animals either return to the same region each year or return to a different region in the subsequent year (dispersal). Between year dispersal rates occur during the first year (natal) or any subsequent year (breeding or non-breeding). Simulation does not incorporate births or deaths.</p></li>
</ol>
</div>
</div>
<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<div id="installing-migconnectivity-from-github" class="section level3">
<h3>Installing ‘MigConnectivity’ from GitHub</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">'devtools'</span>)

devtools::<span class="kw">install_github</span>(<span class="st">&quot;SMBC-NZP/MigConnectivity&quot;</span>)

<span class="kw">library</span>(MigConnectivity)</code></pre>
</div>
<div id="functions" class="section level3">
<h3>Functions</h3>
<p><code>calcMC</code> Calculate strength of migratory connectivity (MC)<br /><code>estMC</code> Estimate the strength of migratory connectivity (MC) while incorporting location uncertainty</p>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div id="calcmc---calculate-strength-of-migratory-connectivity" class="section level3">
<h3><code>calcMC</code> - Calculate strength of migratory connectivity</h3>
<p>This function calculates the strength of migratory connectivity between populations during two different time periods within the annual cycle. Below, we illustrate how to calculate the strength of MC between three breeding and non-breeding regions.</p>
<p>To calculate the strength of MC, you will need:</p>
<ol style="list-style-type: decimal">
<li>to define the number of breeding and non-breeding regions<br /></li>
<li>the distance between the breeding regions and the distance between the non-breeding regions<br /></li>
<li>the transition probabilities between each breeding and non-breeding region (<code>psi</code>)<br /></li>
<li>the relative or the absolute abundance within each of the regions where individuals originate from (here the breeding regions).</li>
</ol>
</div>
<div id="calculate-mc-between-breeding-and-non-breeding-regions" class="section level3">
<h3>Calculate MC between breeding and non-breeding regions</h3>
<p>Simple example with three breeding and three non-breeding regions</p>
<p>Define the number of breeding and non-breeding populations</p>
<pre class="sourceCode r"><code class="sourceCode r">nBreeding &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">#number of breeding regions</span>
nNonBreeding &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">#number of non-breeding regions</span></code></pre>
<p>Generate a distance matrix between the different regions</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#distances between centriods of three breeding regions</span>
breedDist &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,
                      <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,
                      <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>), nBreeding, nBreeding) 

<span class="co">#distances between centriods of three non-breeding regions</span>
nonBreedDist &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>,
                         <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>,
                        <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">0</span>), nNonBreeding, nNonBreeding)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>Define the transition probabilities between the breeding and non-breeding regions</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#transition probabilities form each breeding to each non-breeding region</span>
psi &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">0.35</span>, <span class="fl">0.25</span>,
                <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>,
                <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>), nBreeding, nNonBreeding, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) </code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>Define the relative abundance within the three breeding regions</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#equal relative abundance among the three breeding regions, must sum to 1                      </span>
relN &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>/nBreeding, nBreeding) 

relN
<span class="co">#&gt; [1] 0.3333333 0.3333333 0.3333333</span>
<span class="co">#equal absolute abundance among the three breeding regions, each must be &gt;= 1 </span>
N &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">3000</span>, nBreeding)</code></pre>
<p>Calculate the strength of migratory connectivity using the simulated data above</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate the strength of migratory connectivity </span>
MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> breedDist,
             <span class="dt">targetDist =</span> nonBreedDist,
             <span class="dt">psi =</span> psi,
             <span class="dt">originRelAbund =</span> relN)

<span class="kw">round</span>(MC,<span class="dv">3</span>)
<span class="co">#&gt; [1] 0.05</span>
MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> breedDist,
             <span class="dt">targetDist =</span> nonBreedDist,
             <span class="dt">psi =</span> psi,
             <span class="dt">originAbund =</span> N)

<span class="kw">round</span>(MC,<span class="dv">3</span>)
<span class="co">#&gt; [1] 0.05</span></code></pre>
</div>
<div id="estmc---estimate-strength-of-migratory-connectivity-incorporating-location-uncertainty" class="section level3">
<h3><code>estMC</code> - Estimate strength of migratory connectivity incorporating location uncertainty</h3>
<p>Estimates of MC may also be influenced by error in individual assignment to regions. Data types vary in locational accuracy and precision, which are likely to influence the accuracy with which individuals are assigned to regions.</p>
<p>To estimate MC and include location uncertainty the following data are needed:</p>
<ol style="list-style-type: decimal">
<li>A logical vector indicating the type of device the location estimates were derived from (GPS = FALSE, Light-level geolocator = TRUE)<br /></li>
<li>Location Bias - a vector that has error estimates for both longitude and latitude<br /></li>
<li>Location error - a variance, covariance matrix of longitude and latitude<br /></li>
<li>Distance matrix between breeding and non-breeding regions<br /></li>
<li>A shapefile of both breeding and non-breeding regions<br /></li>
<li>The deployment locations and the ‘unknown’ locations derived from the tracking devices<br /></li>
<li>The relative (or absolute) abundance within each region where the birds originate from (deployment regions)</li>
</ol>
<p>We measured MC for bootstrapped data of birds tracked from breeding to non-breeding regions using light-level and GPS geolocation when 1) GPS location uncertainty was applied to all individuals, 2) GPS and light-level location uncertainty were applied to individuals with those devices, and 3) light-level location uncertainty was applied to all individuals.</p>
<p>Load location data that accompanies the <code>MigConnectivity</code> package. The location data are data from breeding Ovenbirds that were fit with Light-level geolocators or PinPoint-10 GPS tags.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(OVENdata) <span class="co"># Ovenbird </span>

<span class="kw">names</span>(OVENdata)
<span class="co">#&gt;  [1] &quot;geo.bias&quot;       &quot;geo.vcov&quot;       &quot;isGL&quot;           &quot;targetPoints&quot;  </span>
<span class="co">#&gt;  [5] &quot;originPoints&quot;   &quot;targetSites&quot;    &quot;originSites&quot;    &quot;originRelAbund&quot;</span>
<span class="co">#&gt;  [9] &quot;originDist&quot;     &quot;targetDist&quot;</span></code></pre>
<p>The figure below shows the two breeding regions (squares), and the three non-breeding regions (gray scale) used in Cohen et al. (<em>in revision</em>) to estimate MC for Ovenbirds tracked with light-level geolocators and PinPoint-10 GPS tags.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">'rgeos'</span>, <span class="st">'shape'</span>, <span class="st">'raster'</span>, <span class="st">'maptools'</span>))</code></pre>
<pre><code>#&gt; CRS arguments:
#&gt;  +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>The following code demonstrates how to estimate MC using location data from light-level geolocators and PinPoint-10 GPS tags.</p>
<pre class="sourceCode r"><code class="sourceCode r">M&lt;-<span class="kw">estMC</span>(<span class="dt">isGL=</span>OVENdata$isGL, <span class="co"># Logical vector indicating light-level geolocator (T) GPS (F)</span>
      <span class="dt">geoBias =</span> OVENdata$geo.bias, <span class="co"># Light-level geolocator location bias</span>
      <span class="dt">geoVCov =</span> OVENdata$geo.vcov, <span class="co"># Light-level geolocator co-variance matrix</span>
      <span class="dt">targetDist =</span> OVENdata$targetDist, <span class="co"># Non-breeding target distribution distance matrix</span>
      <span class="dt">originDist =</span> OVENdata$originDist, <span class="co"># Breeding / origin distribution distance matrix</span>
      <span class="dt">targetSites =</span> OVENdata$targetSites, <span class="co"># Non-breeding target sites</span>
      <span class="dt">originSites =</span> OVENdata$originSites, <span class="co"># Breeding origin sites </span>
      <span class="dt">originPoints =</span> OVENdata$originPoints, <span class="co"># Capture Locations </span>
      <span class="dt">targetPoints =</span> OVENdata$targetPoints, <span class="co"># Non-breeding Locations derived from devices</span>
      <span class="dt">originRelAbund =</span> OVENdata$originRelAbund, <span class="co"># Relative abundance within OriginSites</span>
      <span class="dt">verbose =</span> <span class="dv">0</span>,   <span class="co"># output options - see help ??estMC</span>
      <span class="dt">nSim =</span> <span class="dv">10</span>,     <span class="co"># This is set low for example</span>
      <span class="dt">nSamples =</span> <span class="dv">10</span>) <span class="co"># This is set low for example </span>

<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">plot</span>(wrld_simple,<span class="dt">xlim=</span><span class="kw">c</span>(raster::<span class="kw">extent</span>(OVENdata$targetSites)[<span class="dv">1</span>],
                        raster::<span class="kw">extent</span>(OVENdata$targetSites)[<span class="dv">2</span>]),
                 <span class="dt">ylim=</span><span class="kw">c</span>(raster::<span class="kw">extent</span>(OVENdata$targetSites)[<span class="dv">3</span>],
                        raster::<span class="kw">extent</span>(OVENdata$originSites)[<span class="dv">4</span>]))
<span class="kw">plot</span>(OVENdata$originSites[<span class="dv">1</span>],<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="fl">1.75</span>)
<span class="kw">plot</span>(OVENdata$originSites[<span class="dv">2</span>],<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="fl">1.75</span>)
<span class="kw">plot</span>(OVENdata$targetSites,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="fl">1.5</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;gray70&quot;</span>,<span class="st">&quot;gray35&quot;</span>,<span class="st">&quot;gray10&quot;</span>))

<span class="kw">legend</span>(<span class="dv">400000</span>,-<span class="dv">2105956</span>,<span class="dt">legend=</span><span class="kw">paste</span>(<span class="st">&quot;MC =&quot;</span>,<span class="kw">round</span>(M$meanMC,<span class="dv">2</span>), <span class="st">&quot;\u00b1&quot;</span>, <span class="kw">round</span>(M$seMC,<span class="dv">2</span>)),<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,<span class="dt">cex=</span><span class="fl">1.8</span>,<span class="dt">bg=</span><span class="st">&quot;white&quot;</span>,<span class="dt">xjust=</span><span class="dv">0</span>)

shape::<span class="kw">Arrows</span>(<span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">1</span>])@coords[,<span class="dv">1</span>],
              <span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">1</span>])@coords[,<span class="dv">2</span>],
              <span class="kw">gCentroid</span>(OVENdata$targetSites[<span class="dv">2</span>])@coords[,<span class="dv">1</span>]+<span class="dv">80000</span>,
              <span class="kw">extent</span>(OVENdata$targetSites[<span class="dv">2</span>])[<span class="dv">4</span>]+<span class="dv">150000</span>,
              <span class="dt">arr.length =</span> <span class="fl">0.3</span>,
              <span class="dt">arr.adj =</span> <span class="fl">0.5</span>,
              <span class="dt">arr.lwd =</span> <span class="dv">1</span>,
              <span class="dt">arr.width =</span> <span class="fl">0.4</span>,
              <span class="dt">arr.type =</span> <span class="st">&quot;triangle&quot;</span>,
              <span class="dt">lwd=</span>(<span class="kw">apply</span>(M$samplePsi[,<span class="dv">1</span>,],<span class="dv">2</span>,mean)[<span class="dv">2</span>]*<span class="dv">10</span>),
              <span class="dt">lty=</span><span class="dv">1</span>)

shape::<span class="kw">Arrows</span>(<span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">1</span>])@coords[,<span class="dv">1</span>],
              <span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">1</span>])@coords[,<span class="dv">2</span>],
              <span class="kw">gCentroid</span>(OVENdata$targetSites[<span class="dv">3</span>])@coords[,<span class="dv">1</span>],
              <span class="kw">extent</span>(OVENdata$targetSites[<span class="dv">3</span>])[<span class="dv">4</span>]+<span class="dv">150000</span>,
              <span class="dt">arr.length =</span> <span class="fl">0.3</span>,
              <span class="dt">arr.adj =</span> <span class="fl">0.5</span>,
              <span class="dt">arr.lwd =</span> <span class="dv">1</span>,
              <span class="dt">arr.width =</span> <span class="fl">0.4</span>, 
              <span class="dt">arr.type =</span> <span class="st">&quot;triangle&quot;</span>,
              <span class="dt">lwd=</span>(<span class="kw">apply</span>(M$samplePsi[,<span class="dv">1</span>,],<span class="dv">2</span>,mean)[<span class="dv">3</span>]*<span class="dv">10</span>),
              <span class="dt">lty=</span><span class="dv">1</span>)

shape::<span class="kw">Arrows</span>(<span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">2</span>])@coords[,<span class="dv">1</span>],
              <span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">2</span>])@coords[,<span class="dv">2</span>],
              <span class="kw">gCentroid</span>(OVENdata$targetSites[<span class="dv">1</span>])@coords[,<span class="dv">1</span>],
              <span class="kw">extent</span>(OVENdata$targetSites[<span class="dv">1</span>])[<span class="dv">4</span>]+<span class="dv">150000</span>,
              <span class="dt">arr.length =</span> <span class="fl">0.3</span>,
              <span class="dt">arr.adj =</span> <span class="fl">0.5</span>,
              <span class="dt">arr.lwd =</span> <span class="dv">1</span>,
              <span class="dt">arr.width =</span> <span class="fl">0.4</span>,
              <span class="dt">arr.type =</span> <span class="st">&quot;triangle&quot;</span>,
              <span class="dt">lwd=</span>(<span class="kw">apply</span>(M$samplePsi[,<span class="dv">2</span>,],<span class="dv">2</span>,mean)[<span class="dv">1</span>]*<span class="dv">10</span>),
              <span class="dt">lty=</span><span class="dv">1</span>)

shape::<span class="kw">Arrows</span>(<span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">2</span>])@coords[,<span class="dv">1</span>],
              <span class="kw">gCentroid</span>(OVENdata$originSites[<span class="dv">2</span>])@coords[,<span class="dv">2</span>],
              (<span class="kw">gCentroid</span>(OVENdata$targetSites[<span class="dv">2</span>])@coords[,<span class="dv">1</span>]-<span class="dv">80000</span>),
              <span class="kw">extent</span>(OVENdata$targetSites[<span class="dv">2</span>])[<span class="dv">4</span>]+<span class="dv">150000</span>,
              <span class="dt">arr.length =</span> <span class="fl">0.3</span>,
              <span class="dt">arr.adj =</span> <span class="fl">0.5</span>,
              <span class="dt">arr.lwd =</span> <span class="dv">1</span>,
              <span class="dt">arr.width =</span> <span class="fl">0.4</span>,
              <span class="dt">arr.type =</span> <span class="st">&quot;triangle&quot;</span>,
              <span class="dt">lwd=</span>(<span class="kw">apply</span>(M$samplePsi[,<span class="dv">2</span>,],<span class="dv">2</span>,mean)[<span class="dv">2</span>]*<span class="dv">10</span>))

<span class="kw">box</span>(<span class="dt">which=</span><span class="st">&quot;plot&quot;</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAD1BMVEUAAAAaGhpZWVmzs7P///8zYQijAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMJUlEQVR4nO2diXbjIAxFlZb//+aZxgYESCB2L9I50yYY64lbEIvTDoBawYyzv9ff92exu4YrTbdEyxfYaIGtWyhviCZsO6TBJBdmW6pkxSGpMT8qELd8GSJK5+zWaY3pQckBLUNEquA4/cCvib41miqJJYhoDaLXLPl51f4MFvzISuVL+VQDmo+IdS+dwcZayyiei4jvQRCKXxfQXESMa4gBLZpUW+eBbkSty9m7AOqOrziZRxfcbXcB1BsgcTsfSrioH6IvtS5APeMsvpUJBNL1YDSZTbaOtShAT5TRFpCdu+Arc0tApitKblecVPteTvfN9wDUEabNJAV9O7mHhV19t866AXXNguWbge4v605fegE1/yxBJk32oHUDrBuQaY5VoItyz8oTzSiITYAqek+7yAgbcOQ0bTeHNxgNEmNsyJlcvQ9R6iIOEdfboEPLWi8CQOHzltqAhtmwU90qNyCoD+ybpXZZQJB5t9LGPReo8AOC6m8GJNpLKaAqd68CJDqugOzbhTbw2aTUUQ6QC+fFgHInpv7wUAFRtfEDjOflIGErcvtzBWTkgB63kjaS3UNpf852oWcAyjQjfDrK1kWAnjjE+MfqxAUF5BXkdT2hJ07zTOKtqPt4QOQDd3lVg8dYONAeDIhNTHRplIWYncdCuzAgfGz0ZEAcCro0XCu655IKyJZ6O9/naq+wBYCqsDk8OAM9BtCwdRBA9LGpBwNqmuYdo3i6X2+TAWU+dsiEg/L082axxFXGdwmQ2NFkmwoo51oBFZ7Xy6b5fO0VNg9QwS/bg8gu9AxA2FPRLXce9BJAZadUkoFwmudrL7SBgNCyTuCTA2ReACiZzAbYqCCrbZw2v2+SKHzXhXA+99gNBdtwQIQ/EaBjf2q/PhGQTSPMhXIcYH9z5amADPd7CVJArgddidDQMKpOV8k6DwfEacjrKKBCJXsIfR1ClwFkwSigbC0FVKjln/NchdCFAB3ZWQFx1xVQ4bICYiNA3x2gyxC6ACAbyPlVAcUB4O8KiL0YA7oKoc2AwHWhcKthFNCp7g5JFBCrfZ62nkXo6PYShPYBArfvUkCMMPj0g1K1AnLCBUDXIHQFQOEjRwXkhBWQ1aB1KUIBoEsQ2gzIQFhDASFdBIhO0m8GZEeYfdZIA7oCod2Aok+MKyAva5uugCSAfHlYez+h3UMM7cmOcgV0qqIehGJQQE4VI2JW0kYBxb/1lADaT2gLIIh6EL6igE5R34NAexAlKgS0ndAOQBADwpcU0KmJF0L4kgIKAJV70G5CGwBB0IPinKyAjF0duhGmPYiU9O3OA9pMaAmgOmNunx4mbeuVrSJqdrAOom54O6DguIO8Yx+h5cKggISCOEnjI1fylpcDgjygrYRW60IE6DwP8oXcTS8C5F99W31+sYXMTe8F9MXjPkHFRLOR0GJZSAGZc/18piP2ttcAQi/RNK+AErkAEJgsoI2E1qoCA8gdCykgvO1CScgooEQNzfKggJxYAigkw0azjdBqQMGbaHwZBZQCOqev/F7MvAQQUIAA8+EBbSO0GFD4DjCkszBzcxOg3vbtA+SnscKRK65dHWx38xYCittHdKBce9oI3QxQ/D5OQeMBddt2QHGd3O3PBpS0rhLQJkJLASUFCiinpIBioU5AewitBJSWKKCckAKKdLoBbSG0EFBaooB4HXyWGBbnnTwVUNSu8xCxFtAOQusA4Xe2TAHRMgqIUMFnib5QAREq0A5oA6EdgHyhAnIiCkguEg6xZHlUdLWW0HpA+BGGArIaxAhTQKRG2JfqAS0nNFELUDZ2ZZH2ywGB23PZorTC2wHh5gjOXAXRLCY0UyoClAgpIGzs31+IiqReh0VZlpvpO2REXo+KxG6HhVlUm+k7i+j1gEpdSAHlR1groLWE1gHiLkdFcrdjYhSITXWugErez8ZQKq2AlhJaA4hYJRoFZBACUkQBuf2qAiq5HwtoJaHZgIJvqfbrAVkVTlsBHSKsdtxMaTTrCO0ERHQhBRSLK6BDhRVvBLSO0HwRbqNhFNCp8Mu25CWAALLRwu9/Gw5oGaFWDUD2exgw198IyFNBBkBQ+30poBQPZycg4WasIppFhFp7kJwQMf6Q+BMBfc93agm9DVDNIOMJdQFaRKhe4fxD/SgpxygUEDoqNNGURiI7LpDiDwOEpvGoGHOgEQ0HtIaQSAAio2q4DnS8F3WhJwDyQWQrfvsMN+xYQk8AdNYy4X/iRPmJ9qSSQdYJaAkhof/MwxvvKHAl6UK3AVSWOM50CvXi8/ciodsCotOpBGR8jwRQ2O9qFXYAov7wfiUc67u2C1W2dgEhsAsXNANFOMDVanCfJ3QTQFbBykWHyLZoyLY/WWHeABCVcYL/6+JE1BRHkqmHAlpAiPUOYRX+0UTB/2MB+YWN3T00EUoBRaP3voB8AJKKrIO5gOYTyjoPtg6N7h8NaIT7GFBASAEVDob6AU0ntANQMEG+HhAQaSi8rID4LjQA0GxCkwHR59MKKPCfSdO4beVzXVbhzoDINO0Ioba174jnEtoEKDg/MPbEoK2dNwdEP6QOD1jwOLvaGFsAKNOFbNNwUmpRmEhoPqBcFoK4ba8E9P0YZxaQq/hSQNRcH2fpnnAUkMD/NEJLAFHHQk5eARmqC7GAGt3fHFBKiADUuNXwbqa0ZBGgZJRRPQgsoCudeewCFMzzuJYrrnN+f0B0F8rkoIsQWgco3JRBEVAVoWcAAgg/7GkUUCpXBIQ3HjWOZxFaDSj+NKxv1jF/BeevFZCeAggRsvKelUkBiQk9BtA5yMIjRdrq4ptFaAugHJaQj0EfKskH+hxAtiVyQGgrUvQ7I97hPkuKLt9IAJn0Bed3CqH1gIzbceXx1Mb1IEBkho7emWpCDwEUjp6wy8TjK5jyy2HOIbQWUNyEgAiRf2w1I+lPDwCUxB/1mJSPaAILnY0JFXsd7JFVosZJiIQARBFiIr47IFbfh0A0EcCvC3xRzhfkKzUEOMhTewBR1qarSV25dD8uvkGe2gMIszZXT+aKTfStth2QEQLyxyH8nDaBzwUAiRKwvwQ+JcWhz+hAVwBUZf6X2SIKENkwwXsBAnz+gYpTG6Z4L0CGnMAn8rkfIHIfkiIaqHc3QGzJwwBB468wpo6Qy4cAgnMGGtMQ7nBgkK0E5KIH+PlxLRmpf2dA8Eflv33Z/BwvLadzT1odCj+hjYn5dDjOWVbnhzHboIamUbXvCAiAx/Ml5NNRXevIqmP5LAD0H04Oj+1Ex9eq9nHzYEeTot2LmQ8I9Z2j8xdJwY8wJH6dMHL9MBkQoJafeoXe9CNOIjMiX9yDwPOxBQJAQkQz4k46ZfPfLJHJuTbbgoBOjlWZ0BQ+9Kw4QelwHfNBCzmbbgoDbekqn9abF4TnE51r+aVKoUeBHW0LUPEnvbOkUXrO1XIdie5RZ1/DvbAoDE1UuYcpcwEJo3TLxMyQO+qV/QB8Pp////5e2LWnQJ2rNK/zwrdVaPbCormbGD4uc+U0P6EdvDJyAG7I2yKiTr6hjXY2x76JMjV7VyZno74UH9bbl5/E/Oo8OYj0KzNcSjWkotliOxbEwfTudHJPdvgxFsDiHmfQhI5RFz3SdndTpaH7qpaLLEmRpTQLvq/JGKEbUyicoYicnKQtVW0XmX+250QKGyw8UNzcnulC7jY5nj9CSNAI9yprFmMCFbs0wkcfeTpH0qlBFACSbomv81QjmW2pZRGZfqQjLJ+O+aiuZLh/JICYRUmRUJATKxvcBah+vVrlHHPJKWX5uBsbA227LYx3zkIhxJOPJovHV2uKo/625JZRjwADn9lBFVfmAfUHMmJIThhlIN7IHQEQfWcIn0pAbBboDyQWkgZ21EzmsmHZscJLpuqEHiSu6HJwgGdYUBU/qMzFIaH0WNSDBgYkA1SotBUQtVZcD6jj6jxD23iweeeigPrSYUs2TXYZNlXD55M5IpsVXH6d1sun5R5iQWi3uEM70BUAtRgEYKId7MUAwZYkdAwmZtl6OUBbjN2/ju3P3YBao1m+C5gqMh7QvGOSwdYLaHIr92O8MCC3yZonIYtCUKnhSp8FI3Arol5AU8YA8Rh0vIjQJA1cvxOjHhRPkJHYNQEFXvdOeALxPVt5+yRi9zR2WUBXmOL/DNQK9g/vIJTLr6RIMAAAAABJRU5ErkJggg==" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(M)
<span class="co">#&gt; List of 17</span>
<span class="co">#&gt;  $ sampleMC    : num [1:10] 0.796 0.639 0.589 0.645 0.536 ...</span>
<span class="co">#&gt;  $ samplePsi   : num [1:10, 1:2, 1:3] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 3</span>
<span class="co">#&gt;   .. ..$ : chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;  $ pointPsi    : num [1:2, 1:3] 0 0.4 0.174 0.6 0.826 ...</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;  $ pointMC     : num 0.628</span>
<span class="co">#&gt;  $ meanMC      : num 0.571</span>
<span class="co">#&gt;  $ medianMC    : num 0.562</span>
<span class="co">#&gt;  $ seMC        : num 0.108</span>
<span class="co">#&gt;  $ simpleCI    : Named num [1:2] 0.417 0.796</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;2.5%&quot; &quot;97.5%&quot;</span>
<span class="co">#&gt;  $ bcCI        : Named num [1:2] 0.417 0.796</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;2.5%&quot; &quot;97.5%&quot;</span>
<span class="co">#&gt;  $ hpdCI       : num [1, 1:2] 0.417 0.796</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr &quot;var1&quot;</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] &quot;lower&quot; &quot;upper&quot;</span>
<span class="co">#&gt;   ..- attr(*, &quot;Probability&quot;)= num 0.9</span>
<span class="co">#&gt;  $ sampleCorr  : logi [1:10] NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ pointCorr   : NULL</span>
<span class="co">#&gt;  $ meanCorr    : NULL</span>
<span class="co">#&gt;  $ medianCorr  : NULL</span>
<span class="co">#&gt;  $ seCorr      : NULL</span>
<span class="co">#&gt;  $ simpleCICorr: NULL</span>
<span class="co">#&gt;  $ bcCICorr    : NULL</span></code></pre>
</div>
<div id="function" class="section level3">
<h3>Function</h3>
<p><code>simMove</code> Simulates position of animals by individual, season, year, and month</p>
</div>
<div id="advanced-example--" class="section level3">
<h3>Advanced example -</h3>
<p>Calculate the strength of migratory connectivity based on simulation data for 10 years of movement between breeding and non-breeding seasonal ranges. Breeding and non-breeding ranges are equally divided into 100 regions on an ellipsoid globe. These simulations use utility functions included in the package. See below for details regarding the utility functions to help simulate data.</p>
<p>Simulate data to demonstrate the use of <code>calcMC</code></p>
<div id="utility-functions-for-use-in-simulations" class="section level4">
<h4>Utility Functions for use in simulations</h4>
<p><code>mlogitMat</code>: Calculates probability matrix based on exponential decline with distance</p>
<pre class="sourceCode r"><code class="sourceCode r">mlogitMat &lt;-<span class="st"> </span>function(slope, dist) {
       preMat &lt;-<span class="st"> </span><span class="kw">exp</span>(-slope/<span class="kw">mean</span>(dist)*dist)
       <span class="kw">diag</span>(preMat) &lt;-<span class="st"> </span><span class="dv">0</span>
       nr &lt;-<span class="st"> </span><span class="kw">nrow</span>(dist)
       nc &lt;-<span class="st"> </span><span class="kw">ncol</span>(dist)
       outMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, nr, nc)
  for (b in <span class="dv">1</span>:nr) {
      outMat[b,] &lt;-<span class="st"> </span>preMat[b,]/(<span class="dv">1</span>+<span class="kw">sum</span>(preMat[b, ]))
      outMat[b,b] &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(outMat[b, ])
  }
  <span class="kw">return</span>(outMat)
}</code></pre>
<p><code>mlogitMC</code>: Crude optimizable function for developing migratory connectivity pattern based on migratory connectivity strength</p>
<pre class="sourceCode r"><code class="sourceCode r">mlogitMC &lt;-<span class="st"> </span>function(slope, MC.in, origin.dist, target.dist, origin.rel.abund) {
    nBreeding &lt;-<span class="st"> </span><span class="kw">nrow</span>(origin.dist)
    nWintering &lt;-<span class="st"> </span><span class="kw">nrow</span>(target.dist)
    psi &lt;-<span class="st"> </span><span class="kw">mlogitMat</span>(slope, origin.dist)
  if (<span class="kw">any</span>(psi&lt;<span class="dv">0</span>))
    <span class="kw">return</span>(<span class="dv">5</span>*slope^<span class="dv">2</span>)
  MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(origin.dist, target.dist, psi, origin.rel.abund)
  <span class="kw">return</span>((MC.in -<span class="st"> </span>MC)^<span class="dv">2</span>)
}</code></pre>
<p><code>calcStrengthInd</code>: rho function for individuals</p>
<pre class="sourceCode r"><code class="sourceCode r">calcStrengthInd &lt;-<span class="st"> </span>function(originDist, targetDist, locations, <span class="dt">resamp=</span><span class="dv">1000</span>, <span class="dt">verbose =</span> <span class="dv">0</span>) {
  nInd &lt;-<span class="st"> </span><span class="kw">dim</span>(locations)[<span class="dv">1</span>]
  originDist2 &lt;-<span class="st"> </span>targetDist2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, nInd, nInd)
  for (i in <span class="dv">1</span>:(nInd<span class="dv">-1</span>)) {
    for (j in (i<span class="dv">+1</span>):nInd) {
      originDist2[i,j] &lt;-<span class="st"> </span>originDist2[j,i] &lt;-<span class="st"> </span>originDist[locations[i,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>], locations[j,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]]
      targetDist2[i,j] &lt;-<span class="st"> </span>targetDist2[j,i] &lt;-<span class="st"> </span>targetDist[locations[i,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>], locations[j,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>]]
    }
  }
  <span class="kw">return</span>(ncf::<span class="kw">mantel.test</span>(originDist2, targetDist2, <span class="dt">resamp=</span>resamp, <span class="dt">quiet =</span> !verbose))
} </code></pre>
<p><code>calcPsiMC</code>: Simple approach to estimate psi matrix (transition probabilities) and MC from simulated or real data</p>
<pre class="sourceCode r"><code class="sourceCode r">calcPsiMC &lt;-<span class="st"> </span>function(originDist, targetDist, originRelAbund, locations,
                      <span class="dt">verbose=</span>F) {
  nOrigin &lt;-<span class="st"> </span><span class="kw">nrow</span>(originDist)
  nTarget &lt;-<span class="st"> </span><span class="kw">nrow</span>(targetDist)
  psiMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, nOrigin, nTarget)
  nInd &lt;-<span class="st"> </span><span class="kw">dim</span>(locations)[<span class="dv">1</span>]
  nYears &lt;-<span class="st"> </span><span class="kw">dim</span>(locations)[<span class="dv">3</span>]
  nMonths &lt;-<span class="st"> </span><span class="kw">dim</span>(locations)[<span class="dv">4</span>]
  for (i in <span class="dv">1</span>:nInd) {
    if (i %%<span class="st"> </span><span class="dv">1000</span> ==<span class="st"> </span><span class="dv">0</span> &amp;&amp;<span class="st"> </span>verbose) <span class="co">#</span>
      <span class="kw">cat</span>(<span class="st">&quot;Individual&quot;</span>, i, <span class="st">&quot;of&quot;</span>, nInd, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
    originMat &lt;-<span class="st"> </span>locations[i,<span class="dv">1</span>,,]
    targetMat &lt;-<span class="st"> </span>locations[i,<span class="dv">2</span>,,]
    bIndices &lt;-<span class="st"> </span><span class="kw">which</span>(!<span class="kw">is.na</span>(originMat))
    wIndices &lt;-<span class="st"> </span><span class="kw">which</span>(!<span class="kw">is.na</span>(targetMat))
    if (<span class="kw">length</span>(bIndices) &amp;&amp;<span class="st"> </span><span class="kw">length</span>(wIndices))
      for (bi in bIndices)
        for (wi in wIndices)
          psiMat[originMat[bi], targetMat[wi]] &lt;-<span class="st"> </span>psiMat[originMat[bi],
                                                         targetMat[wi]] +<span class="st"> </span><span class="dv">1</span>
  }
  psiMat &lt;-<span class="st"> </span><span class="kw">apply</span>(psiMat, <span class="dv">2</span>, <span class="st">&quot;/&quot;</span>, <span class="kw">rowSums</span>(psiMat))
  MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(originDist, targetDist, psiMat, originRelAbund)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">psi=</span>psiMat, <span class="dt">MC=</span>MC))
} </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">75</span>)

<span class="co"># Parameters for simulations</span>

nSeasons &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># population with two discrete seasons - breeding / non-breeding</span>
nYears &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co"># Ten years of data</span>
nMonths &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># Four months within each season</span>

nBreeding &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># Number of populations</span>
nWintering &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># Number of populations </span></code></pre>
<p>Generate the spatial arrangement of breeding and non-breeding populations</p>
<pre class="sourceCode r"><code class="sourceCode r">breedingPos &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">seq</span>(-<span class="dv">99</span>,-<span class="dv">81</span>,<span class="dv">2</span>), <span class="dt">each=</span><span class="kw">sqrt</span>(nBreeding)),
                        <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">49</span>,<span class="dv">31</span>,-<span class="dv">2</span>), <span class="kw">sqrt</span>(nBreeding))), nBreeding, <span class="dv">2</span>)
winteringPos &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">seq</span>(-<span class="dv">79</span>,-<span class="dv">61</span>,<span class="dv">2</span>), <span class="dt">each=</span><span class="kw">sqrt</span>(nWintering)),
                         <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">9</span>,-<span class="dv">9</span>,-<span class="dv">2</span>), <span class="kw">sqrt</span>(nWintering))), nWintering, <span class="dv">2</span>)


breedDist &lt;-<span class="st"> </span><span class="kw">distFromPos</span>(breedingPos, <span class="st">'ellipsoid'</span>) <span class="co"># calculate distance between populations</span>
nonbreedDist &lt;-<span class="st"> </span><span class="kw">distFromPos</span>(winteringPos, <span class="st">'ellipsoid'</span>) <span class="co"># calculate distance between populations</span></code></pre>
<p>The relative abundance of the study species is needed in each population. Here we generate those data below.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Breeding Abundance</span>
breedingN &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">500</span>, nBreeding)
breedingRelN &lt;-<span class="st"> </span>breedingN/<span class="kw">sum</span>(breedingN)</code></pre>
<p>The transition probability (psi) between the breeding and non-breeding populations is calculated below.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set up psi matrix</span>
o &lt;-<span class="st"> </span><span class="kw">optimize</span>(mlogitMC, <span class="dt">MC.in =</span> <span class="fl">0.25</span>, <span class="dt">origin.dist =</span> breedDist,
              <span class="dt">target.dist =</span> nonbreedDist, <span class="dt">origin.rel.abund =</span> breedingRelN,
              <span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">tol =</span> .Machine$double.eps^<span class="fl">0.5</span>)

slope &lt;-<span class="st"> </span>o$minimum

psi &lt;-<span class="st"> </span><span class="kw">mlogitMat</span>(slope, breedDist)</code></pre>
<p>Now that we have all the data needed to calculate the strength of migratory connectivity we can use the <code>calcMC</code> function in the <code>MigConnecitivty</code> package to generate a standardized MC metric.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Baseline strength of migratory connectivity</span>
MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> breedDist, 
             <span class="dt">targetDist =</span> nonbreedDist,
             <span class="dt">psi =</span> psi, 
             <span class="dt">originRelAbund =</span> breedingRelN)

<span class="co"># Show Results</span>
MC
<span class="co">#&gt; [1] 0.25</span></code></pre>
</div>
</div>
<div id="simmove-simulation-of-movement-between-breeding-and-non-breeding" class="section level3">
<h3><code>simMove</code> Simulation of movement between breeding and non-breeding</h3>
<p>Recycle data generated within the calcMC function - see above</p>
<pre class="sourceCode r"><code class="sourceCode r">sims &lt;-<span class="st"> </span><span class="kw">simMove</span>(<span class="dt">breedingAbund =</span> breedingN, <span class="co"># Breeding relative abundance</span>
               <span class="dt">breedingDist =</span> breedDist,  <span class="co"># Breeding distance</span>
               <span class="dt">winteringDist =</span> nonbreedDist, <span class="co"># Non-breeding distance</span>
               <span class="dt">psi =</span> psi, <span class="co"># Transition probabilities</span>
               <span class="dt">nYears =</span> nYears, <span class="co"># Number of years</span>
               <span class="dt">nMonths =</span> nMonths, <span class="co"># Number of months</span>
               <span class="dt">winMoveRate =</span> <span class="dv">0</span>, <span class="co"># winter movement rate</span>
               <span class="dt">sumMoveRate =</span> <span class="dv">0</span>, <span class="co"># breeding movement rate</span>
               <span class="dt">winDispRate =</span> <span class="dv">0</span>, <span class="co"># winter dispersal rate</span>
               <span class="dt">sumDispRate =</span> <span class="dv">0</span>, <span class="co"># summer disperal rate</span>
               <span class="dt">natalDispRate =</span> <span class="dv">0</span>, <span class="co"># natal dispersal rate</span>
               <span class="dt">breedDispRate =</span> <span class="dv">0</span>, <span class="co"># breeding dispersal rate</span>
               <span class="dt">verbose =</span> <span class="dv">0</span>) <span class="co"># verbose output</span>


<span class="kw">str</span>(sims)
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ animalLoc   : int [1:50000, 1:2, 1:10, 1:4] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ natalDispMat: NULL</span>
<span class="co">#&gt;  $ breedDispMat: NULL</span>
<span class="co">#&gt;  $ sumMoveMat  : NULL</span>
<span class="co">#&gt;  $ winDispMat  : NULL</span>
<span class="co">#&gt;  $ winMoveMat  : NULL</span></code></pre>
</div>
</div>
<div id="additional-examples-scenarios" class="section level2">
<h2>Additional Examples / Scenarios</h2>
<div id="calculate-migratory-connectivity-for-a-range-of-input-values" class="section level3">
<h3>Calculate migratory connectivity for a range of input values</h3>
<p>Cohen et al. (<em>in revision</em>) used simulation to assess the influence of the three data inputs needed to calculate MC, including:</p>
<ol style="list-style-type: decimal">
<li>matrix of transition probabilities from breeding regions to non-breeding regions<br /></li>
<li>matrices of distances between breeding regions and between non-breeding regions<br /></li>
<li>relative abundance among breeding regions.</li>
</ol>
<p>Input value simulations included transition probabilities from four breeding to four non-breeding regions and relative abundance measured among breeding regions.</p>
<p>Below are eight transition probability scenarios. #Eight transition probability scenarios</p>
<div id="twelve-spatial-arrangements-that-result-in-different-distances-between-regions" class="section level4">
<h4>Twelve spatial arrangements that result in different distances between regions</h4>
</div>
<div id="distance-scenarios" class="section level4">
<h4>Distance scenarios</h4>
<ol style="list-style-type: upper-alpha">
<li>Base distances, linear/ linear 1<br /></li>
<li>Distance between breeding sites 2 and 3 doubled<br /></li>
<li>Distance between breeding sites 2 and 3 halved<br /></li>
<li>Distance between breeding sites 3 and 4 doubled<br /></li>
<li>Distance between breeding sites 3 and 4 halved<br /></li>
<li>Breeding sites on square grid/ winter linear 6<br /></li>
<li>Distance between wintering sites 2 and 3 doubled<br /></li>
<li>Distance between wintering sites 2 and 3 halved<br /></li>
<li>Distance between wintering sites 3 and 4 doubled<br /></li>
<li>Distance between wintering sites 3 and 4 halved<br /></li>
<li>Breeding linear, Wintering sites on square grid<br /></li>
<li>Wintering and breeding on square grid 12</li>
</ol>
</div>
<div id="five-relative-breeding-abundance-scenarios" class="section level4">
<h4>Five relative breeding abundance scenarios</h4>
</div>
<div id="changes-to-relative-breeding-abundance" class="section level4">
<h4>Changes to relative breeding abundance:</h4>
<ol style="list-style-type: decimal">
<li>Base<br /></li>
<li>Abundance at site B doubled<br /></li>
<li>Abundance at site B halved<br /></li>
<li>Abundance at site D doubled<br /></li>
<li>Abundance at site D halved</li>
</ol>
<p>For all eight transition probability matrices and three distance scenarios</p>
<pre class="sourceCode r"><code class="sourceCode r">nScenarios1 &lt;-<span class="st"> </span><span class="kw">length</span>(samplePsis) <span class="co"># samplePsis - comes with MigConnectivity pacakge</span>

<span class="co"># Create vector of length nScenarios1</span>
MC1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, nScenarios1)

<span class="co"># Loop through the different senarios outlined above #</span>
for (i in <span class="dv">1</span>:nScenarios1) {
  MC1[i] &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> sampleOriginDist[[<span class="dv">1</span>]],
                 <span class="dt">targetDist =</span> sampleTargetDist[[<span class="dv">1</span>]],
                 <span class="dt">psi =</span> samplePsis[[i]],
                 <span class="dt">originRelAbund =</span> sampleOriginRelN[[<span class="dv">1</span>]])
}

<span class="co"># Give meaningful names to the MC1 vector</span>
<span class="kw">names</span>(MC1) &lt;-<span class="st"> </span><span class="kw">names</span>(samplePsis)

<span class="co"># Print results </span>
<span class="kw">round</span>(MC1, <span class="dv">6</span>)
<span class="co">#&gt;            Full Mix      Avoid One Site   Full Connectivity </span>
<span class="co">#&gt;            0.000000            0.000000            1.000000 </span>
<span class="co">#&gt;            Half Mix                 Low              Medium </span>
<span class="co">#&gt;            0.600000            0.196000            0.504000 </span>
<span class="co">#&gt; One Site Preference            Negative </span>
<span class="co">#&gt;            0.164145           -0.066560</span></code></pre>
<p>Add the scenarios for the spatial arrangements that result in different distances between regions</p>
<pre class="sourceCode r"><code class="sourceCode r">nScenarios2 &lt;-<span class="st"> </span><span class="kw">length</span>(sampleOriginPos)

MC2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, nScenarios1, nScenarios2)

<span class="kw">rownames</span>(MC2) &lt;-<span class="st"> </span><span class="kw">names</span>(samplePsis)

<span class="kw">colnames</span>(MC2) &lt;-<span class="st"> </span><span class="kw">names</span>(sampleOriginPos)

for (i in <span class="dv">1</span>:nScenarios1) {
  for (j in <span class="dv">1</span>:nScenarios2) {
    MC2[i, j] &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> sampleOriginDist[[j]],
                      <span class="dt">targetDist =</span> sampleTargetDist[[j]],
                      <span class="dt">psi =</span> samplePsis[[i]],
                      <span class="dt">originRelAbund =</span> sampleOriginRelN[[<span class="dv">1</span>]])
  }
}

<span class="co"># Print results #</span>
<span class="kw">t</span>(<span class="kw">round</span>(MC2, <span class="dv">4</span>))
<span class="co">#&gt;              Full Mix Avoid One Site Full Connectivity Half Mix    Low</span>
<span class="co">#&gt; Linear              0              0            1.0000   0.6000 0.1960</span>
<span class="co">#&gt; B Dist BC*2         0              0            0.9739   0.6956 0.1818</span>
<span class="co">#&gt; B Dist BC/2         0              0            0.9798   0.4899 0.2000</span>
<span class="co">#&gt; B Dist CD*2         0              0            0.9558   0.5147 0.1912</span>
<span class="co">#&gt; B Dist CD/2         0              0            0.9734   0.6299 0.1878</span>
<span class="co">#&gt; B Grid              0              0            0.7734   0.5256 0.1277</span>
<span class="co">#&gt; NB Dist 23*2        0              0            0.9739   0.6956 0.1818</span>
<span class="co">#&gt; NB Dist 23/2        0              0            0.9798   0.4899 0.2000</span>
<span class="co">#&gt; NB Dist 34*2        0              0            0.9558   0.5147 0.1931</span>
<span class="co">#&gt; NB Dist 34/2        0              0            0.9734   0.6299 0.1863</span>
<span class="co">#&gt; NB Grid             0              0            0.7734   0.5256 0.1277</span>
<span class="co">#&gt; B/NB Grid           0              0            1.0000   0.4605 0.1638</span>
<span class="co">#&gt;              Medium One Site Preference Negative</span>
<span class="co">#&gt; Linear       0.5040              0.1641  -0.0666</span>
<span class="co">#&gt; B Dist BC*2  0.4879              0.1514  -0.0463</span>
<span class="co">#&gt; B Dist BC/2  0.4964              0.1683  -0.0815</span>
<span class="co">#&gt; B Dist CD*2  0.4784              0.1838  -0.0734</span>
<span class="co">#&gt; B Dist CD/2  0.4932              0.1388  -0.0572</span>
<span class="co">#&gt; B Grid       0.3601              0.1695   0.0669</span>
<span class="co">#&gt; NB Dist 23*2 0.4879              0.1428  -0.0463</span>
<span class="co">#&gt; NB Dist 23/2 0.4964              0.1781  -0.0815</span>
<span class="co">#&gt; NB Dist 34*2 0.4882              0.2163  -0.0734</span>
<span class="co">#&gt; NB Dist 34/2 0.4856              0.1149  -0.0572</span>
<span class="co">#&gt; NB Grid      0.3601              0.1263   0.0669</span>
<span class="co">#&gt; B/NB Grid    0.4340              0.1603   0.0728</span></code></pre>
<p>Another way of comparing results</p>
<pre class="sourceCode r"><code class="sourceCode r">
MC.diff2 &lt;-<span class="st"> </span><span class="kw">apply</span>(MC2, <span class="dv">2</span>, <span class="st">&quot;-&quot;</span>, MC2[ , <span class="dv">1</span>])

<span class="kw">t</span>(<span class="kw">round</span>(MC.diff2, <span class="dv">4</span>))
<span class="co">#&gt;              Full Mix Avoid One Site Full Connectivity Half Mix     Low</span>
<span class="co">#&gt; Linear              0              0            0.0000   0.0000  0.0000</span>
<span class="co">#&gt; B Dist BC*2         0              0           -0.0261   0.0956 -0.0142</span>
<span class="co">#&gt; B Dist BC/2         0              0           -0.0202  -0.1101  0.0040</span>
<span class="co">#&gt; B Dist CD*2         0              0           -0.0442  -0.0853 -0.0048</span>
<span class="co">#&gt; B Dist CD/2         0              0           -0.0266   0.0299 -0.0082</span>
<span class="co">#&gt; B Grid              0              0           -0.2266  -0.0744 -0.0683</span>
<span class="co">#&gt; NB Dist 23*2        0              0           -0.0261   0.0956 -0.0142</span>
<span class="co">#&gt; NB Dist 23/2        0              0           -0.0202  -0.1101  0.0040</span>
<span class="co">#&gt; NB Dist 34*2        0              0           -0.0442  -0.0853 -0.0029</span>
<span class="co">#&gt; NB Dist 34/2        0              0           -0.0266   0.0299 -0.0097</span>
<span class="co">#&gt; NB Grid             0              0           -0.2266  -0.0744 -0.0683</span>
<span class="co">#&gt; B/NB Grid           0              0            0.0000  -0.1395 -0.0322</span>
<span class="co">#&gt;               Medium One Site Preference Negative</span>
<span class="co">#&gt; Linear        0.0000              0.0000   0.0000</span>
<span class="co">#&gt; B Dist BC*2  -0.0161             -0.0128   0.0203</span>
<span class="co">#&gt; B Dist BC/2  -0.0076              0.0042  -0.0150</span>
<span class="co">#&gt; B Dist CD*2  -0.0256              0.0197  -0.0068</span>
<span class="co">#&gt; B Dist CD/2  -0.0108             -0.0253   0.0094</span>
<span class="co">#&gt; B Grid       -0.1439              0.0054   0.1334</span>
<span class="co">#&gt; NB Dist 23*2 -0.0161             -0.0213   0.0203</span>
<span class="co">#&gt; NB Dist 23/2 -0.0076              0.0139  -0.0150</span>
<span class="co">#&gt; NB Dist 34*2 -0.0158              0.0521  -0.0068</span>
<span class="co">#&gt; NB Dist 34/2 -0.0184             -0.0493   0.0094</span>
<span class="co">#&gt; NB Grid      -0.1439             -0.0378   0.1334</span>
<span class="co">#&gt; B/NB Grid    -0.0700             -0.0038   0.1394</span></code></pre>
</div>
</div>
<div id="add-the-relative-abundance-breeding-scenarios" class="section level3">
<h3>Add the relative abundance breeding scenarios</h3>
<div id="calculate-mc-for-breeding-linear-winter-linear-arrangment" class="section level4">
<h4>Calculate MC for breeding linear / winter linear arrangment</h4>
<pre class="sourceCode r"><code class="sourceCode r">nScenarios3 &lt;-<span class="st"> </span><span class="kw">length</span>(sampleOriginRelN)

MC3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, nScenarios1, nScenarios3)

<span class="kw">rownames</span>(MC3) &lt;-<span class="st"> </span><span class="kw">names</span>(samplePsis)
<span class="kw">colnames</span>(MC3) &lt;-<span class="st"> </span><span class="kw">names</span>(sampleOriginRelN)

for (i in <span class="dv">1</span>:nScenarios1) {
for (j in <span class="dv">1</span>) {
for (k in <span class="dv">1</span>:nScenarios3) {
MC3[i, k] &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> sampleOriginDist[[j]],
                    <span class="dt">targetDist =</span> sampleTargetDist[[j]], 
                    <span class="dt">psi =</span> samplePsis[[i]],
                    <span class="dt">originRelAbund =</span> sampleOriginRelN[[k]])
}
}
}

<span class="kw">t</span>(<span class="kw">round</span>(MC3, <span class="dv">4</span>)) <span class="co"># linear arrangement</span>
<span class="co">#&gt;        Full Mix Avoid One Site Full Connectivity Half Mix    Low Medium</span>
<span class="co">#&gt; Base          0              0                 1   0.6000 0.1960 0.5040</span>
<span class="co">#&gt; B Doub        0              0                 1   0.5856 0.2060 0.5173</span>
<span class="co">#&gt; B Half        0              0                 1   0.6323 0.1942 0.5027</span>
<span class="co">#&gt; D Doub        0              0                 1   0.6360 0.1663 0.4608</span>
<span class="co">#&gt; D Half        0              0                 1   0.5807 0.2062 0.5235</span>
<span class="co">#&gt;        One Site Preference Negative</span>
<span class="co">#&gt; Base                0.1641  -0.0666</span>
<span class="co">#&gt; B Doub              0.1338  -0.0650</span>
<span class="co">#&gt; B Half              0.1847  -0.0660</span>
<span class="co">#&gt; D Doub              0.2992  -0.0219</span>
<span class="co">#&gt; D Half              0.0886  -0.0399</span></code></pre>
</div>
<div id="calculate-mc-for-breeding-grid-winter-grid-arrangement" class="section level4">
<h4>Calculate MC for breeding grid/ winter grid arrangement</h4>
<pre class="sourceCode r"><code class="sourceCode r">MC4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, nScenarios1, nScenarios3)

<span class="kw">rownames</span>(MC4) &lt;-<span class="st"> </span><span class="kw">names</span>(samplePsis)
<span class="kw">colnames</span>(MC4) &lt;-<span class="st"> </span><span class="kw">names</span>(sampleOriginRelN)

for (i in <span class="dv">1</span>:nScenarios1) {
for (j in nScenarios2) {
for (k in <span class="dv">1</span>:nScenarios3) {
MC4[i, k] &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> sampleOriginDist[[j]],
                    <span class="dt">targetDist =</span> sampleTargetDist[[j]],
                    <span class="dt">psi =</span> samplePsis[[i]],
                    <span class="dt">originRelAbund =</span> sampleOriginRelN[[k]])
}
}
}

<span class="kw">t</span>(<span class="kw">round</span>(MC4, <span class="dv">4</span>)) <span class="co"># grid arrangement</span>
<span class="co">#&gt;        Full Mix Avoid One Site Full Connectivity Half Mix    Low Medium</span>
<span class="co">#&gt; Base          0              0                 1   0.4605 0.1638 0.4340</span>
<span class="co">#&gt; B Doub        0              0                 1   0.4668 0.1614 0.4293</span>
<span class="co">#&gt; B Half        0              0                 1   0.4639 0.1699 0.4445</span>
<span class="co">#&gt; D Doub        0              0                 1   0.4668 0.1614 0.4293</span>
<span class="co">#&gt; D Half        0              0                 1   0.4639 0.1699 0.4445</span>
<span class="co">#&gt;        One Site Preference Negative</span>
<span class="co">#&gt; Base                0.1603   0.0728</span>
<span class="co">#&gt; B Doub              0.0970   0.0822</span>
<span class="co">#&gt; B Half              0.1996   0.0778</span>
<span class="co">#&gt; D Doub              0.3649   0.0822</span>
<span class="co">#&gt; D Half              0.0519   0.0778</span></code></pre>
</div>
<div id="calculate-mc-for-breeding-grid-winter-linear-arrangement" class="section level4">
<h4>Calculate MC for breeding grid, winter linear arrangement</h4>
<pre class="sourceCode r"><code class="sourceCode r">MC5 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, nScenarios1, nScenarios3)

<span class="kw">rownames</span>(MC5) &lt;-<span class="st"> </span><span class="kw">names</span>(samplePsis)
<span class="kw">colnames</span>(MC5) &lt;-<span class="st"> </span><span class="kw">names</span>(sampleOriginRelN)

for (i in <span class="dv">1</span>:nScenarios1) {
for (j in <span class="dv">6</span>) {
for (k in <span class="dv">1</span>:nScenarios3) {
MC5[i, k] &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> sampleOriginDist[[j]],
                    <span class="dt">targetDist =</span> sampleTargetDist[[j]], 
                    <span class="dt">psi =</span> samplePsis[[i]], 
                    <span class="dt">originRelAbund =</span> sampleOriginRelN[[k]])
}
}
}

<span class="kw">t</span>(<span class="kw">round</span>(MC5, <span class="dv">4</span>)) <span class="co"># breeding grid, winter linear arrangement</span>
<span class="co">#&gt;        Full Mix Avoid One Site Full Connectivity Half Mix    Low Medium</span>
<span class="co">#&gt; Base          0              0            0.7734   0.5256 0.1277 0.3601</span>
<span class="co">#&gt; B Doub        0              0            0.7538   0.5384 0.1380 0.3677</span>
<span class="co">#&gt; B Half        0              0            0.8229   0.5323 0.1385 0.3861</span>
<span class="co">#&gt; D Doub        0              0            0.8290   0.5384 0.1096 0.3456</span>
<span class="co">#&gt; D Half        0              0            0.7447   0.5323 0.1313 0.3629</span>
<span class="co">#&gt;        One Site Preference Negative</span>
<span class="co">#&gt; Base                0.1695   0.0669</span>
<span class="co">#&gt; B Doub              0.1140   0.0277</span>
<span class="co">#&gt; B Half              0.2102   0.0801</span>
<span class="co">#&gt; D Doub              0.3419   0.1334</span>
<span class="co">#&gt; D Half              0.0737   0.0647</span></code></pre>
</div>
</div>
<div id="examples-4-9-from-sampling-regime-simulations-in-cohen-et-al.-in-revision" class="section level3">
<h3>EXAMPLES 4-9 (from sampling regime simulations in Cohen et al. in revision)</h3>
<p>Simulation was used to assess the influence of biased or incomplete sampling on the measurement of MC. Below, we measure the influence of several potential sources of sampling error:</p>
<ol style="list-style-type: decimal">
<li>incorrect grouping of seasonal ranges into regions<br /></li>
<li>sampling not proportional to abundance<br /></li>
<li>migratory connectivity strength varies across a range<br /></li>
<li>uncertainty in estimates of abundance<br /></li>
<li>heterogeneity in detection among regions from mark re-encounter data<br /></li>
<li>uncertainty in assignments to regions from tracking data</li>
</ol>
<p>We also demonstrate how to propagate sampling uncertainty into measurement of MC using a combination of parametric and nonparametric bootstrapping. For most simulations, we compare MC to the results of a distance-based correlation coefficient that does not incorporate relative abundance but has been used as a measure of migratory connectivity.</p>
</div>
<div id="example-4" class="section level3">
<h3>EXAMPLE 4</h3>
<p>Sampling regime 1 of 3</p>
<p>Researchers divide populations differently than reality Delineation of seasonal ranges into regions</p>
<ol style="list-style-type: upper-roman">
<li>Breeding range divided along equal longitudinal breaks into ten regions<br /></li>
<li>Non-breeding range divided along equal longitudinal breaks into ten regions<br /></li>
<li>Breeding and non-breeding ranges divided along equal longitudinal breaks into ten regions<br /></li>
<li>Breeding range divided along the longitudinal and latitudinal midpoint into four regions<br /></li>
<li>Non-breeding range divided along the longitudinal and latitudinal midpoint into four regions<br /></li>
<li>Breeding range divided along the longitudinal and latitudinal midpoint into four regions and<br /> non-breeding range divided along equal longitudinal breaks into ten regions<br /></li>
<li>Breeding range divided along equal longitudinal breaks into ten regions and<br /> non-breeding range divided along the longitudinal and latitudinal midpoint into four regions</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Run functions and parameters above first</span>
<span class="kw">set.seed</span>(<span class="dv">75</span>)

scenarios14 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Base&quot;</span>, 
                 <span class="st">&quot;Breeding10&quot;</span>,
                 <span class="st">&quot;Wintering10&quot;</span>,
                 <span class="st">&quot;Breeding10Wintering10&quot;</span>,
                 <span class="st">&quot;Breeding4&quot;</span>,
                 <span class="st">&quot;Wintering4&quot;</span>,
                 <span class="st">&quot;Breeding4Wintering10&quot;</span>,
                 <span class="st">&quot;Breeding10Wintering4&quot;</span>,
                 <span class="st">&quot;Breeding4Wintering4&quot;</span>,
                 <span class="st">&quot;CentroidSampleBreeding10&quot;</span>,
                 <span class="st">&quot;CentroidSampleBreeding10Wintering10&quot;</span>,
                 <span class="st">&quot;CentroidSampleBreeding10Wintering4&quot;</span>,
                 <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,
                 <span class="st">&quot;CentroidSampleBreeding4Wintering10&quot;</span>,
                 <span class="st">&quot;CentroidSampleBreeding4Wintering4&quot;</span>)

<span class="co"># Each element is for a scenario (see above 1-8), transferring from natural </span>
<span class="co"># breeding populations to defined ones</span>
breedingSiteTrans14 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>:nBreeding, 
                           <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>), 
                           <span class="dv">1</span>:nBreeding, 
                           <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>), 
                           <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                           <span class="dv">1</span>:nBreeding, 
                           <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                           <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>),
                           <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                           <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>), 
                           <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>), 
                           <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>),
                           <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                           <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                           <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))

<span class="co"># Same for non-breeding populations</span>
winteringSiteTrans14 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>:nWintering,
                             <span class="dv">1</span>:nWintering,
                             <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>),
                             <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>),
                             <span class="dv">1</span>:nWintering,
                             <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                             <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>),
                             <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                             <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                             <span class="dv">1</span>:nWintering,
                             <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>),
                             <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                             <span class="dv">1</span>:nWintering,
                             <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>),
                             <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))

<span class="co"># Examine the transfers in matrix form</span>
<span class="kw">lapply</span>(breedingSiteTrans14, matrix, <span class="dt">nrow=</span><span class="dv">10</span>, <span class="dt">ncol=</span><span class="dv">10</span>)
<span class="kw">lapply</span>(winteringSiteTrans14, matrix, <span class="dt">nrow=</span><span class="dv">10</span>, <span class="dt">ncol=</span><span class="dv">10</span>)

<span class="co">#positions of the human defined populations</span>
breedingPos14 &lt;-<span class="st"> </span><span class="kw">list</span>(breedingPos,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                      breedingPos,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                            <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                      breedingPos, 
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                            <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                            <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                            <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                            <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                      <span class="kw">rowsum</span>(breedingPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                            <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>)

winteringPos14 &lt;-<span class="st"> </span><span class="kw">list</span>(winteringPos,
                       winteringPos,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                       winteringPos, 
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                              <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                       <span class="kw">rowsum</span>(winteringPos,<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                              <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                              <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                       winteringPos,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                              <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>,
                       winteringPos,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">each=</span><span class="dv">10</span>))/<span class="dv">10</span>,
                       <span class="kw">rowsum</span>(winteringPos, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>),
                                              <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))/<span class="dv">25</span>)


<span class="co"># Calculate distances between defined breeding populations</span>
breedDist14 &lt;-<span class="st"> </span><span class="kw">lapply</span>(breedingPos14, distFromPos, <span class="dt">surface =</span> <span class="st">'ellipsoid'</span>)

<span class="co"># Calculate distances between defined non-breeding populations</span>
nonbreedDist14 &lt;-<span class="st"> </span><span class="kw">lapply</span>(winteringPos14, distFromPos, <span class="dt">surface =</span> <span class="st">'ellipsoid'</span>)

<span class="co"># Numbers of defined populations</span>
nBreeding14 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>)

nWintering14 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">4</span>)

<span class="co"># Relative abundance by scenario and breeding population</span>
breedingRelN14 &lt;-<span class="st"> </span><span class="kw">lapply</span>(nBreeding14, function(x) <span class="kw">rep</span>(<span class="dv">1</span>/x, x))


nSample14 &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Total number sampled per simulation</span>

<span class="co"># How many sampled from each natural population (sampling scenarios separate </span>
<span class="co"># from definition scenarios)</span>
sampleBreeding14 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">round</span>(breedingRelN14[[<span class="dv">1</span>]]*nSample14),
                         <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="kw">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">1</span>]*nSample14),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="kw">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">2</span>]*nSample14),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="kw">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">3</span>]*nSample14),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="kw">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">4</span>]*nSample14),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>)),
                         <span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), 
                             <span class="kw">rep</span>(<span class="kw">round</span>(breedingRelN14[[<span class="dv">2</span>]][<span class="dv">1</span>]*nSample14/<span class="dv">2</span>), <span class="dv">2</span>),
                             <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="dv">10</span>))

<span class="kw">lapply</span>(sampleBreeding14, matrix, <span class="dt">nrow=</span><span class="dv">10</span>, <span class="dt">ncol=</span><span class="dv">10</span>)

<span class="co"># for the baseline use the simulation from above, sims</span>
animalLoc14base &lt;-<span class="st"> </span>sims$animalLoc

<span class="co">#transferring the simulated bird locations from the true populations to the researcher defined populations</span>
changeLocations &lt;-<span class="st"> </span>function(animalLoc, breedingSiteTrans, winteringSiteTrans) {
  animalLoc[,<span class="dv">1</span>,,] &lt;-<span class="st"> </span>breedingSiteTrans[animalLoc[,<span class="dv">1</span>,,]]
  animalLoc[,<span class="dv">2</span>,,] &lt;-<span class="st"> </span>winteringSiteTrans[animalLoc[,<span class="dv">2</span>,,]]
  <span class="kw">return</span>(animalLoc)
}

<span class="co"># Number of scenarios and number of simulations to run</span>
nScenarios14 &lt;-<span class="st"> </span><span class="kw">length</span>(breedingSiteTrans14)
nSims14 &lt;-<span class="st"> </span><span class="dv">100</span>

<span class="co"># Connections between scenarios and sampling regimes</span>
scenarioToSampleMap14 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>), <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">3</span>))

<span class="co"># Set up data structures for storing results</span>
animalLoc14 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14) <span class="co">#making an empty list to fill</span>

compare14 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Scenario =</span> <span class="kw">c</span>(<span class="st">&quot;True&quot;</span>, scenarios14),
                        <span class="dt">MC =</span> <span class="kw">c</span>(MC, <span class="kw">rep</span>(<span class="ot">NA</span>, nScenarios14)), 
                        <span class="dt">Mantel =</span> <span class="kw">c</span>(MC, <span class="kw">rep</span>(<span class="ot">NA</span>, nScenarios14)))

compare14.array &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(nSims14, nScenarios14, <span class="dv">2</span>), <span class="dt">dimnames =</span> 
                           <span class="kw">list</span>(<span class="dv">1</span>:nSims14,
                           scenarios14,
                           <span class="kw">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))

results14 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14)

<span class="co"># Run simulations</span>
for (sim in <span class="dv">1</span>:nSims14) {
  <span class="kw">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims14, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
  sim14 &lt;-<span class="st"> </span><span class="kw">lapply</span>(sampleBreeding14, simMove, <span class="dt">breedingDist =</span> breedDist14[[<span class="dv">1</span>]],
                  <span class="dt">winteringDist=</span>nonbreedDist14[[<span class="dv">1</span>]], <span class="dt">psi=</span>psi, <span class="dt">nYears=</span>nYears,
                  <span class="dt">nMonths=</span>nMonths)
  for (i in <span class="dv">1</span>:nScenarios14) {
    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Scenario&quot;</span>, i, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
    animalLoc14[[i]] &lt;-<span class="st"> </span><span class="kw">changeLocations</span>(sim14[[scenarioToSampleMap14[i]]]$animalLoc,
                                      breedingSiteTrans14[[i]], winteringSiteTrans14[[i]])
    results14[[i]] &lt;-<span class="st"> </span><span class="kw">calcPsiMC</span>(breedDist14[[i]], nonbreedDist14[[i]],
                                   breedingRelN14[[i]], animalLoc14[[i]], F)
    compare14.array[sim, i, <span class="st">'MC'</span>] &lt;-<span class="st"> </span>results14[[i]]$MC
    compare14.array[sim, i, <span class="st">'Mantel'</span>] &lt;-<span class="st"> </span><span class="kw">calcStrengthInd</span>(breedDist14[[<span class="dv">1</span>]],
                                                         nonbreedDist14[[<span class="dv">1</span>]],
                                                         sim14[[scenarioToSampleMap14[i]]]$animalLoc,
  <span class="er">}</span>
<span class="er">}</span>

<span class="co"># Compute means for each scenario</span>
compare14$MC[<span class="dv">1</span>:nScenarios14 +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(compare14.array[,,<span class="st">'MC'</span>], <span class="dv">2</span>, mean)
compare14$Mantel[<span class="dv">1</span>:nScenarios14 +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(compare14.array[,,<span class="st">'Mantel'</span>], <span class="dv">2</span>, mean)

compare14 &lt;-<span class="st"> </span><span class="kw">transform</span>(compare14, <span class="dt">MC.diff=</span>MC -<span class="st"> </span>MC[<span class="dv">1</span>], <span class="dt">Mantel.diff=</span>Mantel -<span class="st"> </span>Mantel[<span class="dv">1</span>])
compare14</code></pre>
<div id="example-5" class="section level4">
<h4>EXAMPLE 5</h4>
<p>Sampling regime 2 of 3</p>
<p>Researchers divide populations differently than reality PLUS<br />Different distributions of sampling animals across breeding range PLUS<br />Sample sizes don’t always match relative abundances PLUS<br />Compare our approach and simple Mantel approach</p>
<ol style="list-style-type: decimal">
<li><p>Base (10 years, uneven abundances but matches sampling)</p></li>
<li><p>Breeding pops divided into 4 squares, sample across breeding range</p></li>
<li><p>Breeding pops divided into 4 squares, sample at centroid of each square</p></li>
<li><p>Sampling high in low abundance populations plus base</p></li>
<li><p>Scenarios 2 plus 4</p></li>
<li><p>Scenarios 3 plus 4</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">75</span>)

<span class="co"># Transfer between true populations and researcher defined ones (only for</span>
<span class="co"># breeding, as not messing with winter populations here)</span>

breedingSiteTrans15 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">100</span>,
                            <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                            <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)), 
                            <span class="dv">1</span>:<span class="dv">100</span>,
                            <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                            <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))

nScenarios15 &lt;-<span class="st"> </span><span class="kw">length</span>(breedingSiteTrans15)

nSims15 &lt;-<span class="st"> </span><span class="dv">100</span>

<span class="co"># Basing positions of researcher defined breeding populations on above</span>
breedingPos15 &lt;-<span class="st"> </span><span class="kw">list</span>(breedingPos, 
                      breedingPos14[[<span class="dv">5</span>]],
                      breedingPos14[[<span class="dv">5</span>]], 
                      breedingPos,
                      breedingPos14[[<span class="dv">5</span>]], 
                      breedingPos14[[<span class="dv">5</span>]])

winteringPos15 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">list</span>(winteringPos), nScenarios15)

breedDist15 &lt;-<span class="st"> </span><span class="kw">lapply</span>(breedingPos15, distFromPos)

nonbreedDist15 &lt;-<span class="st"> </span><span class="kw">lapply</span>(winteringPos15, distFromPos)

nBreeding15 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">4</span>), <span class="dv">2</span>)

nWintering15 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">100</span>, nScenarios15)

<span class="co"># Highest abundance in lower right corner, lowest in top left</span>
<span class="co"># Making symmetrical</span>

breedingN15base &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">100</span>)
for (i in <span class="dv">1</span>:<span class="dv">10</span>) <span class="co">#row</span>
  for (j in <span class="dv">1</span>:<span class="dv">10</span>)  <span class="co">#column</span>
    breedingN15base[i<span class="dv">+10</span>*(j<span class="dv">-1</span>)] &lt;-<span class="st"> </span><span class="dv">500</span> +<span class="st"> </span><span class="dv">850</span>*i*j

<span class="kw">sum</span>(breedingN15base)

<span class="co"># For researcher defined populations</span>
breedingN15 &lt;-<span class="st"> </span><span class="kw">lapply</span>(breedingSiteTrans15, rowsum, <span class="dt">x=</span>breedingN15base) 

breedingRelN15 &lt;-<span class="st"> </span><span class="kw">lapply</span>(breedingN15, <span class="st">&quot;/&quot;</span>, <span class="kw">sum</span>(breedingN15base))

nSample15 &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Total number sampled per simulation</span>

<span class="co"># Number sampled per natural population</span>
sampleBreeding15 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">round</span>(breedingRelN15[[<span class="dv">1</span>]]*nSample15),
                         <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">1</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">2</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">3</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">4</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>)),
                         <span class="kw">round</span>(breedingRelN15[[<span class="dv">1</span>]]*nSample15)[<span class="dv">100</span>:<span class="dv">1</span>],
                         <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">1</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">2</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">3</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="kw">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">4</span>]*nSample15),
                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>))[<span class="dv">100</span>:<span class="dv">1</span>])

<span class="co"># Set up psi matrix</span>
o15 &lt;-<span class="st"> </span><span class="kw">optimize</span>(mlogitMC, <span class="dt">MC.in =</span> <span class="fl">0.25</span>, <span class="dt">origin.dist =</span> breedDist15[[<span class="dv">1</span>]],
                <span class="dt">target.dist =</span> nonbreedDist15[[<span class="dv">1</span>]],
                <span class="dt">origin.rel.abund =</span> breedingRelN15[[<span class="dv">1</span>]], <span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),
                <span class="dt">tol =</span> .Machine$double.eps^<span class="fl">0.5</span>)

slope15 &lt;-<span class="st"> </span>o15$minimum

psi15 &lt;-<span class="st"> </span><span class="kw">mlogitMat</span>(slope15, breedDist15[[<span class="dv">1</span>]])

<span class="co"># Baseline strength of migratory connectivity</span>
MC15 &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> breedDist15[[<span class="dv">1</span>]], 
               <span class="dt">targetDist =</span> nonbreedDist15[[<span class="dv">1</span>]],
               <span class="dt">psi =</span> psi15,
               <span class="dt">originRelAbund =</span> breedingRelN15[[<span class="dv">1</span>]])

<span class="co"># Run sampling regimes</span>
scenarioToSampleMap15 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)

animalLoc15 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios15)

results15 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios15)

compare15 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Scenario =</span> <span class="kw">c</span>(<span class="st">&quot;True&quot;</span>, 
                                     <span class="st">&quot;Base&quot;</span>, 
                                     <span class="st">&quot;Breeding4&quot;</span>,
                                     <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,
                                     <span class="st">&quot;BiasedSample&quot;</span>, 
                                     <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,
                                     <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),
                        <span class="dt">MC =</span> <span class="kw">c</span>(MC15, <span class="kw">rep</span>(<span class="ot">NA</span>, nScenarios15)), <span class="dt">Mantel =</span> <span class="kw">c</span>(MC15, <span class="kw">rep</span>(<span class="ot">NA</span>, nScenarios15)))

compare15.array &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(nSims15, nScenarios15, <span class="dv">2</span>), <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="dv">1</span>:nSims15,
                                         <span class="kw">c</span>(<span class="st">&quot;Base&quot;</span>, <span class="st">&quot;Breeding4&quot;</span>, <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,
                                           <span class="st">&quot;BiasedSample&quot;</span>, <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,
                                           <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),
                                         <span class="kw">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))


for (sim in <span class="dv">1</span>:nSims15) {
  <span class="kw">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims15, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
  sim15 &lt;-<span class="st"> </span><span class="kw">lapply</span>(sampleBreeding15, simMove, <span class="dt">breedingDist =</span> breedDist15[[<span class="dv">1</span>]],
                  <span class="dt">winteringDist=</span>nonbreedDist15[[<span class="dv">1</span>]], <span class="dt">psi=</span>psi15, <span class="dt">nYears=</span>nYears,
                  <span class="dt">nMonths=</span>nMonths)
  for (i in <span class="dv">1</span>:nScenarios15) {
    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Scenario&quot;</span>, i, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
    animalLoc15[[i]] &lt;-<span class="st"> </span><span class="kw">changeLocations</span>(sim15[[scenarioToSampleMap15[i]]]$animalLoc,
                                      breedingSiteTrans15[[i]], <span class="dv">1</span>:nWintering15[i])
    results15[[i]] &lt;-<span class="st"> </span><span class="kw">calcPsiMC</span>(breedDist15[[i]], nonbreedDist15[[i]],
                                   breedingRelN15[[i]], animalLoc15[[i]], F)
    compare15.array[sim, i, <span class="st">'MC'</span>] &lt;-<span class="st"> </span>results15[[i]]$MC
    compare15.array[sim, i, <span class="st">'Mantel'</span>] &lt;-<span class="st"> </span><span class="kw">calcStrengthInd</span>(breedDist15[[<span class="dv">1</span>]],
                                                         nonbreedDist15[[<span class="dv">1</span>]],
                                                         sim15[[scenarioToSampleMap15[i]]]$animalLoc,
                                                         <span class="dt">resamp=</span><span class="dv">0</span>)$correlation
  }
}

compare15$MC[<span class="dv">1</span>:nScenarios15 +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(compare15.array[,,<span class="st">'MC'</span>], <span class="dv">2</span>, mean)
compare15$Mantel[<span class="dv">1</span>:nScenarios15 +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(compare15.array[,,<span class="st">'Mantel'</span>], <span class="dv">2</span>,mean)

compare15 &lt;-<span class="st"> </span><span class="kw">transform</span>(compare15, <span class="dt">MC.diff=</span>MC -<span class="st"> </span>MC[<span class="dv">1</span>],
                       <span class="dt">Mantel.diff=</span>Mantel -<span class="st"> </span>Mantel[<span class="dv">1</span>],
                       <span class="dt">MC.prop=</span>MC/MC[<span class="dv">1</span>], <span class="dt">Mantel.prop=</span>Mantel/Mantel[<span class="dv">1</span>])


compare15a &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(compare15[<span class="dv">2</span>:<span class="dv">7</span>,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>)])

<span class="kw">rownames</span>(compare15a) &lt;-<span class="st"> </span>compare15$Scenario[<span class="dv">2</span>:<span class="dv">7</span>]</code></pre>
</div>
<div id="example-6" class="section level4">
<h4>EXAMPLE 6</h4>
<p>Sampling regime 3 of 3 Researchers divide populations differently than reality (simulations) PLUS Different distributions of sampled animals across breeding range PLUS Sample sizes don’t always match relative abundances PLUS Compare our approach and simple Mantel approach PLUS MC not same across subsections of range</p>
<ol style="list-style-type: decimal">
<li><p>Base (uneven MC (0.15 for NW breeding, 0.3 for SW, 0.45 for NE, and 0.6<br />for SE), uneven abundances (lowest in NW, highest in SE), sampling<br /> proportional to abundance</p></li>
<li><p>Breeding pops divided into 4 squares, sample across breeding range</p></li>
<li><p>Breeding pops divided into 4 squares, sample at centroid of each square</p></li>
<li><p>Sampling high in low abundance populations</p></li>
<li><p>Scenarios 2 plus 4</p></li>
<li><p>Scenarios 3 plus 4</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">75</span>)

<span class="co"># Transfer between true populations and researcher defined ones</span>
<span class="co"># (only for breeding, as not messing with winter populations here)</span>
breedingSiteTrans16 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">100</span>, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                            <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)), <span class="dv">1</span>:<span class="dv">100</span>,
                            <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)),
                            <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>), <span class="kw">rep</span>(<span class="dv">3</span>:<span class="dv">4</span>, <span class="dv">5</span>, <span class="dt">each=</span><span class="dv">5</span>)))

<span class="kw">lapply</span>(breedingSiteTrans16, matrix, <span class="dt">nrow=</span><span class="dv">10</span>, <span class="dt">ncol=</span><span class="dv">10</span>)
nScenarios16 &lt;-<span class="st"> </span><span class="kw">length</span>(breedingSiteTrans16)
nSims16 &lt;-<span class="st"> </span><span class="dv">100</span>
<span class="co"># Basing positions of researcher defined breeding populations on above</span>
breedingPos16 &lt;-<span class="st"> </span>breedingPos15
winteringPos16 &lt;-<span class="st"> </span>winteringPos15

breedDist16 &lt;-<span class="st"> </span>breedDist15
nonbreedDist16 &lt;-<span class="st"> </span>nonbreedDist15
nBreeding16 &lt;-<span class="st"> </span>nBreeding15
nWintering16 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">100</span>, nScenarios16)

<span class="co"># Highest abundance in lower right corner, lowest in top left</span>
<span class="co"># In fact basing on distance from top left population</span>

breedingN16base &lt;-<span class="st"> </span>breedingN15base
breedingN16 &lt;-<span class="st"> </span>breedingN15
breedingRelN16 &lt;-<span class="st"> </span><span class="kw">lapply</span>(breedingN16, <span class="st">&quot;/&quot;</span>, <span class="kw">sum</span>(breedingN16base))

<span class="co"># Set up psi matrix</span>
<span class="co"># Each quadrant of breeding range has different MC</span>

MC.levels16 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.15</span>, <span class="fl">0.6</span>, <span class="fl">0.15</span>)

nLevels16 &lt;-<span class="st"> </span><span class="dv">4</span>

psi16 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, nBreeding16[<span class="dv">1</span>], nWintering16[<span class="dv">1</span>])

for (i in <span class="dv">1</span>:nLevels16) {
  <span class="kw">cat</span>(<span class="st">&quot;MC&quot;</span>, MC.levels16[i])
  <span class="co"># Find a psi matrix that produces the given MC (for whole species)</span>
  o16a &lt;-<span class="st"> </span><span class="kw">optimize</span>(mlogitMC, <span class="dt">MC.in =</span> MC.levels16[i],
                   <span class="dt">origin.dist =</span> breedDist16[[<span class="dv">1</span>]],
                   <span class="dt">target.dist =</span> nonbreedDist16[[<span class="dv">1</span>]],
                   <span class="dt">origin.rel.abund =</span> breedingRelN16[[<span class="dv">1</span>]],
                   <span class="dt">interval=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">tol=</span>.Machine$double.eps^<span class="fl">0.5</span>)
  
  slope16a &lt;-<span class="st"> </span>o16a$minimum
  
  <span class="kw">cat</span>(<span class="st">&quot; slope&quot;</span>, slope16a, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  
  psi16a &lt;-<span class="st"> </span><span class="kw">mlogitMat</span>(slope16a, breedDist16[[<span class="dv">1</span>]])
  
  <span class="co"># Then use the rows of that psi matrix only for the one breeding quadrant</span>
  rows &lt;-<span class="st"> </span><span class="dv">50</span>*(i %/%<span class="st"> </span><span class="dv">3</span>) +<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">5</span>) +<span class="st"> </span><span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="dv">10</span>), <span class="dt">each=</span><span class="dv">5</span>) +<span class="st"> </span>((i<span class="dv">-1</span>) %%<span class="st"> </span><span class="dv">2</span>) *<span class="st"> </span><span class="dv">5</span>
  psi16[rows, ] &lt;-<span class="st"> </span>psi16a[rows, ]
}


<span class="co"># Baseline strength of migratory connectivity</span>
MC16 &lt;-<span class="st"> </span><span class="kw">calcMC</span>(<span class="dt">originDist =</span> breedDist16[[<span class="dv">1</span>]],
               <span class="dt">targetDist =</span> nonbreedDist16[[<span class="dv">1</span>]], 
               <span class="dt">psi =</span> psi16,
               <span class="dt">originRelAbund =</span> breedingRelN16[[<span class="dv">1</span>]])


<span class="co"># Set up sampling regimes (different number than number of scenarios)</span>
nSample16 &lt;-<span class="st"> </span><span class="dv">1000</span>
sampleBreeding16 &lt;-<span class="st"> </span>sampleBreeding15


<span class="co"># Run sampling regimes</span>
scenarioToSampleMap16 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)
animalLoc16 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios16)
results16 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios16)
compare16 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Scenario =</span> <span class="kw">c</span>(<span class="st">&quot;True&quot;</span>,
                                     <span class="st">&quot;Base&quot;</span>,
                                     <span class="st">&quot;Breeding4&quot;</span>,
                                     <span class="st">&quot;CentroidSampleBreeding4&quot;</span>, 
                                     <span class="st">&quot;BiasedSample&quot;</span>,
                                     <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,
                                     <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),
                        <span class="dt">MC =</span> <span class="kw">c</span>(MC16, <span class="kw">rep</span>(<span class="ot">NA</span>, nScenarios16)),
                        <span class="dt">Mantel =</span> <span class="kw">c</span>(MC16, <span class="kw">rep</span>(<span class="ot">NA</span>, nScenarios16)))

compare16.array &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(nSims16, nScenarios16, <span class="dv">2</span>), 
                         <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="dv">1</span>:nSims16,
                                         <span class="kw">c</span>(<span class="st">&quot;Base&quot;</span>, <span class="st">&quot;Breeding4&quot;</span>,
                                           <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,
                                           <span class="st">&quot;BiasedSample&quot;</span>,
                                           <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,
                                           <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),
                                         <span class="kw">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))

for (sim in <span class="dv">1</span>:nSims15) {
  <span class="kw">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims15, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
  sim15 &lt;-<span class="st"> </span><span class="kw">lapply</span>(sampleBreeding15, simMove, <span class="dt">breedingDist =</span> breedDist15[[<span class="dv">1</span>]],
                  <span class="dt">winteringDist=</span>nonbreedDist15[[<span class="dv">1</span>]], <span class="dt">psi=</span>psi15, <span class="dt">nYears=</span>nYears,
                  <span class="dt">nMonths=</span>nMonths)
  
  for (i in <span class="dv">1</span>:nScenarios15) {
    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Scenario&quot;</span>, i, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
    animalLoc15[[i]] &lt;-<span class="st"> </span><span class="kw">changeLocations</span>(sim15[[scenarioToSampleMap15[i]]]$animalLoc,
                                        breedingSiteTrans15[[i]], <span class="dv">1</span>:nWintering15[i])
    results15[[i]] &lt;-<span class="st"> </span><span class="kw">calcPsiMC</span>(breedDist15[[i]], nonbreedDist15[[i]],
                                breedingRelN15[[i]], animalLoc15[[i]], F)
    compare15.array[sim, i, <span class="st">'MC'</span>] &lt;-<span class="st"> </span>results15[[i]]$MC
    compare15.array[sim, i, <span class="st">'Mantel'</span>] &lt;-<span class="st"> </span><span class="kw">calcStrengthInd</span>(breedDist15[[<span class="dv">1</span>]],
                                                         nonbreedDist15[[<span class="dv">1</span>]],
                                                         sim15[[scenarioToSampleMap15[i]]]$animalLoc,
                                                         <span class="dt">resamp=</span><span class="dv">0</span>)$correlation
  }
}

for (sim in <span class="dv">1</span>:nSims16) {
  <span class="kw">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims16, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
  sim16 &lt;-<span class="st"> </span><span class="kw">lapply</span>(sampleBreeding16, simMove, <span class="dt">breedingDist =</span> breedDist16[[<span class="dv">1</span>]],
                  <span class="dt">winteringDist=</span>nonbreedDist16[[<span class="dv">1</span>]], <span class="dt">psi=</span>psi16, <span class="dt">nYears=</span>nYears,
                  <span class="dt">nMonths=</span>nMonths)
  for (i in <span class="dv">1</span>:nScenarios16) {
    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Scenario&quot;</span>, i, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
    animalLoc16[[i]] &lt;-<span class="st"> </span><span class="kw">changeLocations</span>(sim16[[scenarioToSampleMap16[i]]]$animalLoc,
                                      breedingSiteTrans16[[i]], <span class="dv">1</span>:nWintering16[i])
    results16[[i]] &lt;-<span class="st"> </span><span class="kw">calcPsiMC</span>(breedDist16[[i]], nonbreedDist16[[i]],
                                breedingRelN16[[i]], animalLoc16[[i]], F)
    compare16.array[sim, i, <span class="st">'MC'</span>] &lt;-<span class="st"> </span>results16[[i]]$MC
    compare16.array[sim, i, <span class="st">'Mantel'</span>] &lt;-<span class="st"> </span><span class="kw">calcStrengthInd</span>(breedDist16[[<span class="dv">1</span>]],
                                                         nonbreedDist16[[<span class="dv">1</span>]],
                                                         sim16[[scenarioToSampleMap16[i]]]$animalLoc,
                                                         <span class="dt">resamp=</span><span class="dv">0</span>)$correlation
  }
}

compare16$MC[<span class="dv">1</span>:nScenarios16 +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(compare16.array[,,<span class="st">'MC'</span>], <span class="dv">2</span>, mean)
compare16$Mantel[<span class="dv">1</span>:nScenarios16 +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(compare16.array[,,<span class="st">'Mantel'</span>], <span class="dv">2</span>, mean)
compare16 &lt;-<span class="st"> </span><span class="kw">transform</span>(compare16, <span class="dt">MC.diff=</span>MC -<span class="st"> </span>MC[<span class="dv">1</span>], <span class="dt">Mantel.diff=</span>Mantel -<span class="st"> </span>Mantel[<span class="dv">1</span>],
                       <span class="dt">MC.prop=</span>MC/MC[<span class="dv">1</span>], <span class="dt">Mantel.prop=</span>Mantel/Mantel[<span class="dv">1</span>])

compare16a &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(compare16[<span class="dv">2</span>:<span class="dv">7</span>,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>)])
<span class="kw">rownames</span>(compare16a) &lt;-<span class="st"> </span>compare16$Scenario[<span class="dv">2</span>:<span class="dv">7</span>]</code></pre>
</div>
<div id="example-7" class="section level4">
<h4>EXAMPLE 7</h4>
<p><code>estMC</code> Estimate strength of migratory connectivity incorporating uncertainty in estimates of breeding abundance (see estMC help file)</p>
</div>
<div id="example-8" class="section level4">
<h4>EXAMPLE 8</h4>
<p><code>estMC</code> Estimate strength of migratory connectivity incorporating detection heterogeneity (see estMC help file)</p>
</div>
<div id="example-9" class="section level4">
<h4>EXAMPLE 9</h4>
<p><code>estMC</code> Estimate strength of migratory connectivity incorporating location uncertainty (<strong><em>Examples</em></strong> see above) Estimates of MC may also be influenced by error in individual assignment to regions. Data types vary in locational accuracy and precision, which are likely to influence the accuracy with which individuals are assigned to regions. We measured MC for bootstrapped data of birds tracked from breeding to non-breeding regions using light-level and GPS geolocation when 1) GPS location uncertainty was applied to all individuals, 2) GPS and light-level location uncertainty were applied to individuals with those devices, and 3) light-level location uncertainty was applied to all individuals.</p>
</div>
<div id="example-10-from-process-error-simulation-in-cohen-et-al.-in-revision" class="section level4">
<h4>EXAMPLE 10 (from process error simulation in Cohen et al. in revision)</h4>
<p><code>estMC</code> for measuring the influence of dispersal rates on MC</p>
<p>Long-distance dispersal occurs when individuals that originate or breed in one population do not return to the same population to breed the next year. To quantify the sensitivity of MC to dispersal, we used simulations in which dispersal probability between breeding regions varied from low to high to measure the sensitivity of MC to dispersal.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculates probability matrix based on exponential decline with distance</span>
mlogitMat &lt;-<span class="st"> </span>function(slope, dist) {
  preMat &lt;-<span class="st"> </span><span class="kw">exp</span>(-slope/<span class="kw">mean</span>(dist)*dist)
  <span class="kw">diag</span>(preMat) &lt;-<span class="st"> </span><span class="dv">0</span>
  nr &lt;-<span class="st"> </span><span class="kw">nrow</span>(dist)
  nc &lt;-<span class="st"> </span><span class="kw">ncol</span>(dist)
  outMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, nr, nc)
  for (b in <span class="dv">1</span>:nr) {
    outMat[b,] &lt;-<span class="st"> </span>preMat[b,]/(<span class="dv">1</span>+<span class="kw">sum</span>(preMat[b, ]))
    outMat[b,b] &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(outMat[b, ])
  }
  <span class="kw">return</span>(outMat)
}

<span class="co"># Crude optimizable function for developing migratory connectivity pattern based on MC</span>
mlogitMC &lt;-<span class="st"> </span>function(slope, MC.in, origin.dist, target.dist, origin.rel.abund) {
  nBreeding &lt;-<span class="st"> </span><span class="kw">nrow</span>(origin.dist)
  nWintering &lt;-<span class="st"> </span><span class="kw">nrow</span>(target.dist)
  psi &lt;-<span class="st"> </span><span class="kw">mlogitMat</span>(slope, origin.dist)
  if (<span class="kw">any</span>(psi&lt;<span class="dv">0</span>))
    <span class="kw">return</span>(<span class="dv">5</span>*slope^<span class="dv">2</span>)
  MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(origin.dist, target.dist, psi, origin.rel.abund)
  <span class="kw">return</span>((MC.in -<span class="st"> </span>MC)^<span class="dv">2</span>)
}

<span class="co"># Simple approach to estimate psi matrix and MC from simulated (or real) data</span>
<span class="co"># (doesn't include uncertainty).  Only uses one year for computation</span>
calcPsiMC3 &lt;-<span class="st"> </span>function(originDist, targetDist, originRelAbund, locations, year,
                       <span class="dt">verbose=</span>F) {
  nOrigin &lt;-<span class="st"> </span><span class="kw">nrow</span>(originDist)
  nTarget &lt;-<span class="st"> </span><span class="kw">nrow</span>(targetDist)
  psiMat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, nOrigin, nTarget)
  nInd &lt;-<span class="st"> </span><span class="kw">dim</span>(locations)[<span class="dv">1</span>]
  nYears &lt;-<span class="st"> </span><span class="kw">dim</span>(locations)[<span class="dv">3</span>]
  nMonths &lt;-<span class="st"> </span><span class="kw">dim</span>(locations)[<span class="dv">4</span>]
  for (i in <span class="dv">1</span>:nInd) {
    if (i %%<span class="st"> </span><span class="dv">1000</span> ==<span class="st"> </span><span class="dv">0</span> &amp;&amp;<span class="st"> </span>verbose) <span class="co">#</span>
      <span class="kw">cat</span>(<span class="st">&quot;Individual&quot;</span>, i, <span class="st">&quot;of&quot;</span>, nInd, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
    originMat &lt;-<span class="st"> </span>locations[i, <span class="dv">1</span>, year, ]
    targetMat &lt;-<span class="st"> </span>locations[i, <span class="dv">2</span>, year, ]
    bIndices &lt;-<span class="st"> </span><span class="kw">which</span>(!<span class="kw">is.na</span>(originMat))
    wIndices &lt;-<span class="st"> </span><span class="kw">which</span>(!<span class="kw">is.na</span>(targetMat))
    if (<span class="kw">length</span>(bIndices) &amp;&amp;<span class="st"> </span><span class="kw">length</span>(wIndices))
      for (bi in bIndices)
        for (wi in wIndices)
          psiMat[originMat[bi], targetMat[wi]] &lt;-<span class="st"> </span>psiMat[originMat[bi],
                                                         targetMat[wi]] +<span class="st"> </span><span class="dv">1</span>
  }
  psiMat &lt;-<span class="st"> </span><span class="kw">apply</span>(psiMat, <span class="dv">2</span>, <span class="st">&quot;/&quot;</span>, <span class="kw">rowSums</span>(psiMat))
  MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(originDist, targetDist, psiMat, originRelAbund)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">psi=</span>psiMat, <span class="dt">MC=</span>MC))
}

## Simulation ----
nBreeding &lt;-<span class="st"> </span><span class="dv">100</span>
nWintering &lt;-<span class="st"> </span><span class="dv">100</span>
breedingPos &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">seq</span>(-<span class="dv">99</span>, -<span class="dv">81</span>, <span class="dv">2</span>), <span class="dt">each=</span><span class="kw">sqrt</span>(nBreeding)),
                        <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">49</span>, <span class="dv">31</span>, -<span class="dv">2</span>), <span class="kw">sqrt</span>(nBreeding))), nBreeding, <span class="dv">2</span>)
winteringPos &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">seq</span>(-<span class="dv">79</span>, -<span class="dv">61</span>, <span class="dv">2</span>), <span class="dt">each=</span><span class="kw">sqrt</span>(nWintering)),
                         <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">9</span>, -<span class="dv">9</span>, -<span class="dv">2</span>), <span class="kw">sqrt</span>(nWintering))), nWintering, <span class="dv">2</span>)
<span class="kw">head</span>(breedingPos)
<span class="kw">tail</span>(breedingPos)
<span class="kw">head</span>(winteringPos)
<span class="kw">tail</span>(winteringPos)

breedDist &lt;-<span class="st"> </span><span class="kw">distFromPos</span>(breedingPos, <span class="st">'ellipsoid'</span>)
nonbreedDist &lt;-<span class="st"> </span><span class="kw">distFromPos</span>(winteringPos, <span class="st">'ellipsoid'</span>)

<span class="co"># Breeding Abundance</span>
breedingN &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">5000</span>, nBreeding)
breedingRelN &lt;-<span class="st"> </span>breedingN/<span class="kw">sum</span>(breedingN)

<span class="co"># Set up psi matrix</span>
o &lt;-<span class="st"> </span><span class="kw">optimize</span>(mlogitMC, <span class="dt">MC.in =</span> <span class="fl">0.25</span>, <span class="dt">origin.dist =</span> breedDist,
              <span class="dt">target.dist =</span> nonbreedDist, <span class="dt">origin.rel.abund =</span> breedingRelN,
              <span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">tol =</span> .Machine$double.eps^<span class="fl">0.5</span>)
o
slope &lt;-<span class="st"> </span>o$minimum
psi &lt;-<span class="st"> </span><span class="kw">mlogitMat</span>(slope, breedDist)

<span class="co"># Baseline strength of migratory connectivity</span>
MC &lt;-<span class="st"> </span><span class="kw">calcMC</span>(breedDist, nonbreedDist, psi, breedingRelN)
MC

<span class="co"># Other basic simulation parameters</span>

## Dispersal simulations---
<span class="kw">set.seed</span>(<span class="dv">1516</span>)
nYears &lt;-<span class="st"> </span><span class="dv">15</span>
nMonths &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># Each season</span>
Drates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.08</span>, <span class="fl">0.16</span>, <span class="fl">0.32</span>, <span class="fl">0.64</span>)    <span class="co">#rates of dispersal</span>
birdLocDisp &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">'list'</span>, <span class="kw">length</span>(Drates))
Disp.df  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Year=</span><span class="kw">rep</span>(<span class="dv">1</span>:nYears, <span class="kw">length</span>(Drates)),
                       <span class="dt">Rate=</span><span class="kw">rep</span>(Drates, <span class="dt">each =</span> nYears), <span class="dt">MC =</span> <span class="ot">NA</span>)
for(i in <span class="dv">1</span>:<span class="kw">length</span>(Drates)){
  <span class="kw">cat</span>(<span class="st">'Dispersal Rate'</span>, Drates[i], <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
  birdLocDisp[[i]] &lt;-<span class="st"> </span><span class="kw">simMove</span>(breedingN, breedDist, nonbreedDist, psi, nYears, nMonths,
                              <span class="dt">sumDispRate =</span> Drates[i])
  for(j in <span class="dv">1</span>:nYears){
    <span class="kw">cat</span>(<span class="st">'</span><span class="ch">\t</span><span class="st">Year'</span>, j, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)
    temp.results &lt;-<span class="st"> </span><span class="kw">calcPsiMC3</span>(breedDist, nonbreedDist, breedingRelN,
                                 birdLocDisp[[i]]$animalLoc, <span class="dt">year=</span>j, F)
    Disp.df$MC[j +<span class="st"> </span>(i -<span class="st"> </span><span class="dv">1</span>) *<span class="st"> </span>nYears] &lt;-<span class="st"> </span>temp.results$MC
  }
} <span class="co"># end i loop</span>

Disp.df$Year &lt;-<span class="st"> </span>Disp.df$Year -<span class="st"> </span><span class="dv">1</span> <span class="co">#just run once!</span>
<span class="kw">data.frame</span>(Disp.df, <span class="dt">roundMC =</span> <span class="kw">round</span>(Disp.df$MC, <span class="dv">2</span>), <span class="dt">nearZero =</span> Disp.df$MC &lt;<span class="st"> </span><span class="fl">0.01</span>)

<span class="kw">write.csv</span>(Disp.df, <span class="st">&quot;../Disp.df.csv&quot;</span>)

<span class="co"># Convert dispersal rates to probabilities of dispersing at least certain distance</span>
threshold &lt;-<span class="st"> </span><span class="dv">1000</span>
probFarDisp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, nBreeding, <span class="kw">length</span>(Drates), <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="ot">NULL</span>, Drates))
for (i in <span class="dv">1</span>:<span class="kw">length</span>(Drates)) {
  for (k in <span class="dv">1</span>:nBreeding) {
    probFarDisp[k, i] &lt;-<span class="st"> </span><span class="kw">sum</span>(birdLocDisp[[i]]$natalDispMat[k, <span class="kw">which</span>(breedDist[k, ]&gt;=<span class="st"> </span>threshold)])
  }
}
<span class="kw">summary</span>(probFarDisp)



<span class="co">#plot results</span>
\dontrun{
<span class="kw">require</span>(ggplot2)
<span class="kw">require</span>(ggthemes)

line_set=<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>, <span class="fl">1.25</span>, <span class="fl">1.75</span>, <span class="fl">2.25</span>)
<span class="kw">png</span>(<span class="st">'../dispersal.plot.png'</span>, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">6</span>, <span class="dt">res =</span> <span class="dv">600</span>, <span class="dt">units =</span> <span class="st">'in'</span>)
<span class="kw">ggplot</span>(Disp.df, <span class="kw">aes</span>(<span class="dt">x=</span>Year, <span class="dt">y=</span>MC, <span class="dt">size=</span><span class="kw">as.factor</span>(Rate)))+
<span class="st">  </span><span class="kw">geom_line</span>()+
<span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">values=</span>line_set)+
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">size=</span><span class="st">&quot;Dispersal Rate&quot;</span>)+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;MC&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(-.<span class="dv">005</span>, <span class="fl">0.26</span>), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>))+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>))+
<span class="st">  </span><span class="kw">theme_bw</span>()+
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>, <span class="dt">face =</span><span class="st">&quot;bold&quot;</span>),<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),
        <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">color=</span><span class="st">&quot;grey90&quot;</span>),<span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))
<span class="kw">dev.off</span>()
}</code></pre>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
