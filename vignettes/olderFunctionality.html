<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeffrey A. Hostetler, Michael T. Hallworth" />

<meta name="date" content="2023-09-04" />

<title>MigConnectivity package (older functionality)</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MigConnectivity package (older
functionality)</h1>
<h4 class="author">Jeffrey A. Hostetler, Michael T. Hallworth</h4>
<h4 class="date">2023-09-04</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>NOTE: this vignette is a bit out of date. Everything in it should
still work (let us know if it doesn’t), but it doesn’t highlight the new
functions from versions 0.3 and 0.4, such as <code>estStrength</code>,
<code>estTransition</code>, and <code>diffMC</code>. The new <a href="MigConnectivity.html">master vignette</a> links to all of
those.</p>
<p>Technological advancements have spurred rapid growth in the study of
migratory connectivity, the spatial and temporal linkage of migratory
populations throughout the annual cycle. However, the lack of a
quantitative definition for the strength of migratory connectivity (MC)
has limited our ability to draw inferences across species, studies, and
data types about the seasonal co-occurrence of populations. MC is a
standardized metric to quantify migratory connectivity between two
phases of the annual cycle. It is independent of data type and accounts
for the relative abundance of populations distributed across a seasonal
range. Negative values of MC indicate that individuals close to each
other in one season are further apart in the other season. If MC = 0, no
relationship exists between distances in one season and another; if MC =
1, the relative distances between individuals in one season are the same
in the other, although the scale can differ.</p>
<p>Three data inputs are needed to calculate MC, and one is
optional:</p>
<ol style="list-style-type: decimal">
<li><p>The probabilities of movement between regions (i.e., transition
probabilities);</p></li>
<li><p>Distances between regions within the two distinct seasonal ranges
(e.g., a matrix of distances between all regions within the breeding
range and a matrix of distances between all regions within the
non-breeding range);</p></li>
<li><p>Relative abundance among regions within the seasonal range from
which the transition probabilities originate (e.g., relative abundance
among breeding regions);</p></li>
<li><p>(Optional) Total sample size of animals used to estimate the
transition probabilities.</p></li>
</ol>
<p>MC takes the distances between the regions within the seasonal range
from which the transition probabilities originate (e.g. breeding) and
the distances between the regions within the other seasonal range
(e.g. non-breeding) and approximates the correlation between individuals
at those distances. Earlier methods (Mantel correlation; rM) used the
correlation between two distance matrices of individual animals captured
during the breeding phase and recaptured during the non-breeding phase
as a measure of the strength of migratory connectivity. Our method
builds on this method with a distance-based correlation coefficient
approximation, but is not specific to a data type and uses transition
probabilities from discreet regions, as opposed to distance matrices
between individuals. Further, we include relative abundance within one
seasonal range to account for uneven sampling among regions.</p>
<p>Cohen, E. B., J.A. Hostetler, M.T. Hallworth, C.S. Rushing, T.S.
Sillett, P.P. Marra. 2018. Quantifying the strength of migratory
connectivity. Methods in Ecology and Evolution. 9:3. 513-524.</p>
<div id="overview-of-functions" class="section level3">
<h3>Overview of Functions</h3>
<ol style="list-style-type: decimal">
<li><p><code>calcMC</code> calculates the strength of migratory
connectivity (MC) with the transitional probabilities between regions,
distances between regions within the two seasonal ranges, relative
abundance among regions within the seasonal range from which the
transition probabilities originate, and (optionally) the total sample
size of the transitional probability data.</p></li>
<li><p><code>estMC</code> estimates the strength of migratory
connectivity (MC) with estimates of uncertainty. MC estimated either
with transition probability estimates or individual assignments to
regions from tracking data. Uses re-sampling to measure MC uncertainty
from RMark transition probability matrix estimates and/or JAGS relative
abundance MCMC samples OR geolocator and/or GPS data.</p></li>
<li><p><code>simMove</code> Simulates annual movement of animals between
regions across seasons for years and months with individual variability
and strength of migratory connectivity (MC). Incorporates movement among
regions within a season and movement among regions between seasons.
Between seasons, animals either return to the same region each year or
return to a different region in the subsequent year (dispersal). Between
year dispersal rates occur during the first year (natal) or any
subsequent year (breeding or non-breeding). Simulation does not
incorporate births or deaths.</p></li>
</ol>
</div>
</div>
<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<div id="installing-migconnectivity-from-github" class="section level3">
<h3>Installing ‘MigConnectivity’ from GitHub</h3>
<p>In order to install the vignette along with the package use the
following code with <code>build_vignettes = TRUE</code>.
<strong>Note</strong> it takes quite a bit longer to download the
package when <code>build_vignettes = TRUE</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;SMBC-NZP/MigConnectivity&quot;</span>, <span class="at">build_vignettes =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(MigConnectivity)</span></code></pre></div>
</div>
<div id="functions" class="section level3">
<h3>Functions</h3>
<p><code>calcMC</code> Calculate strength of migratory connectivity
(MC)<br />
<code>estMC</code> Estimate the strength of migratory connectivity (MC)
while incorporating sampling uncertainty<br />
<code>simMove</code> Simulates annual and seasonal movement of animals
between regions</p>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div id="utility-functions-for-use-in-vignette" class="section level3">
<h3>Utility functions for use in vignette</h3>
<p><code>mlogitMat</code>: Calculates probability matrix based on
exponential decline with distance</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>mlogitMat <span class="ot">&lt;-</span> <span class="cf">function</span>(slope, dist) {</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>   preMat <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>slope<span class="sc">/</span><span class="fu">mean</span>(dist)<span class="sc">*</span>dist)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>   <span class="fu">diag</span>(preMat) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>   outMat <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(preMat, <span class="dv">1</span>, <span class="cf">function</span>(x) x<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">sum</span>(x))))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>   <span class="fu">diag</span>(outMat) <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">rowSums</span>(outMat)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>   <span class="fu">return</span>(outMat)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>}</span></code></pre></div>
<p><code>mlogitMC</code>: Crude optimization function for developing
migratory connectivity pattern based on migratory connectivity strength.
Uses same argument (origin.abund) for relative or absolute
abundance.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mlogitMC <span class="ot">&lt;-</span> <span class="cf">function</span>(slope, </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                     MC.in, </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                     origin.dist,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                     target.dist,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                     origin.abund,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                     sample.size) {</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    nBreeding <span class="ot">&lt;-</span> <span class="fu">nrow</span>(origin.dist)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    nWintering <span class="ot">&lt;-</span> <span class="fu">nrow</span>(target.dist)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">mlogitMat</span>(slope, origin.dist)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(psi<span class="sc">&lt;</span><span class="dv">0</span>))</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">5</span><span class="sc">*</span>slope<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    </span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  MC <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(origin.dist, </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>               target.dist, </span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>               <span class="at">originRelAbund =</span> origin.abund,</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>               psi, </span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>               <span class="at">sampleSize =</span> sample.size)</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  </span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  <span class="fu">return</span>((MC.in <span class="sc">-</span> MC)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>}</span></code></pre></div>
<p><code>calcStrengthInd</code>: rM function for individuals</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>calcStrengthInd <span class="ot">&lt;-</span> <span class="cf">function</span>(originDist, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                            targetDist, </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                            locations, </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                            <span class="at">resamp=</span><span class="dv">1000</span>, </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="dv">0</span>) {</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>nInd <span class="ot">&lt;-</span> <span class="fu">dim</span>(locations)[<span class="dv">1</span>]</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>originDist2 <span class="ot">&lt;-</span> targetDist2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, nInd, nInd)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nInd<span class="dv">-1</span>)) {</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a> <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>nInd) {</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>      originDist2[i,j] <span class="ot">&lt;-</span> originDist[locations[i,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>], locations[j,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]]</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>      targetDist2[i,j] <span class="ot">&lt;-</span> targetDist[locations[i,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>], locations[j,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>]]</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>      originDist2[j,i] <span class="ot">&lt;-</span> originDist[locations[i,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>], locations[j,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]]</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>      targetDist2[j,i] <span class="ot">&lt;-</span> targetDist[locations[i,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>], locations[j,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>]]</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    }</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  }</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="fu">return</span>(ncf<span class="sc">::</span><span class="fu">mantel.test</span>(originDist2, targetDist2, <span class="at">resamp=</span>resamp, <span class="at">quiet =</span> <span class="sc">!</span>verbose))</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>} </span></code></pre></div>
<p><code>calcPsiMC</code>: Simple approach to estimate psi matrix
(transition probabilities) and MC from simulated or real data (does not
incorporate sampling uncertainty)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>calcPsiMC <span class="ot">&lt;-</span> <span class="cf">function</span>(originDist, </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                      targetDist, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                      originRelAbund, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                      locations, </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                      <span class="at">years =</span> <span class="dv">1</span>, </span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                      <span class="at">months =</span> <span class="dv">1</span>, </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                      <span class="at">verbose=</span><span class="cn">FALSE</span>) {</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  nOrigin <span class="ot">&lt;-</span> <span class="fu">nrow</span>(originDist)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  nTarget <span class="ot">&lt;-</span> <span class="fu">nrow</span>(targetDist)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  psiMat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, nOrigin, nTarget)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  nInd <span class="ot">&lt;-</span> <span class="fu">dim</span>(locations)[<span class="dv">1</span>]</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  nYears <span class="ot">&lt;-</span> <span class="fu">dim</span>(locations)[<span class="dv">3</span>]</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  nMonths <span class="ot">&lt;-</span> <span class="fu">dim</span>(locations)[<span class="dv">4</span>]</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nInd) {</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">1000</span> <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> verbose) <span class="co">#</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Individual&quot;</span>, i, <span class="st">&quot;of&quot;</span>, nInd, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>    originMat <span class="ot">&lt;-</span> locations[i, <span class="dv">1</span>, years, months]</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    targetMat <span class="ot">&lt;-</span> locations[i, <span class="dv">2</span>, years, months]</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    bIndices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(originMat))</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>    wIndices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(targetMat))</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(bIndices) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(wIndices))</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    <span class="cf">for</span> (bi <span class="cf">in</span> bIndices)</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>      <span class="cf">for</span> (wi <span class="cf">in</span> wIndices)</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>       psiMat[originMat[bi], targetMat[wi]] <span class="ot">&lt;-</span> psiMat[originMat[bi], </span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>                                                      targetMat[wi]] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>  }</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  psiMat <span class="ot">&lt;-</span> <span class="fu">apply</span>(psiMat, <span class="dv">2</span>, <span class="st">&quot;/&quot;</span>, <span class="fu">rowSums</span>(psiMat))</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>  MC <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(originDist, targetDist, <span class="at">psi =</span> psiMat,</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>               <span class="at">originRelAbund =</span> originRelAbund, <span class="at">sampleSize =</span> nInd)</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">psi=</span>psiMat, <span class="at">MC=</span>MC))</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>}</span></code></pre></div>
<p><code>changeLocations</code>: transfers the simulated bird locations
from the true populations to the researcher defined regions</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>changeLocations <span class="ot">&lt;-</span> <span class="cf">function</span>(animalLoc, </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                            breedingSiteTrans, </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                            winteringSiteTrans) {</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  animalLoc[,<span class="dv">1</span>,,] <span class="ot">&lt;-</span> breedingSiteTrans[animalLoc[,<span class="dv">1</span>,,]]</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  animalLoc[,<span class="dv">2</span>,,] <span class="ot">&lt;-</span> winteringSiteTrans[animalLoc[,<span class="dv">2</span>,,]]</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">return</span>(animalLoc)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>}</span></code></pre></div>
<p><code>simLocationError</code>: Simulates location error with defined
bias and variance / covariance matrix</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>simLocationError <span class="ot">&lt;-</span> <span class="cf">function</span>(targetPoints, </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                             targetSites, </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                                         geoBias, </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                                         geoVCov, </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                             projection, </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                                         <span class="at">verbose =</span> <span class="dv">0</span>, </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                                         <span class="at">nSim =</span> <span class="dv">1000</span>) {</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  </span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">inherits</span>(targetPoints,<span class="st">&quot;SpatialPoints&quot;</span>)){</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  targetPoints <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(targetPoints)}</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">inherits</span>(targetSites,<span class="st">&quot;SpatialPolygons&quot;</span>) <span class="sc">|</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>   <span class="fu">inherits</span>(targetSites,<span class="st">&quot;SpatialPolygonsDataFrame&quot;</span>)){</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  targetSites <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(targetPoints)}</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>nAnimals <span class="ot">&lt;-</span> <span class="fu">nrow</span>(targetPoints)</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>geoBias2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(geoBias, nSim), <span class="at">nrow=</span>nSim, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>target.sample <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nAnimals)</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>target.point.sample <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nAnimals, <span class="dv">2</span>)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nAnimals){</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>  <span class="cf">if</span> (verbose <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;Animal&#39;</span>, i, <span class="st">&#39;of&#39;</span>, nAnimals)</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>  draws <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">is.na</span>(target.sample[i])) {</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>    draws <span class="ot">&lt;-</span> draws <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>    <span class="co"># Sample random point for each bird </span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>    <span class="co"># from parametric distribution of NB error</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>    ps <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n=</span>nSim, </span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>                  <span class="at">mu=</span><span class="fu">cbind</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(targetPoints)[i,<span class="dv">1</span>],</span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>                           sf<span class="sc">::</span><span class="fu">st_coordinates</span>(targetPoints)[i,<span class="dv">2</span>]),</span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>                  <span class="at">Sigma=</span>geoVCov)<span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>                  geoBias2</span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a>    </span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a>    <span class="fu">colnames</span>(ps) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>    </span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a>    point.sample <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(</span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a>                  <span class="fu">data.frame</span>(ps),</span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a>                  <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>                  <span class="at">crs =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(targetPoints))</span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a>      </span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a>    <span class="co"># filtered to stay in NB areas (land)</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a>    <span class="co">#target.sample0 &lt;- sp::over(point.sample, targetSites)</span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a>    </span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a>    target.sample0 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">unclass</span>(sf<span class="sc">::</span><span class="fu">st_intersects</span>(point.sample,</span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a>                                                       targetSites)))</span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a>    target.sample[i]<span class="ot">&lt;-</span>target.sample0[<span class="sc">!</span><span class="fu">is.na</span>(target.sample0)][<span class="dv">1</span>]</span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a>  }</span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a>    </span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a>  target.point.sample[i, ]<span class="ot">&lt;-</span>sf<span class="sc">::</span><span class="fu">st_coordinates</span>(point.sample[<span class="sc">!</span><span class="fu">is.na</span>(target.sample0),])[<span class="dv">1</span>,]</span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a>  <span class="cf">if</span> (verbose <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb7-52"><a href="#cb7-52" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39; &#39;</span>, draws, <span class="st">&#39;draws</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb7-53"><a href="#cb7-53" tabindex="-1"></a>}</span>
<span id="cb7-54"><a href="#cb7-54" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">targetSample =</span> target.sample, </span>
<span id="cb7-55"><a href="#cb7-55" tabindex="-1"></a>              <span class="at">targetPointSample =</span> target.point.sample))</span>
<span id="cb7-56"><a href="#cb7-56" tabindex="-1"></a>}</span></code></pre></div>
<p><code>toPoly</code>: Helper function to convert a string of XY
coordinates of centroids to polygons</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>toPoly <span class="ot">&lt;-</span> <span class="cf">function</span>(siteCentroids,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                   <span class="at">projection.in =</span> <span class="dv">4326</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                   <span class="at">projection.out =</span> <span class="cn">NA</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                   <span class="at">resolution =</span> <span class="cn">NA</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                   <span class="at">order.by.input =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>{</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># This automatically sets the resolution so that all polygons touch and</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># cover the entire surface. Alternatively the user can supply the </span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co"># resolution of the raster cells in the units of the input projection </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#(projection.in) </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">colnames</span>(siteCentroids) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(resolution)){</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>     long <span class="ot">&lt;-</span> <span class="fu">unique</span>(siteCentroids[,<span class="dv">1</span>])</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>     lat <span class="ot">&lt;-</span> <span class="fu">unique</span>(siteCentroids[,<span class="dv">2</span>])</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>     long.res <span class="ot">&lt;-</span> long[<span class="dv">2</span>]<span class="sc">-</span>long[<span class="dv">1</span>]</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>     lat.res <span class="ot">&lt;-</span> lat[<span class="dv">2</span>]<span class="sc">-</span>lat[<span class="dv">1</span>]</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>     resolution <span class="ot">&lt;-</span> <span class="fu">c</span>(long.res,long.res)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  }</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>  rast <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>          raster<span class="sc">::</span><span class="fu">rasterFromXYZ</span>(<span class="fu">cbind</span>(<span class="fu">cbind</span>(siteCentroids),</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>                                (<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(siteCentroids))),</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>                                 <span class="at">res =</span> resolution,</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>                                  <span class="at">crs =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(projection.in)<span class="sc">$</span>proj4string))</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  </span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>  polys <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">rasterToPolygons</span>(rast)</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>  </span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>  <span class="co"># Give unique names to polygons #</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>  polys <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(polys)</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_crs</span>(polys) <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(projection.in)</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a> <span class="co"># polys &lt;- sp::SpatialPolygons(polys@polygons)</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a> <span class="co"># raster::crs(polys)&lt;-projection.in</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>  </span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>  <span class="co"># Reorders the polygons to match that of the input #</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a>  centers <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(siteCentroids),</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a>                          <span class="at">crs =</span> projection.in)</span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a>  <span class="co">#centers &lt;- sp::SpatialPoints(siteCentroids, sp::CRS(projection.in))</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a>  </span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a>  <span class="cf">if</span>(order.by.input){</span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a> <span class="co"># orders &lt;- sp::over(centers,polys)</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a>  orders <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">unlist</span>(<span class="fu">unclass</span>(sf<span class="sc">::</span><span class="fu">st_intersects</span>(centers,</span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a>                                                       polys,</span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a>                                                       <span class="at">sparse =</span> <span class="cn">TRUE</span>))))</span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a>  polys <span class="ot">&lt;-</span> polys[orders,] </span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a>  }</span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a>  <span class="co">#sp::spChFIDs(polys,as.character(1:length(polys)))</span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a>  </span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(projection.out)){</span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a>    polys <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(polys, projection.out)</span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a>  }</span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a>  </span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a>  <span class="fu">return</span>(polys)</span>
<span id="cb8-54"><a href="#cb8-54" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="example-1" class="section level3">
<h3>EXAMPLE 1</h3>
</div>
<div id="calcmc---calculate-strength-of-migratory-connectivity" class="section level3">
<h3><code>calcMC</code> - Calculate strength of migratory
connectivity</h3>
<p>This function calculates the strength of migratory connectivity
between populations during two different time periods within the annual
cycle. Below, we illustrate how to calculate the strength of MC between
three breeding and non-breeding regions.</p>
<p>To calculate the strength of MC, you will need:</p>
<ol style="list-style-type: decimal">
<li>to define the number of breeding and non-breeding regions<br />
</li>
<li>the distance between the breeding regions and the distance between
the non-breeding regions<br />
</li>
<li>the transition probabilities between each breeding and non-breeding
region (<code>psi</code>)<br />
</li>
<li>the relative abundance within each of the regions where individuals
originate from (here the breeding regions)</li>
<li>(optional) the total sample size of animals used to estimate the
transition probabilities.</li>
</ol>
</div>
<div id="calculate-mc-between-breeding-and-non-breeding-regions" class="section level3">
<h3>Calculate MC between breeding and non-breeding regions</h3>
<p>Simple example with three breeding and three non-breeding regions</p>
<p>Define the number of breeding and non-breeding populations</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>nBreeding <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#number of breeding regions</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>nNonBreeding <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#number of non-breeding regions</span></span></code></pre></div>
<p>Generate a distance matrix between the different regions</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#distances between centroids of three breeding regions</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>breedDist <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                      <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                      <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>), nBreeding, nBreeding) </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#distances between centroids of three non-breeding regions</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>nonBreedDist <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>                         <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>                        <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">0</span>), nNonBreeding, nNonBreeding)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAilBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkJBmtrZmtttmtv+QOgCQZjqQkGaQtpCQttuQ29uQ2/+2ZgC2Zjq2kDq2tma22/+2///bkDrbtpDb29vb////tmb/25D/27b//7b//9v///+QrBiVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFs0lEQVR4nO3dDXebVACA4ZuuTZy61K+1Tm3UNNq0Df//73nhQoCZ7KWWQKTve866CwkEHvmqp6cLmX2xMPYGnHsCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQeMBbUJq9u266yKrcHG/uw1XD6fcrs8aHyjEve64yFsFCsuOi6y6W/bWmEBpbx8XYZ5PzX75Plyss93v8az7UBwjreEiXP5aH0Hx7b/FVy/vqvdd3p1Ib3ygvxb5EZSOp6uH5+ticBlfagyjSnU2VkDlBeyuenH2fnpAVfk1JU5drbO/87NonR9Uy6w53IYwf8gPlAbQ5Tr/un9x9YJr2Us6A6DZxzR1kxVHzTJLR1djWF584pwG0E11djZePMFmngFQSKdYfrbku1ydO41hRJnni7SuQXcFyjyrbmuTvQY9Ff/pS6Dt/rC6awwLiOwIUPPFE2zm+EBpZ+sj6KZ8vTFsHiRv8Ai6bQBVh0N7eOgatAd6C9eg/R7nexuv2fGsi7Maw8aN6t9Ak7+LFftaAZUPP+XuV8OI9flzUA00+eegr9dZDZQ9/RzvXun718Zw98civPt48BqUnqS/WU/uGtR3q9N8EzsBoHj6fageGvtvAkDbxqWs/yYAlD39sHjR/3d7UVMAOmkCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQecIlH6aBScG2phBP61T1Y/mwcRQWzPkh3Wq/uHXL04MtjkDflanQqMvTAy3PcN9VKdCtwbcoOE+qlMdgYbbbIFogwb7pG4JBAkEnZvP2QF5m8daCscnBtucAT+rYy2F4xNDbc2QH9axlsLxiYE2ZtBP+x8mECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEHRCoFf/nv7X/6L/Hv6lAIFoFf9pqW6rFghWLRCsWiBYtUCwaoFg1QLBqgWCVQsEqxYIVi0QrFogWLVAbyGBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaAxgHa3F/f536urh8NveFzcdFjNdnb3fN3lja9qHKAwz/9+PVCPG3WscYDefZXvm0BH2t3ON/khVABtQwjLLHu+/uk6hNLlcfHjIs397lOIp+MmvSdrDWaf0ilWL7lKM/vd2JGAiotHDrQN+S7O45+4Z5ty7x4XcfC4WMa5ueGmnKoHq6i2DRVQuWQ1s9+NHQko28Q9j0C72/yAKC63y/rUKhCyzcV9Mbf4km3LqXyQ3reqgNKS+5n9buxYQLlMBEp7Fb8Wh1R1U0pzq7tUutbEefWguAtuK6C05H5mvxs7FlB+IOyB4u61gYprePyagMpfg3izH2wOAW0mBpStloeOoOIyfOgIypqDt3AExQPkfesa1DrFimvQ1UNrbj1IgJs20H5mvxs7HlC8K7fuYi2guJvplf1Or6q7XDWo72LlktO6i2VZeQ/fPwe1gPLnoHpGft4VJ1BzUD8HVW+Mz0EXf6bvYvprat+sbgU6VnENSo9KfTYdoPQ40Pt39xMCOk0CQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJB/wAHVaLOBJBW9QAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Define the transition probabilities between the breeding and
non-breeding regions</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#transition probabilities form each breeding to each non-breeding region</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.35</span>, <span class="fl">0.25</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>), nBreeding, nNonBreeding, <span class="at">byrow =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAilBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkJBmtrZmtttmtv+QOgCQZjqQkGaQtpCQttuQ29uQ2/+2ZgC2Zjq2kDq2tma22/+2///bkDrbtpDb29vb////tmb/25D/27b//7b//9v///+QrBiVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIrklEQVR4nO2cC1fbNhiGBYVk3dawW2HdRrqFbASK/v/fm2xZtuTbKzu6GOd9zgFkS5Y+PejmlFMhySgidwBLh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgLkE3QUmqsfD76P7MX109uDuH2OGVeL/IKE6rXnI5cqSOw8H9n7uwxGTkG6ty9bsSmurv74WVwf5NtXNes+lWPESW7FzZ/NCFLF/1K5N4+m3M1jJHv5Bf27LUaQHk+3z9/uysSNyrKSyoqZjUZQtYA9msyrj+sTZCjWFHV1e5D/FbPoUAyqnbSTJyE2z8VAsQTdHIrvdeZ+wlo2hQUIuvqsr+5lOWp2Uo8uK1ktPuqOJejezE4rM0KYCxAk9BQrZkvRZTN3rKSSsikecdagx1LKRpptbbVr0Gv5q68Eneph9WglSxFyQJCdGSHM/IJ0Z5sRdF/lW0l7kFzgCHqwBJnh4Cb71qBa0CWsQXWPi96qNVvNOnXLSlobVVfQ6nexsq9GUHX4qbpvkkpW+xzUCFr9Oej7g2wEydff1e6l31+t5NvfW/Hhc+8apE/SPxxWtwaFZh/nJXYFgtT0+2QOjeFZgaCTtZSFZwWC5Osv20mfu01iDYKiQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAEsUpP+aBV4kCiZpa16YP80DF6miSdmYF80fv45eJAsnYVteCIuRi3TxpGvKC+FHwoDSNeWFp6B0YVMQCihZS35QEICCAEvzszhB3OYhjoWBCwoyGsSAoYThpGvKk94p1TaUMJx0TflRy7GSVbopkTKehG15Ufsw6Y6gxPFkaXUYYQly1OQytERBUnanWOqZ1QSUo9FhhDNe6oVa58kc4S5QkEnUN5qhk2EULUuQ6AiSFGRhyXB2dQqqoKBx7Nk0YOWyF+mBsTJ0AkoznBYkqL0cCzsHFI8YVfwmfLEnWEtK3yy7OEGtFdrtfc/cS/RavyxBVsqcqOvc3mIXJMg5I1qvq022VbD1RNS4orfgR+cIVAmyC1TR9r+FRAssdgOetAdQd+eqfaQdQgsR1PHTc/oR7axLE+Qmeg4/7ireWyRCZNFb8MEZQM29bqnBvHihpWpolP4B1IltNDNWaInaGaWzugytLxkMLUaQSVi3+l/AWonosaVpZhT7DOTcbSXcu2liW4IgMFhauak/Mlu0oN4DUWJD+QUNHvcGBSWNeRmCWjfqDDc/9fpsN5qPzgBqL87dLa7vJSRefNFq9g1gaAANC2oLifpOllvQSOeGBckLEzQQx4gga5jJyB8MZRZkujbwXuF8/NN3imyKxDKUV5DoSGjlgrzm49l1C2rOhO1cOfhemspQVkGtCdbdz0YEuQ+tWJAcHEBAkOwMoTgxRqnVs213gvXly7GPflqGIgUZp1q/tsf9eAjqfVkLS0ZBAv3uWyt4bwHrRxwyCxr//dtL+OSDQKgoo9UMWy77Va/TA0XkqCAZf5LlFWTNkoEivWmnyEhmCLIJqs9AI2F4CRpaoAKRS5DXwcUpMr6VReP9CDqr0HwyCfI7+fotvnENZRTkV8yr1NQnJpBHkD2Axnrk2V37o8bQhvIJapKj5TyrsypegSDfAeQ9YepyIrihbIJ8C9ZJv4KrEFS9ZPiV7KTGSopVCKpfwvyKuomRomaChTWUS9DEfd7rVLkSQU0v/I6K9Zdf0XUI8u20rDvseaJewS42aQDJSSMi/PCRGQVNKj2t7tmx9dYZtDaP9qJ2ufmIMhiZBEUqLn3PD/4kFjR1m5ku6H3vYvUKPdHQ5BbmBDdQYbiqfFqbK2jqGJoVXX994aryaKzq7PQ5M/GJOcENVRewLtzY9NinC5qi36e2kJWhttIICvtvZakFzXlmuiAx77fRW1mAOnybmi9oYphChPtgKLGg6QvEGVqDGEonaGbM8/oZzlAyQWLeAJo7Vd6roMTPBTCUStDsaCkIP3hOi+9F0Pxg5/fyXa1BZwR7nqF5bdqVnF2DVytZBAUxlFBQpmdnPlpXcebzY1W7ZKhAnl0BBeEqZj3lVzUFgaopCFRNQaBqCgJVUxComoJA1RQEqqYgUDUFgaopCFRNQaBqCroEKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBADkFvD9dPxc/97XN/gZftvUc1p6vHb3c+Bc8ijyCxKX6eLyhgUEPkEfThu6JvFDTA28PmWAyhUtBJCLGT8tvdb3dCVF5etr9u9d2fvgg1HY+6jHQSV1/0FGue3OubYYPNJKhcPApBJ1F0caO+VM+OVe9etirxst2pu4XDY3XVJPbK2kkYQdWT5mbYYDMJkkfVcyXo7aEYEOVyu2umVilBHq+fyrvlN3mqroqELrc3gvST9c2wweYSVJhRgnSv1PdySJlNSd81u5Rea9S9JlHugicjSD9Z3wwbbC5BxUCoBanuuYLKNVx914Kq/wbxvk4c+wQdVyZI7nd9I6hchvtGkLQTlzCC1AD56KxBzhQr16DbZ+duk9ACj66g+mbYYPMJUruys4s5glQ3dU7d6b3Z5Uyi2cWqJ9e1i0lZ7eH1OcgRVJyDmhvFvCsnkJ1ozkGmoDoHXf+j32LCsbaX1RMFDVGuQfqoFJL1CNLHgeBv9ysSFAcKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPgfIOaBw0Ume30AAAAASUVORK5CYII=" /><!-- --></p>
<p>Define the relative abundance within the three breeding regions</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co">#equal relative abundance among the three breeding regions, must sum to 1                      </span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>relN <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>nBreeding, nBreeding) </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>relN</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.3333333 0.3333333 0.3333333</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co"># Define total sample size for psi data </span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># for small sample corrected version of MC </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">250</span></span></code></pre></div>
<p>Calculate the strength of migratory connectivity using the inputs
above</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Calculate the strength of migratory connectivity </span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>MC <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> breedDist,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>             <span class="at">targetDist =</span> nonBreedDist,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>             <span class="at">originRelAbund =</span> relN,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>             <span class="at">psi =</span> psi)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="fu">round</span>(MC, <span class="dv">3</span>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; [1] 0.05</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>MC <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> breedDist,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>             <span class="at">targetDist =</span> nonBreedDist,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>             <span class="at">originRelAbund =</span> relN, </span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>             <span class="at">psi =</span> psi,</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>             <span class="at">sampleSize =</span> n)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="fu">round</span>(MC, <span class="dv">3</span>)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt; [1] 0.044</span></span></code></pre></div>
</div>
<div id="example-2" class="section level3">
<h3>EXAMPLE 2</h3>
</div>
<div id="estmc---estimate-strength-of-migratory-connectivity-incorporating-location-and-other-sampling-uncertainty" class="section level3">
<h3><code>estMC</code> - Estimate strength of migratory connectivity
incorporating location and other sampling uncertainty</h3>
<p>Estimates of MC may also be influenced by error in individual
assignment to regions. Data types vary in location accuracy and
precision, which are likely to influence the accuracy with which
individuals are assigned to regions.</p>
<p>To estimate MC and include location uncertainty the following data
are needed:</p>
<ol style="list-style-type: decimal">
<li>A logical vector indicating the type of device the location
estimates were derived from (GPS = FALSE, Light-level geolocator =
TRUE)<br />
</li>
<li>Location Bias - a vector that has error estimates for both longitude
and latitude<br />
</li>
<li>Location error - a variance, covariance matrix of longitude and
latitude<br />
</li>
<li>Distance matrix between breeding and non-breeding regions<br />
</li>
<li>A shapefile of both breeding and non-breeding regions<br />
</li>
<li>The deployment locations and the ‘unknown’ locations derived from
the tracking devices<br />
</li>
<li>The relative (or absolute) abundance within each region where the
birds originate from (deployment regions)</li>
</ol>
<p>Below is a repeatable example for how to calculate location bias and
location error using coordinates derived from light-level
geolocators.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Load in projections</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;projections&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Define deployment locations (winter) # </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>captureLocations<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.93</span>,<span class="fl">18.04</span>,   <span class="co"># Jamaica</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                           <span class="sc">-</span><span class="fl">80.94</span>,<span class="fl">25.13</span>,   <span class="co"># Florida</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                           <span class="sc">-</span><span class="fl">66.86</span>,<span class="fl">17.97</span>),  <span class="co"># Puerto Rico</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>                            <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="fu">colnames</span>(captureLocations) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co"># Convert capture locations into SpatialPoints #</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>CapLocs <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(captureLocations),</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>                      <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co"># Project Capture locations # </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>CapLocsM<span class="ot">&lt;-</span>sf<span class="sc">::</span><span class="fu">st_transform</span>(CapLocs, <span class="st">&#39;ESRI:54027&#39;</span>)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co"># Retrieve raw non-breeding locations from github </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co"># First grab the identity of the bird so we can loop through the files </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co"># For this example we are only interested in the error </span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co"># around non-breeding locations </span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co"># here we grab only the birds captured during the non-breeding season </span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co"># Using paste0 for vignette formatting purposes</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>winterBirds <span class="ot">&lt;-</span> <span class="fu">dget</span>(<span class="fu">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/&quot;</span>,</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>                    <span class="st">&quot;SMBC-NZP/MigConnectivity/master/&quot;</span>,</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>                    <span class="st">&quot;data-raw/GL_NonBreedingFiles/winterBirds.txt&quot;</span>))</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co"># create empty list to store the location data #</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>Non_breeding_files <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&#39;list&#39;</span>,<span class="fu">length</span>(winterBirds))</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co"># Get raw location data from Github #</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(winterBirds)){</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a>Non_breeding_files[[i]] <span class="ot">&lt;-</span> <span class="fu">dget</span>(<span class="fu">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/&quot;</span>,</span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>                                        <span class="st">&quot;SMBC-NZP/MigConnectivity/master/data-raw/&quot;</span>,</span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>                                        <span class="st">&quot;GL_NonBreedingFiles/NonBreeding_&quot;</span>,</span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>                                        winterBirds[i],<span class="st">&quot;.txt&quot;</span>))</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>}</span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co"># Remove locations around spring Equinox and potential migration points</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co"># same NB time frame as Hallworth et al. 2015 </span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co"># two steps because subset on shapefile doesn&#39;t like it in a single step</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a>Non_breeding_files <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Non_breeding_files,</span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a>                      <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a>                      month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(x<span class="sc">$</span>Date,<span class="at">format =</span> <span class="st">&quot;%m&quot;</span>))</span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a>                               x[<span class="fu">which</span>(month <span class="sc">!=</span> <span class="dv">3</span> <span class="sc">&amp;</span> month <span class="sc">!=</span> <span class="dv">4</span>),]})</span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a>   </span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a>Jam <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)   <span class="co"># locations w/in list of winterBirds captured in Jamaica</span></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a>Fla <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>) <span class="co"># locations w/in list of winterBirds in Florida</span></span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a>PR <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>)  <span class="co"># locations w/in list of winterBirds in Puerto Rico</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a></span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a><span class="co"># Turn the locations into shapefiles #</span></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a></span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a>NB_GL <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Non_breeding_files, </span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a>                <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a>                  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(x),</span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a>                               <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,</span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a>                                          <span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a>                               <span class="at">crs =</span> <span class="dv">4326</span>)})</span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a></span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a><span class="co"># Project into UTM projection #</span></span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a>NB_GLmeters <span class="ot">&lt;-</span> <span class="fu">lapply</span>(NB_GL,</span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a>                      <span class="at">FUN =</span> <span class="cf">function</span>(x){sf<span class="sc">::</span><span class="fu">st_transform</span>(x,<span class="st">&#39;ESRI:54027&#39;</span>)})</span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a></span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a><span class="co"># Process to determine geolocator bias and variance-covariance in meters #</span></span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a></span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a><span class="co"># generate empty vector to store data #</span></span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a>LongError<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(winterBirds)) </span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a>LatError<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">length</span>(winterBirds))  </span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a></span>
<span id="cb14-79"><a href="#cb14-79" tabindex="-1"></a><span class="co"># Calculate the error in longitude derived </span></span>
<span id="cb14-80"><a href="#cb14-80" tabindex="-1"></a><span class="co"># from geolocators from the true capture location </span></span>
<span id="cb14-81"><a href="#cb14-81" tabindex="-1"></a></span>
<span id="cb14-82"><a href="#cb14-82" tabindex="-1"></a>LongError[Jam] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Jam],</span>
<span id="cb14-83"><a href="#cb14-83" tabindex="-1"></a>                         <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb14-84"><a href="#cb14-84" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">1</span>,<span class="dv">1</span>])}))</span>
<span id="cb14-85"><a href="#cb14-85" tabindex="-1"></a></span>
<span id="cb14-86"><a href="#cb14-86" tabindex="-1"></a>LongError[Fla] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Fla],</span>
<span id="cb14-87"><a href="#cb14-87" tabindex="-1"></a>                         <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb14-88"><a href="#cb14-88" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">2</span>,<span class="dv">1</span>])}))</span>
<span id="cb14-89"><a href="#cb14-89" tabindex="-1"></a></span>
<span id="cb14-90"><a href="#cb14-90" tabindex="-1"></a>LongError[PR] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[PR],</span>
<span id="cb14-91"><a href="#cb14-91" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">1</span>]<span class="sc">-</span></span>
<span id="cb14-92"><a href="#cb14-92" tabindex="-1"></a>                                                 sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">3</span>,<span class="dv">1</span>])}))</span>
<span id="cb14-93"><a href="#cb14-93" tabindex="-1"></a></span>
<span id="cb14-94"><a href="#cb14-94" tabindex="-1"></a><span class="co"># Calculate the error in latitude derived from</span></span>
<span id="cb14-95"><a href="#cb14-95" tabindex="-1"></a><span class="co"># geolocators from the true capture location </span></span>
<span id="cb14-96"><a href="#cb14-96" tabindex="-1"></a></span>
<span id="cb14-97"><a href="#cb14-97" tabindex="-1"></a>LatError[Jam] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Jam],</span>
<span id="cb14-98"><a href="#cb14-98" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb14-99"><a href="#cb14-99" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">1</span>,<span class="dv">2</span>])}))</span>
<span id="cb14-100"><a href="#cb14-100" tabindex="-1"></a></span>
<span id="cb14-101"><a href="#cb14-101" tabindex="-1"></a>LatError[Fla] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[Fla],</span>
<span id="cb14-102"><a href="#cb14-102" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb14-103"><a href="#cb14-103" tabindex="-1"></a>                                                 sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">2</span>,<span class="dv">2</span>])}))</span>
<span id="cb14-104"><a href="#cb14-104" tabindex="-1"></a></span>
<span id="cb14-105"><a href="#cb14-105" tabindex="-1"></a>LatError[PR] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(NB_GLmeters[PR],</span>
<span id="cb14-106"><a href="#cb14-106" tabindex="-1"></a>                        <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">mean</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(x)[,<span class="dv">2</span>]<span class="sc">-</span></span>
<span id="cb14-107"><a href="#cb14-107" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_coordinates</span>(CapLocsM)[<span class="dv">3</span>,<span class="dv">2</span>])}))</span>
<span id="cb14-108"><a href="#cb14-108" tabindex="-1"></a></span>
<span id="cb14-109"><a href="#cb14-109" tabindex="-1"></a><span class="co"># Get co-variance matrix for error of </span></span>
<span id="cb14-110"><a href="#cb14-110" tabindex="-1"></a><span class="co"># known non-breeding deployment sites </span></span>
<span id="cb14-111"><a href="#cb14-111" tabindex="-1"></a></span>
<span id="cb14-112"><a href="#cb14-112" tabindex="-1"></a><span class="co"># lm does multivariate normal models if you give it a matrix dependent variable!</span></span>
<span id="cb14-113"><a href="#cb14-113" tabindex="-1"></a></span>
<span id="cb14-114"><a href="#cb14-114" tabindex="-1"></a>geo.error.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(LongError,LatError) <span class="sc">~</span> <span class="dv">1</span>) </span>
<span id="cb14-115"><a href="#cb14-115" tabindex="-1"></a></span>
<span id="cb14-116"><a href="#cb14-116" tabindex="-1"></a>geo.bias <span class="ot">&lt;-</span> <span class="fu">coef</span>(geo.error.model)</span>
<span id="cb14-117"><a href="#cb14-117" tabindex="-1"></a>geo.vcov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(geo.error.model)</span></code></pre></div>
<p>We measured MC for bootstrapped data of birds tracked from breeding
to non-breeding regions using light-level and GPS geolocation when 1)
GPS location uncertainty was applied to all individuals, 2) GPS and
light-level location uncertainty were applied to individuals with those
devices, and 3) light-level location uncertainty was applied to all
individuals.</p>
<p>Load location data that accompanies the <code>MigConnectivity</code>
package. The location data are data from breeding Ovenbirds that were
fit with Light-level geolocators or PinPoint-10 GPS tags.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">data</span>(OVENdata) <span class="co"># Ovenbird </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">names</span>(OVENdata)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;geo.bias&quot;       &quot;geo.vcov&quot;       &quot;isGL&quot;           &quot;targetPoints&quot;  </span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;originPoints&quot;   &quot;targetSites&quot;    &quot;originSites&quot;    &quot;originRelAbund&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;originDist&quot;     &quot;targetDist&quot;     &quot;originNames&quot;    &quot;targetNames&quot;</span></span></code></pre></div>
<p>The figure below shows the two breeding regions (squares), and the
three non-breeding regions (gray scale) used in Cohen et al. (2018) to
estimate MC for Ovenbirds tracked with light-level geolocators and
PinPoint-10 GPS tags.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&#39;rgeos&#39;</span>, <span class="st">&#39;shape&#39;</span>, <span class="st">&#39;raster&#39;</span>, <span class="st">&#39;maptools&#39;</span>, <span class="st">&#39;rgdal&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">library</span>(shape)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">data</span>(wrld_simpl)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>wrld_simpl <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(wrld_simpl, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="fu">plot</span>(OVENdata<span class="sc">$</span>originSites,</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(raster<span class="sc">::</span><span class="fu">extent</span>(OVENdata<span class="sc">$</span>targetSites)[<span class="dv">1</span>],</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>            raster<span class="sc">::</span><span class="fu">extent</span>(OVENdata<span class="sc">$</span>targetSites)[<span class="dv">2</span>]),</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>     </span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(raster<span class="sc">::</span><span class="fu">extent</span>(OVENdata<span class="sc">$</span>targetSites)[<span class="dv">3</span>],</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>            raster<span class="sc">::</span><span class="fu">extent</span>(OVENdata<span class="sc">$</span>originSites)[<span class="dv">4</span>]))</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="fu">plot</span>(OVENdata<span class="sc">$</span>targetSites,</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>     <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;gray70&quot;</span>,<span class="st">&quot;gray35&quot;</span>,<span class="st">&quot;gray10&quot;</span>))</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>wrld_simple<span class="ot">&lt;-</span>sf<span class="sc">::</span><span class="fu">st_transform</span>(wrld_simpl, sf<span class="sc">::</span><span class="fu">st_crs</span>(OVENdata<span class="sc">$</span>originSites))</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(wrld_simple),<span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAD1BMVEUAAAAaGhpZWVmzs7P///8zYQijAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMQElEQVR4nO2d2YLjKAxF1T3+/2+emRizCsQiJJH4PnRV2RiJE1aB03CxCoA3vwkHIPGh8KflILgsetPPSBlQbr50p+kgfPBsBaRNKBXiDAEI8jRbAIF6S7uFedH2DO4GFtUi/pJ86JwL6O6DwH/Im0piAtA4H3cf3L95j88pA4RQF0hAz0jmmtq2goB6R4Rbp31K/IZ9gLQ7oorx9iAGz88n2T5ApDO7NQUoTBKf3mdrM9iQd3e7rSWj5okxkf3jMT9+eAYXOt3gDZ97emV3R8qcf/LpNpxvWG3dwnqc7f0EK6JiqYVjItsRdrnSngQ6UkZElaGbXMI3/IlW8NEcKGQoMtJwGSHGaD/y9Odz15tk5pzFPL4NUN/yIEaZDFvJWoO2ySV+QFAqSUhhggApesjdGmiuXOKxMlBFovSdDoWEQKTcISZAc0+hmCBPVH14yuioOKys+ZphSod0PGcQjGwxWGFZNn7K7AoemhQaNxId5hnMLH6W2cAeXSkqpo8E5U9u1aKZ1OepDCrde7G8gCsd4I4A1Df9a2cA9/hdds7Z/AC1vV9LZtI2MZeDq4LI4EVMeoQALdhh6C1bKytqUmge0NKayK+r6pAB/ZW4uEGzdtY6S8gWFM0K1Dvn3qPZWfB8BlBurLQqUHUuPWp3VjOGyI+3/Ww5pmPpiCHACCBkdT4SA+u0V2lEzUmoCUAdq6xRP4cGpJZ9E32QDJ+5ZmQC0EiQdN7a5Dgx9RS3nRcQYYbyQo+PEUCrAHuSHw2IGsa+HlB7DJvfaR94YHmts1WNeVhPpPnrAdWWOd37N4PmOMM6EoDwLqF/k0KxBxIBhH2eQ1s4Yz4yR3X2AyosDG9wMSQ3DCgzMLH9x/DAQil3A0pCFnObo+PPFKdgDAMKMeXpneNZqIcAuqIjStUUbAGZePuCZ/NPZJjvWEjUj7XMAWLbHRWLKDYUtwXkMNRITu5cArWXMeeclvB50lPG0Qp0n9+gDAxkufIwj5oLtc7zZEnK1Xh/p3diosOJ9T2OBkKmEz4nAHrSFe0Osp9r+e94mkPDS/WHU9ygGg1xsYTHAfo8kuwuEt3UDwICf0C+ow9fLeChgC5fdShMxwNaaGHpGzo4puXyHQioOQ1knUWzZCDvQMc82WNaL96BgFJErfGraxJO2VrOQcMBzjbUb0pFc/ZfQO20ku+7nQMIp/ICetJVOuZvB9TPB39KIKS+3cK6+eyNE9Z5IG18u4VF88+ML46RjTy/KuOA/HQ4BJr5oqld0gVEWI/DhxDR6n2eQ7YBRWnu3zn3K/pkGtAVRzOuMvYs4bxZQE/tgehCnvzrAbWMO0DNKc8vA/I9T2OHXcR384AudHynHueTUUDPN/o0q9ALKNtZVhjDdAER0VJIGppSBbIKyO97hXRdb6DyyyqgKzrpo1mB7AK6wvmEG9XY02xSBESajo9wvIDQFKDOxzag8G1IZdoXUJRI5TtWhe1MWX5mQooVyDagp4n9KKD2wbkIDesbhKNSDpg1ToeBn/5o8tHe1XCqcarWsl8D5IRyWn/DZUmmADllDU+1hZkE9Mif1SzvCDohZ2pWSMN7ASUKa3q2o5kDxgVtzSqrPRxHMweMC9oalQ8nihLBnDCqm035BqG4E1blY9J7/48mwgk1y7R8ryzb62ROqFnu1fNuj5p580re6ZG3rmW4X+JTn9S6lmFKUasCzYHeLKD0laYXEKYwgCmO85YBJaswNRe0DFOKdp51/VC13lJj01DUDVXrhFTb1uODsv2qQH2Z6vzQdgAVeGl7YhMQFL/oyYALpSw5ZcmXR6Z8MuXMLVsu2fLmUp/2FDLmzguIkjU+pgAZmfmksuKPQTS3jHhlxA1ENjyz4QUqE64ZbV0fWXDNMp8XECUDvpnmYwCQbT7qgIzjUQZkdXIYS/Nokn06l+ahgCPwaAE6oW05KQGyWYFUXysyYbYt5bdC9K1O6QVESMXVg/io+HoSHw1nj+LzAqIk7+1ZfOTdPYyPuL+n8XkBURJ2+Dg+kx5DTXvMaWrKY4B/cJGEfgRQg1DrGYtnE0iNO+zeDqjWoVqrg/suo+8i4gbUQkZUMZsadth9Yw1Ehe/ERLVBm+pzOGkyUI5iXYTcj80F4hbdq8LzzmgGKU3Z3+A2F4hbhL+ul6WKldWiVqX6MkDX5d8YbacMTIhm94WA/LdhUskCnqve7E5rY9D4y117SkzlBJ+hKv4/Zr6hCsXu4t+R0b3JV0yVcUKnAfKFQoane/i673ZkVf7HKRihw9qY61/CYJVUqcu99De5RED7oSMBVa44aPNF+gJCWKcTfUGfezl7ukwYoeMBXX7kAt8CpwM52IzoKEJ1QHFNWigSXN8IaCZR/emjCUm4ihASsMokFUAnBRZ1AB3UyEQAISP9Cyi2UQI6pxd6axAhAUfx5cYphF5AhEQAnbxilQF08GRaC9AxhIQAndvGdNZiL6DUBh68P4PQC4iQiJcnE5Jx8gVEWTmXkJCP8E/3VMgYNilA+FwITWkLkZQvH0BFZDG+HQ5naf43GoUEATVj926DO9kJNyExRwhAWd9jh5AmoBaE3wOE7v7UEl52uiFJP7oBGapAuoAaXv0koJzQC6gwlnTUR/TRwp8UxD31ESsNhbeegahBvw7IEzrk/U1NQPTRdBGH2lLwIbxr1pFUnZFGDfos7HvLrk1IpQbl7yyEW53XBKVlvgII3L3sNLuilMxXh/jmyX8NqZiv9j8voPSAenkbcQguVUiCATPyuxfqL+4pjvbCgIg00b/F00rSnmakqlJ8AT2qDPF6ASKLgOLtsui6ij/mAGXvEEfv9uVXxPyxprSuoKO+pOwBshHl8DLljJMpn0w5gwv8D42e+gRA9fmjhHUds0Pq/PKQTcZVrA4r/04IQcsqVufs6oRmZKzEuvyP0Vwqv2/VXkMRlr8f/ffz/p2IfFSyq/y+UzvteBJ/EVHBITTDTY7q2LwrCwonpTTqrexkaJOxtFmlzaxANOqG6BnPbYAiAuEigmi4v36CakKQtliBmA96OSF0PV+b1+UMyIbPdlj6r/NBq0+lQ0pG/z4DPkq0v7FtBQRxBeror+9doSGftxPaBQgbxZPpItoddRVYdrDfYO1T+FpNaBKamhxtFr8zn7JD3E1U09UQzZmd9JfKlzk7yCrBp7lV03IRcqPgtNtE1sz5pUH3ZCjLb6JtbWIJMjRPGNPuMeBub/Hf+X3f82Qj2oiV4hc+Dc/xI3U+kgCqZnrFFaljH7+W34Ym0ZmwdLnn2YH2khBKsLayL670GetWbzVATxQwu1L2RfQzvC5MWWj4ydsploMa1ZQlpkxtC1T7YPEvmjIhw35jUBN5P7plgT4Kz+TDszX4t7ZcwzwRmnI3Aa08POaF2xscACS1IFkBxOgiPCekK3xsnjAjnOL12ccJkdn10MyLWfOA+KOeyZIEqUR4X7RZDYtkBWJ3N1mzVcYzaUTTgHaPsZX+WhzRLCDYO4ttxGeFES0A2ic8UuQB1QJMe3yZurWbTwUNsvbYXp/mAMnwiSIrlS4aG/25l9ATd+SOhOTCEv7xt8YiVb3eTNxhA7RWlv/R/PkoQhj+5vJx+Abj/HCtGAGIw/Qn/oMLUi0PMgzCYHtZKaIE0H2Fw8bQ5YEEUgqETAGaNs0/LLcAMfTZtVjd1GMairCUhBi6IvThg/hczU7oz3qFPRrQHUBqAQrtbNpG57X0rhlA0O6lI0jTNkqT1Ahvho/blfSE6oA+jDrzrP4N7rAgGQZSrkTpysP98yHQ4tNLqFzPeKPPH/YB+bEpXmEQeAbqUG4u6sHIMHP0oc0YYxGy/oKsfcVLMggLtjgTvN9GrmahAjpOvxNQa+keEtUqSMDjmtzzaZb5hXbjNy1rc9iRgroWuLHyJFk3zu6F+hGQRDWrrCCQLjvKkBva+44NSM/u595YNGYSccV30b66BVhlPqHv9YWIMqqufzq65NL17ZsZ/YiKCzegWsbxD7jSSoabgZEaFPrx3d1zlP/gFBjmB/PRhFDI3+nLeEVkN119cHYobzqDX65dMPQ1vYhgMQKEfSajgGyEEita9G7gnGGjBlmuRDsOC4wD6nPDdE3rVnXpvg7oW4SebUOasuQoZkudq48XUHKtMdi9gPCrULvx9aqtdSp/v4D8dcCS/R6f3tMdUF76ETXKXITgKjGB754Z/Qv4XNBZH+TiUwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The following code demonstrates how to estimate MC using location
data from light-level geolocators and PinPoint-10 GPS tags.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">estMC</span>(<span class="at">isGL=</span>OVENdata<span class="sc">$</span>isGL, <span class="co"># Logical vector: light-level geolocator(T)/GPS(F)</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>         <span class="at">geoBias =</span> OVENdata<span class="sc">$</span>geo.bias, <span class="co"># Light-level geolocator location bias</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>         <span class="at">geoVCov =</span> OVENdata<span class="sc">$</span>geo.vcov, <span class="co">#Light-level geolocator covariance matrix</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>         <span class="at">targetDist =</span> OVENdata<span class="sc">$</span>targetDist, <span class="co"># Target location distance matrix</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>         <span class="at">originDist =</span> OVENdata<span class="sc">$</span>originDist, <span class="co"># Origin location distance matrix</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>         <span class="at">targetSites =</span> OVENdata<span class="sc">$</span>targetSites, <span class="co"># Non-breeding / target sites</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>         <span class="at">originSites =</span> OVENdata<span class="sc">$</span>originSites, <span class="co"># Breeding / origin sites </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>         <span class="at">targetNames =</span> OVENdata<span class="sc">$</span>targetNames, <span class="co"># Names of nonbreeding/target sites</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>         <span class="at">originNames =</span> OVENdata<span class="sc">$</span>originNames, <span class="co"># Names of breeding/origin sites</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>         <span class="at">originPoints =</span> OVENdata<span class="sc">$</span>originPoints, <span class="co"># Capture Locations </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>         <span class="at">targetPoints =</span> OVENdata<span class="sc">$</span>targetPoints, <span class="co"># Target locations from devices</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>         <span class="at">originRelAbund =</span> OVENdata<span class="sc">$</span>originRelAbund, <span class="co"># Origin relative abundances</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>         <span class="at">resampleProjection =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(OVENdata<span class="sc">$</span>targetPoints), </span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>         <span class="at">verbose =</span> <span class="dv">0</span>,   <span class="co"># output options - see help ??estMC</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>         <span class="at">nSamples =</span> <span class="dv">10</span>) <span class="co"># This is set low for example </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>M</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; Migratory Connectivity Estimates</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; Transition probability (psi) estimates (mean):</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt;        FL   Cuba   Hisp</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; NH 0.0000 0.1651 0.8349</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; MD 0.4784 0.5216 0.0000</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; +/- SE:</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt;        FL    Cuba    Hisp</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; NH 0.0000 0.06256 0.06256</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; MD 0.1757 0.17570 0.00000</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; 95% confidence interval (simple quantile):</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt;    FL               Cuba             Hisp            </span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; NH 0.00000 - 0.0000 0.07786 - 0.2333 0.76667 - 0.9221</span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">#&gt; MD 0.29643 - 0.7958 0.20417 - 0.7036 0.00000 - 0.0000</span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a><span class="co">#&gt; MC estimate (mean): 0.6661 +/- (SE) 0.09742 </span></span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a><span class="co">#&gt; 95% confidence interval (simple quantile): 0.5389 - 0.8446</span></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co">#&gt; This is a subset of what&#39;s available inside this estMigConnectivity output.</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="co">#&gt; For more info, try ?estTransition or str(obj_name, max.levels = 2).</span></span></code></pre></div>
<p>Take a closer look at what is included in the output</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">str</span>(M, <span class="at">max.level =</span> <span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt;  $ psi  :List of 7</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt;   ..$ sample  : num [1:10, 1:2, 1:3] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt;   ..$ mean    : num [1:2, 1:3] 0 0.478 0.165 0.522 0.835 ...</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt;   ..$ se      : num [1:2, 1:3] 0 0.1757 0.0626 0.1757 0.0626 ...</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt;   ..$ simpleCI: num [1:2, 1:2, 1:3] 0 0 0.2964 0.7958 0.0779 ...</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt;   ..$ bcCI    : num [1:2, 1:2, 1:3] 0 0 0.3333 0.8333 0.0741 ...</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt;   ..$ median  : num [1:2, 1:3] 0 0.431 0.165 0.569 0.835 ...</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt;   ..$ point   : num [1:2, 1:3] 0 0.4 0.174 0.6 0.826 ...</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt;  $ MC   :List of 10</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#&gt;   ..$ sample  : num [1:10] 0.566 0.656 0.717 0.688 0.531 ...</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co">#&gt;   ..$ mean    : num 0.666</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt;   ..$ se      : num 0.0974</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt;   ..$ simpleCI: num [1:2] 0.539 0.845</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co">#&gt;   ..$ bcCI    : num [1:2] 0.531 0.882</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="co">#&gt;   ..$ hpdCI   : num [1:2] 0.531 0.882</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a><span class="co">#&gt;   ..$ median  : num 0.664</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a><span class="co">#&gt;   ..$ point   : num 0.621</span></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a><span class="co">#&gt;   ..$ simpleP : NULL</span></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="co">#&gt;   ..$ bcP     : NULL</span></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a><span class="co">#&gt;  $ corr :List of 7</span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="co">#&gt;   ..$ sample  : logi [1:10] NA NA NA NA NA NA ...</span></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a><span class="co">#&gt;   ..$ mean    : NULL</span></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="co">#&gt;   ..$ se      : NULL</span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a><span class="co">#&gt;   ..$ simpleCI: NULL</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a><span class="co">#&gt;   ..$ bcCI    : NULL</span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="co">#&gt;   ..$ median  : NULL</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a><span class="co">#&gt;   ..$ point   : NULL</span></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a><span class="co">#&gt;  $ input:List of 26</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a><span class="co">#&gt;   ..$ originDist          : num [1:2, 1:2] 0 581231 581231 0</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a><span class="co">#&gt;   ..$ targetDist          : num [1:3, 1:3] 0 852312 1570037 852312 0 ...</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="co">#&gt;   ..$ originRelAbund      : num [1:2, 1] 0.623 0.377</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co">#&gt;   ..$ sampleSize          : int 39</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co">#&gt;   ..$ originSites         :Classes &#39;sf&#39; and &#39;data.frame&#39;:    2 obs. of  1 variable:</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: </span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;names&quot;)= chr(0) </span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">#&gt;   ..$ targetSites         :Classes &#39;sf&#39; and &#39;data.frame&#39;:    3 obs. of  1 variable:</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: </span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;names&quot;)= chr(0) </span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="co">#&gt;   ..$ originPoints        :Classes &#39;sf&#39; and &#39;data.frame&#39;:    39 obs. of  1 variable:</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;</span></span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: </span></span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;names&quot;)= chr(0) </span></span>
<span id="cb19-56"><a href="#cb19-56" tabindex="-1"></a><span class="co">#&gt;   ..$ targetPoints        :Classes &#39;sf&#39; and &#39;data.frame&#39;:    39 obs. of  1 variable:</span></span>
<span id="cb19-57"><a href="#cb19-57" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;</span></span>
<span id="cb19-58"><a href="#cb19-58" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: </span></span>
<span id="cb19-59"><a href="#cb19-59" tabindex="-1"></a><span class="co">#&gt;   .. .. ..- attr(*, &quot;names&quot;)= chr(0) </span></span>
<span id="cb19-60"><a href="#cb19-60" tabindex="-1"></a><span class="co">#&gt;   ..$ originAssignment    : int [1:39] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb19-61"><a href="#cb19-61" tabindex="-1"></a><span class="co">#&gt;   ..$ targetAssignment    : int [1:39] NA 3 3 3 NA 3 3 2 3 NA ...</span></span>
<span id="cb19-62"><a href="#cb19-62" tabindex="-1"></a><span class="co">#&gt;   ..$ originNames         : chr [1:2] &quot;NH&quot; &quot;MD&quot;</span></span>
<span id="cb19-63"><a href="#cb19-63" tabindex="-1"></a><span class="co">#&gt;   ..$ targetNames         : chr [1:3] &quot;FL&quot; &quot;Cuba&quot; &quot;Hisp&quot;</span></span>
<span id="cb19-64"><a href="#cb19-64" tabindex="-1"></a><span class="co">#&gt;   ..$ nSamples            : num 10</span></span>
<span id="cb19-65"><a href="#cb19-65" tabindex="-1"></a><span class="co">#&gt;   ..$ nSim                : num 1000</span></span>
<span id="cb19-66"><a href="#cb19-66" tabindex="-1"></a><span class="co">#&gt;   ..$ isGL                : logi [1:39] TRUE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span id="cb19-67"><a href="#cb19-67" tabindex="-1"></a><span class="co">#&gt;   ..$ geoBias             : num [1, 1:2] 2423 265432</span></span>
<span id="cb19-68"><a href="#cb19-68" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-69"><a href="#cb19-69" tabindex="-1"></a><span class="co">#&gt;   ..$ geoVCov             : num [1:2, 1:2] 5.08e+08 -1.64e+09 -1.64e+09 1.28e+10</span></span>
<span id="cb19-70"><a href="#cb19-70" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-71"><a href="#cb19-71" tabindex="-1"></a><span class="co">#&gt;   ..$ row0                : num 0</span></span>
<span id="cb19-72"><a href="#cb19-72" tabindex="-1"></a><span class="co">#&gt;   ..$ verbose             : num 0</span></span>
<span id="cb19-73"><a href="#cb19-73" tabindex="-1"></a><span class="co">#&gt;   ..$ calcCorr            : logi FALSE</span></span>
<span id="cb19-74"><a href="#cb19-74" tabindex="-1"></a><span class="co">#&gt;   ..$ alpha               : num 0.05</span></span>
<span id="cb19-75"><a href="#cb19-75" tabindex="-1"></a><span class="co">#&gt;   ..$ approxSigTest       : logi FALSE</span></span>
<span id="cb19-76"><a href="#cb19-76" tabindex="-1"></a><span class="co">#&gt;   ..$ sigConst            : num 0</span></span>
<span id="cb19-77"><a href="#cb19-77" tabindex="-1"></a><span class="co">#&gt;   ..$ resampleProjection  :List of 2</span></span>
<span id="cb19-78"><a href="#cb19-78" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;class&quot;)= chr &quot;crs&quot;</span></span>
<span id="cb19-79"><a href="#cb19-79" tabindex="-1"></a><span class="co">#&gt;   ..$ maxTries            : num 300</span></span>
<span id="cb19-80"><a href="#cb19-80" tabindex="-1"></a><span class="co">#&gt;   ..$ maintainLegacyOutput: logi FALSE</span></span>
<span id="cb19-81"><a href="#cb19-81" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr [1:3] &quot;estMC&quot; &quot;estPsi&quot; &quot;estMigConnectivity&quot;</span></span></code></pre></div>
</div>
<div id="example-3" class="section level3">
<h3>EXAMPLE 3</h3>
</div>
<div id="simmove-simulates-position-of-animals-by-individual-season-year-and-month" class="section level3">
<h3><code>simMove</code> Simulates position of animals by individual,
season, year, and month</h3>
<p>Calculate the strength of migratory connectivity based on simulation
data for 10 years of movement between breeding and non-breeding seasonal
ranges. Breeding and non-breeding ranges are equally divided into 100
regions on an ellipsoid globe. See above for details regarding the
utility functions.</p>
<p>Simulate data to demonstrate the use of <code>calcMC</code></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">75</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># Parameters for simulations</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>nSeasons <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># population with two discrete seasons - breeding / non-breeding</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>nYears <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Ten years of data</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>nMonths <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># Four months within each season</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>nBreeding <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of populations</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>nWintering <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of populations </span></span></code></pre></div>
<p>Generate the spatial arrangement of breeding and non-breeding
populations</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>breedingPos <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">99</span>,<span class="sc">-</span><span class="dv">81</span>,<span class="dv">2</span>), <span class="at">each=</span><span class="fu">sqrt</span>(nBreeding)),</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>                        <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">49</span>,<span class="dv">31</span>,<span class="sc">-</span><span class="dv">2</span>), <span class="fu">sqrt</span>(nBreeding))), nBreeding, <span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>winteringPos <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">79</span>,<span class="sc">-</span><span class="dv">61</span>,<span class="dv">2</span>), <span class="at">each=</span><span class="fu">sqrt</span>(nWintering)),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>                         <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">9</span>,<span class="sc">-</span><span class="dv">9</span>,<span class="sc">-</span><span class="dv">2</span>), <span class="fu">sqrt</span>(nWintering))), nWintering, <span class="dv">2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co"># calculate distance between populations</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>breedDist <span class="ot">&lt;-</span> <span class="fu">distFromPos</span>(breedingPos, <span class="st">&#39;ellipsoid&#39;</span>) </span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>nonbreedDist <span class="ot">&lt;-</span> <span class="fu">distFromPos</span>(winteringPos, <span class="st">&#39;ellipsoid&#39;</span>) </span></code></pre></div>
<p>The relative abundance of the study species is needed in each
population. Here we generate those data below.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Breeding Abundance</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>breedingN <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">500</span>, nBreeding)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>breedingRelN <span class="ot">&lt;-</span> breedingN<span class="sc">/</span><span class="fu">sum</span>(breedingN)</span></code></pre></div>
<p>The transition probability (psi) between the breeding and
non-breeding populations is calculated below.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Set up psi matrix</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">optimize</span>(mlogitMC, <span class="at">MC.in =</span> <span class="fl">0.25</span>, <span class="at">origin.dist =</span> breedDist,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>              <span class="at">target.dist =</span> nonbreedDist, <span class="at">origin.abund =</span> breedingRelN,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>              <span class="at">sample.size =</span> <span class="fu">sum</span>(breedingN),</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>              <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">tol =</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span>)<span class="co">#</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>slope <span class="ot">&lt;-</span> o<span class="sc">$</span>minimum</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">mlogitMat</span>(slope, breedDist)</span></code></pre></div>
<p>Now that we have all the data needed to calculate the strength of
migratory connectivity we can use the <code>calcMC</code> function in
the <code>MigConnecitivty</code> package to generate a standardized MC
metric.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Baseline strength of migratory connectivity</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>MC <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> breedDist, </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>             <span class="at">targetDist =</span> nonbreedDist,</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>             <span class="at">psi =</span> psi, </span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>             <span class="at">originRelAbund =</span> breedingRelN,</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>             <span class="at">sampleSize =</span> <span class="fu">sum</span>(breedingN))</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co"># Show Results</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>MC</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt; [1] 0.25</span></span></code></pre></div>
</div>
<div id="simmove-simulation-of-movement-between-breeding-and-non-breeding" class="section level3">
<h3><code>simMove</code> Simulation of movement between breeding and
non-breeding</h3>
<p>Recycle data generated for the calcMC function - see above</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">simMove</span>(<span class="at">breedingAbund =</span> breedingN, <span class="co"># Breeding relative abundance</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>               <span class="at">breedingDist =</span> breedDist,  <span class="co"># Breeding distance</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>               <span class="at">winteringDist =</span> nonbreedDist, <span class="co"># Non-breeding distance</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>               <span class="at">psi =</span> psi, <span class="co"># Transition probabilities</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>               <span class="at">nYears =</span> nYears, <span class="co"># Number of years</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>               <span class="at">nMonths =</span> nMonths, <span class="co"># Number of months</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>               <span class="at">winMoveRate =</span> <span class="dv">0</span>, <span class="co"># winter movement rate</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>               <span class="at">sumMoveRate =</span> <span class="dv">0</span>, <span class="co"># breeding movement rate</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>               <span class="at">winDispRate =</span> <span class="dv">0</span>, <span class="co"># winter dispersal rate</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>               <span class="at">sumDispRate =</span> <span class="dv">0</span>, <span class="co"># summer disperal rate</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>               <span class="at">natalDispRate =</span> <span class="dv">0</span>, <span class="co"># natal dispersal rate</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>               <span class="at">breedDispRate =</span> <span class="dv">0</span>, <span class="co"># breeding dispersal rate</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>               <span class="at">verbose =</span> <span class="dv">0</span>) <span class="co"># verbose output</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="fu">str</span>(sims)</span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt; List of 6</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt;  $ animalLoc   : int [1:50000, 1:2, 1:10, 1:4] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt;  $ natalDispMat: NULL</span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="co">#&gt;  $ breedDispMat: NULL</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="co">#&gt;  $ sumMoveMat  : NULL</span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a><span class="co">#&gt;  $ winDispMat  : NULL</span></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a><span class="co">#&gt;  $ winMoveMat  : NULL</span></span></code></pre></div>
</div>
</div>
<div id="additional-examples-scenarios" class="section level2">
<h2>Additional Examples / Scenarios</h2>
<div id="example-4" class="section level3">
<h3>EXAMPLE 4</h3>
<p>Calculate migratory connectivity for a range of input values</p>
<p>Cohen et al. (<em>2018</em>) used simulation to assess the influence
of the three data inputs needed to calculate MC, including:</p>
<ol style="list-style-type: decimal">
<li>matrix of transition probabilities from breeding regions to
non-breeding regions<br />
</li>
<li>matrices of distances between breeding regions and between
non-breeding regions<br />
</li>
<li>relative abundance among breeding regions.</li>
</ol>
<p>Input value simulations included transition probabilities from four
breeding to four non-breeding regions and relative abundance measured
among breeding regions.</p>
<p>There were eight transition probability scenarios:</p>
<ol style="list-style-type: decimal">
<li>Full Mix</li>
<li>Avoid One Site</li>
<li>Full Connectivity</li>
<li>Half Mix</li>
<li>Low</li>
<li>Medium</li>
<li>One Site Preference</li>
<li>Negative</li>
</ol>
<p>There were twelve spatial arrangement / distance scenarios:</p>
<ol style="list-style-type: decimal">
<li>Base distances, linear/ linear</li>
<li>Distance between breeding sites 2 and 3 doubled<br />
</li>
<li>Distance between breeding sites 2 and 3 halved<br />
</li>
<li>Distance between breeding sites 3 and 4 doubled<br />
</li>
<li>Distance between breeding sites 3 and 4 halved<br />
</li>
<li>Breeding sites on square grid/ winter linear</li>
<li>Distance between wintering sites 2 and 3 doubled<br />
</li>
<li>Distance between wintering sites 2 and 3 halved<br />
</li>
<li>Distance between wintering sites 3 and 4 doubled<br />
</li>
<li>Distance between wintering sites 3 and 4 halved<br />
</li>
<li>Breeding linear, Wintering sites on square grid<br />
</li>
<li>Wintering and breeding on square grid</li>
</ol>
<p>There were five relative breeding abundance scenarios:</p>
<ol style="list-style-type: decimal">
<li>Base, all equal<br />
</li>
<li>Abundance at site B doubled<br />
</li>
<li>Abundance at site B halved<br />
</li>
<li>Abundance at site D doubled<br />
</li>
<li>Abundance at site D halved</li>
</ol>
<p>First we calculate MC for the eight transition probability scenarios
(with base spatial arrangement and relative abundance):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>nScenarios1 <span class="ot">&lt;-</span> <span class="fu">length</span>(samplePsis) <span class="co"># samplePsis - comes with MigConnectivity package</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co"># Create vector of length nScenarios1</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nScenarios1)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co"># Loop through the different senarios outlined above #</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios1) {</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> sampleOriginDist[[<span class="dv">1</span>]],</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>                 <span class="at">targetDist =</span> sampleTargetDist[[<span class="dv">1</span>]],</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>                 <span class="at">psi =</span> samplePsis[[i]],</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>                 <span class="at">originRelAbund =</span> sampleOriginRelN[[<span class="dv">1</span>]])</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>}</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co"># Give meaningful names to the MC1 vector</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="fu">names</span>(MC1) <span class="ot">&lt;-</span> <span class="fu">names</span>(samplePsis)</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co"># Print results </span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="fu">round</span>(MC1, <span class="dv">6</span>)</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt;            Full Mix      Avoid One Site   Full Connectivity            Half Mix </span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt;            0.000000            0.000000            1.000000            0.600000 </span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt;                 Low              Medium One Site Preference            Negative </span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt;            0.196000            0.504000            0.164145           -0.066560</span></span></code></pre></div>
<p>Add the scenarios for the spatial arrangements that result in
different distances between regions:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>nScenarios2 <span class="ot">&lt;-</span> <span class="fu">length</span>(sampleOriginPos)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nScenarios1, nScenarios2)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="fu">rownames</span>(MC2) <span class="ot">&lt;-</span> <span class="fu">names</span>(samplePsis)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="fu">colnames</span>(MC2) <span class="ot">&lt;-</span> <span class="fu">names</span>(sampleOriginPos)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios1) {</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios2) {</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>    MC2[i, j] <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> sampleOriginDist[[j]],</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>                      <span class="at">targetDist =</span> sampleTargetDist[[j]],</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>                      <span class="at">psi =</span> samplePsis[[i]],</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>                      <span class="at">originRelAbund =</span> sampleOriginRelN[[<span class="dv">1</span>]])</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  }</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>}</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="co"># Print results #</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">round</span>(MC2, <span class="dv">4</span>))</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co">#&gt;              Full Mix Avoid One Site Full Connectivity Half Mix    Low Medium</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="co">#&gt; Linear              0              0            1.0000   0.6000 0.1960 0.5040</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt; B Dist BC*2         0              0            0.9739   0.6956 0.1818 0.4879</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="co">#&gt; B Dist BC/2         0              0            0.9798   0.4899 0.2000 0.4964</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="co">#&gt; B Dist CD*2         0              0            0.9558   0.5147 0.1912 0.4784</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co">#&gt; B Dist CD/2         0              0            0.9734   0.6299 0.1878 0.4932</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co">#&gt; B Grid              0              0            0.7734   0.5256 0.1277 0.3601</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="co">#&gt; NB Dist 23*2        0              0            0.9739   0.6956 0.1818 0.4879</span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="co">#&gt; NB Dist 23/2        0              0            0.9798   0.4899 0.2000 0.4964</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co">#&gt; NB Dist 34*2        0              0            0.9558   0.5147 0.1931 0.4882</span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="co">#&gt; NB Dist 34/2        0              0            0.9734   0.6299 0.1863 0.4856</span></span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a><span class="co">#&gt; NB Grid             0              0            0.7734   0.5256 0.1277 0.3601</span></span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a><span class="co">#&gt; B/NB Grid           0              0            1.0000   0.4605 0.1638 0.4340</span></span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a><span class="co">#&gt;              One Site Preference Negative</span></span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a><span class="co">#&gt; Linear                    0.1641  -0.0666</span></span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a><span class="co">#&gt; B Dist BC*2               0.1514  -0.0463</span></span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a><span class="co">#&gt; B Dist BC/2               0.1683  -0.0815</span></span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a><span class="co">#&gt; B Dist CD*2               0.1838  -0.0734</span></span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a><span class="co">#&gt; B Dist CD/2               0.1388  -0.0572</span></span>
<span id="cb27-39"><a href="#cb27-39" tabindex="-1"></a><span class="co">#&gt; B Grid                    0.1695   0.0669</span></span>
<span id="cb27-40"><a href="#cb27-40" tabindex="-1"></a><span class="co">#&gt; NB Dist 23*2              0.1428  -0.0463</span></span>
<span id="cb27-41"><a href="#cb27-41" tabindex="-1"></a><span class="co">#&gt; NB Dist 23/2              0.1781  -0.0815</span></span>
<span id="cb27-42"><a href="#cb27-42" tabindex="-1"></a><span class="co">#&gt; NB Dist 34*2              0.2163  -0.0734</span></span>
<span id="cb27-43"><a href="#cb27-43" tabindex="-1"></a><span class="co">#&gt; NB Dist 34/2              0.1149  -0.0572</span></span>
<span id="cb27-44"><a href="#cb27-44" tabindex="-1"></a><span class="co">#&gt; NB Grid                   0.1263   0.0669</span></span>
<span id="cb27-45"><a href="#cb27-45" tabindex="-1"></a><span class="co">#&gt; B/NB Grid                 0.1603   0.0728</span></span></code></pre></div>
<p>Another way of comparing results:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>MC.diff2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(MC2, <span class="dv">2</span>, <span class="st">&quot;-&quot;</span>, MC2[ , <span class="dv">1</span>])</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">round</span>(MC.diff2, <span class="dv">4</span>))</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co">#&gt;              Full Mix Avoid One Site Full Connectivity Half Mix     Low  Medium</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt; Linear              0              0            0.0000   0.0000  0.0000  0.0000</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; B Dist BC*2         0              0           -0.0261   0.0956 -0.0142 -0.0161</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt; B Dist BC/2         0              0           -0.0202  -0.1101  0.0040 -0.0076</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt; B Dist CD*2         0              0           -0.0442  -0.0853 -0.0048 -0.0256</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; B Dist CD/2         0              0           -0.0266   0.0299 -0.0082 -0.0108</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; B Grid              0              0           -0.2266  -0.0744 -0.0683 -0.1439</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; NB Dist 23*2        0              0           -0.0261   0.0956 -0.0142 -0.0161</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt; NB Dist 23/2        0              0           -0.0202  -0.1101  0.0040 -0.0076</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co">#&gt; NB Dist 34*2        0              0           -0.0442  -0.0853 -0.0029 -0.0158</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="co">#&gt; NB Dist 34/2        0              0           -0.0266   0.0299 -0.0097 -0.0184</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="co">#&gt; NB Grid             0              0           -0.2266  -0.0744 -0.0683 -0.1439</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="co">#&gt; B/NB Grid           0              0            0.0000  -0.1395 -0.0322 -0.0700</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="co">#&gt;              One Site Preference Negative</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="co">#&gt; Linear                    0.0000   0.0000</span></span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="co">#&gt; B Dist BC*2              -0.0128   0.0203</span></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="co">#&gt; B Dist BC/2               0.0042  -0.0150</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a><span class="co">#&gt; B Dist CD*2               0.0197  -0.0068</span></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a><span class="co">#&gt; B Dist CD/2              -0.0253   0.0094</span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a><span class="co">#&gt; B Grid                    0.0054   0.1334</span></span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a><span class="co">#&gt; NB Dist 23*2             -0.0213   0.0203</span></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a><span class="co">#&gt; NB Dist 23/2              0.0139  -0.0150</span></span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a><span class="co">#&gt; NB Dist 34*2              0.0521  -0.0068</span></span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a><span class="co">#&gt; NB Dist 34/2             -0.0493   0.0094</span></span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a><span class="co">#&gt; NB Grid                  -0.0378   0.1334</span></span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a><span class="co">#&gt; B/NB Grid                -0.0038   0.1394</span></span></code></pre></div>
</div>
<div id="add-the-relative-abundance-breeding-scenarios" class="section level3">
<h3>Add the relative abundance breeding scenarios</h3>
<p>Calculate MC across abundance and transition probability scenarios
for breeding linear / winter linear arrangment:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>nScenarios3 <span class="ot">&lt;-</span> <span class="fu">length</span>(sampleOriginRelN)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nScenarios1, nScenarios3)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">rownames</span>(MC3) <span class="ot">&lt;-</span> <span class="fu">names</span>(samplePsis)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="fu">colnames</span>(MC3) <span class="ot">&lt;-</span> <span class="fu">names</span>(sampleOriginRelN)</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios1) {</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span>) {</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios3) {</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>MC3[i, k] <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> sampleOriginDist[[j]],</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>                    <span class="at">targetDist =</span> sampleTargetDist[[j]], </span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>                    <span class="at">psi =</span> samplePsis[[i]],</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>                    <span class="at">originRelAbund =</span> sampleOriginRelN[[k]])</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>}</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>}</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>}</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">round</span>(MC3, <span class="dv">4</span>)) <span class="co"># linear arrangement</span></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a><span class="co">#&gt;        Full Mix Avoid One Site Full Connectivity Half Mix    Low Medium</span></span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a><span class="co">#&gt; Base          0              0                 1   0.6000 0.1960 0.5040</span></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a><span class="co">#&gt; B Doub        0              0                 1   0.5856 0.2060 0.5173</span></span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a><span class="co">#&gt; B Half        0              0                 1   0.6323 0.1942 0.5027</span></span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a><span class="co">#&gt; D Doub        0              0                 1   0.6360 0.1663 0.4608</span></span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a><span class="co">#&gt; D Half        0              0                 1   0.5807 0.2062 0.5235</span></span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a><span class="co">#&gt;        One Site Preference Negative</span></span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a><span class="co">#&gt; Base                0.1641  -0.0666</span></span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a><span class="co">#&gt; B Doub              0.1338  -0.0650</span></span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a><span class="co">#&gt; B Half              0.1847  -0.0660</span></span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a><span class="co">#&gt; D Doub              0.2992  -0.0219</span></span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a><span class="co">#&gt; D Half              0.0886  -0.0399</span></span></code></pre></div>
<p>Calculate MC across abundance and transition probability scenarios
for breeding grid/ winter grid arrangement:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>MC4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nScenarios1, nScenarios3)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">rownames</span>(MC4) <span class="ot">&lt;-</span> <span class="fu">names</span>(samplePsis)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="fu">colnames</span>(MC4) <span class="ot">&lt;-</span> <span class="fu">names</span>(sampleOriginRelN)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios1) {</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> nScenarios2) {</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios3) {</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>MC4[i, k] <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> sampleOriginDist[[j]],</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>                    <span class="at">targetDist =</span> sampleTargetDist[[j]],</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>                    <span class="at">psi =</span> samplePsis[[i]],</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>                    <span class="at">originRelAbund =</span> sampleOriginRelN[[k]])</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>}</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>}</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>}</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">round</span>(MC4, <span class="dv">4</span>)) <span class="co"># grid arrangement</span></span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a><span class="co">#&gt;        Full Mix Avoid One Site Full Connectivity Half Mix    Low Medium</span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a><span class="co">#&gt; Base          0              0                 1   0.4605 0.1638 0.4340</span></span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a><span class="co">#&gt; B Doub        0              0                 1   0.4668 0.1614 0.4293</span></span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a><span class="co">#&gt; B Half        0              0                 1   0.4639 0.1699 0.4445</span></span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a><span class="co">#&gt; D Doub        0              0                 1   0.4668 0.1614 0.4293</span></span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a><span class="co">#&gt; D Half        0              0                 1   0.4639 0.1699 0.4445</span></span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a><span class="co">#&gt;        One Site Preference Negative</span></span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a><span class="co">#&gt; Base                0.1603   0.0728</span></span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a><span class="co">#&gt; B Doub              0.0970   0.0822</span></span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a><span class="co">#&gt; B Half              0.1996   0.0778</span></span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a><span class="co">#&gt; D Doub              0.3649   0.0822</span></span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a><span class="co">#&gt; D Half              0.0519   0.0778</span></span></code></pre></div>
<p>Calculate MC across abundance and transition probability scenarios
for for breeding grid, winter linear arrangement</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>MC5 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nScenarios1, nScenarios3)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="fu">rownames</span>(MC5) <span class="ot">&lt;-</span> <span class="fu">names</span>(samplePsis)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="fu">colnames</span>(MC5) <span class="ot">&lt;-</span> <span class="fu">names</span>(sampleOriginRelN)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios1) {</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">6</span>) {</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios3) {</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>MC5[i, k] <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> sampleOriginDist[[j]],</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>                    <span class="at">targetDist =</span> sampleTargetDist[[j]], </span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>                    <span class="at">psi =</span> samplePsis[[i]], </span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>                    <span class="at">originRelAbund =</span> sampleOriginRelN[[k]])</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>}</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>}</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>}</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">round</span>(MC5, <span class="dv">4</span>)) <span class="co"># breeding grid, winter linear arrangement</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="co">#&gt;        Full Mix Avoid One Site Full Connectivity Half Mix    Low Medium</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a><span class="co">#&gt; Base          0              0            0.7734   0.5256 0.1277 0.3601</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="co">#&gt; B Doub        0              0            0.7538   0.5384 0.1380 0.3677</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a><span class="co">#&gt; B Half        0              0            0.8229   0.5323 0.1385 0.3861</span></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a><span class="co">#&gt; D Doub        0              0            0.8290   0.5384 0.1096 0.3456</span></span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a><span class="co">#&gt; D Half        0              0            0.7447   0.5323 0.1313 0.3629</span></span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a><span class="co">#&gt;        One Site Preference Negative</span></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a><span class="co">#&gt; Base                0.1695   0.0669</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a><span class="co">#&gt; B Doub              0.1140   0.0277</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a><span class="co">#&gt; B Half              0.2102   0.0801</span></span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a><span class="co">#&gt; D Doub              0.3419   0.1334</span></span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a><span class="co">#&gt; D Half              0.0737   0.0647</span></span></code></pre></div>
<p>###EXAMPLES 5-12 (from sampling regime simulations in Cohen et
al. 2018)</p>
<p>Simulation was used to assess the influence of biased or incomplete
sampling on the measurement of MC. Below, we measure the influence of
several potential sources of sampling error:</p>
<ol style="list-style-type: decimal">
<li>Incorrect grouping of seasonal ranges into regions</li>
<li>Sampling not proportional to abundance</li>
<li>Migratory connectivity strength varies across a range</li>
<li>Low sample size</li>
<li>Uncertainty in assignments to regions from tracking data</li>
<li>Uncertainty in estimates of abundance</li>
<li>Heterogeneity in detection among regions from mark re-encounter
data</li>
</ol>
<p>We also demonstrate how to propagate sampling uncertainty into
measurement of MC using a combination of parametric and non-parametric
bootstrapping. For most simulations, we compare MC to the results of a
distance-based correlation coefficient (Mantel correlation; rM) that
does not incorporate relative abundance but has been used as a measure
of migratory connectivity.</p>
<p>###EXAMPLE 5</p>
<p>Sampling regime 1 of 3</p>
<p>Researchers divide populations differently than reality Delineation
of seasonal ranges into regions</p>
<ol style="list-style-type: upper-roman">
<li>Breeding range divided along equal longitudinal breaks into ten
regions</li>
<li>Non-breeding range divided along equal longitudinal breaks into ten
regions</li>
<li>Breeding and non-breeding ranges divided along equal longitudinal
breaks into ten regions</li>
<li>Breeding range divided along the longitudinal and latitudinal
midpoint into four regions</li>
<li>Non-breeding range divided along the longitudinal and latitudinal
midpoint into four regions</li>
<li>Breeding range divided along the longitudinal and latitudinal
midpoint into four regions and non-breeding range divided along equal
longitudinal breaks into ten regions</li>
<li>Breeding range divided along equal longitudinal breaks into ten
regions and non-breeding range divided along the longitudinal and
latitudinal midpoint into four regions</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co">#Run functions and parameters above first</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">75</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>scenarios14 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Base&quot;</span>, </span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>                 <span class="st">&quot;Breeding10&quot;</span>,</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>                 <span class="st">&quot;Wintering10&quot;</span>,</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>                 <span class="st">&quot;Breeding10Wintering10&quot;</span>,</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>                 <span class="st">&quot;Breeding4&quot;</span>,</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>                 <span class="st">&quot;Wintering4&quot;</span>,</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>                 <span class="st">&quot;Breeding4Wintering10&quot;</span>,</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>                 <span class="st">&quot;Breeding10Wintering4&quot;</span>,</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>                 <span class="st">&quot;Breeding4Wintering4&quot;</span>,</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>                 <span class="st">&quot;CentroidSampleBreeding10&quot;</span>,</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>                 <span class="st">&quot;CentroidSampleBreeding10Wintering10&quot;</span>,</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>                 <span class="st">&quot;CentroidSampleBreeding10Wintering4&quot;</span>,</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>                 <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>                 <span class="st">&quot;CentroidSampleBreeding4Wintering10&quot;</span>,</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>                 <span class="st">&quot;CentroidSampleBreeding4Wintering4&quot;</span>)</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a><span class="co"># Each element is for a scenario (see above 1-8), transferring from natural </span></span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a><span class="co"># breeding populations to defined ones</span></span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>breedingSiteTrans14 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nBreeding, </span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>), </span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>                           <span class="dv">1</span><span class="sc">:</span>nBreeding, </span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>), </span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>                           <span class="dv">1</span><span class="sc">:</span>nBreeding, </span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>),</span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>), </span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>), </span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>),</span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))</span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a><span class="co"># Same for non-breeding populations</span></span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a>winteringSiteTrans14 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nWintering,</span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a>                             <span class="dv">1</span><span class="sc">:</span>nWintering,</span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>),</span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>),</span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a>                             <span class="dv">1</span><span class="sc">:</span>nWintering,</span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>),</span>
<span id="cb32-46"><a href="#cb32-46" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-47"><a href="#cb32-47" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-48"><a href="#cb32-48" tabindex="-1"></a>                             <span class="dv">1</span><span class="sc">:</span>nWintering,</span>
<span id="cb32-49"><a href="#cb32-49" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>),</span>
<span id="cb32-50"><a href="#cb32-50" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb32-51"><a href="#cb32-51" tabindex="-1"></a>                             <span class="dv">1</span><span class="sc">:</span>nWintering,</span>
<span id="cb32-52"><a href="#cb32-52" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>),</span>
<span id="cb32-53"><a href="#cb32-53" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))</span>
<span id="cb32-54"><a href="#cb32-54" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" tabindex="-1"></a><span class="co"># Examine the transfers in matrix form</span></span>
<span id="cb32-56"><a href="#cb32-56" tabindex="-1"></a><span class="co">#lapply(breedingSiteTrans14, matrix, nrow=10, ncol=10)</span></span>
<span id="cb32-57"><a href="#cb32-57" tabindex="-1"></a><span class="co">#lapply(winteringSiteTrans14, matrix, nrow=10, ncol=10)</span></span>
<span id="cb32-58"><a href="#cb32-58" tabindex="-1"></a></span>
<span id="cb32-59"><a href="#cb32-59" tabindex="-1"></a><span class="co">#positions of the human defined populations</span></span>
<span id="cb32-60"><a href="#cb32-60" tabindex="-1"></a>breedingPos14 <span class="ot">&lt;-</span> <span class="fu">list</span>(breedingPos,</span>
<span id="cb32-61"><a href="#cb32-61" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-62"><a href="#cb32-62" tabindex="-1"></a>                      breedingPos,</span>
<span id="cb32-63"><a href="#cb32-63" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-64"><a href="#cb32-64" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-65"><a href="#cb32-65" tabindex="-1"></a>                                            <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-66"><a href="#cb32-66" tabindex="-1"></a>                      breedingPos, </span>
<span id="cb32-67"><a href="#cb32-67" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-68"><a href="#cb32-68" tabindex="-1"></a>                                            <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-69"><a href="#cb32-69" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-70"><a href="#cb32-70" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-71"><a href="#cb32-71" tabindex="-1"></a>                                            <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-72"><a href="#cb32-72" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-73"><a href="#cb32-73" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-74"><a href="#cb32-74" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-75"><a href="#cb32-75" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-76"><a href="#cb32-76" tabindex="-1"></a>                                            <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-77"><a href="#cb32-77" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-78"><a href="#cb32-78" tabindex="-1"></a>                                            <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-79"><a href="#cb32-79" tabindex="-1"></a>                      <span class="fu">rowsum</span>(breedingPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-80"><a href="#cb32-80" tabindex="-1"></a>                                            <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>)</span>
<span id="cb32-81"><a href="#cb32-81" tabindex="-1"></a></span>
<span id="cb32-82"><a href="#cb32-82" tabindex="-1"></a>winteringPos14 <span class="ot">&lt;-</span> <span class="fu">list</span>(winteringPos,</span>
<span id="cb32-83"><a href="#cb32-83" tabindex="-1"></a>                       winteringPos,</span>
<span id="cb32-84"><a href="#cb32-84" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-85"><a href="#cb32-85" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-86"><a href="#cb32-86" tabindex="-1"></a>                       winteringPos, </span>
<span id="cb32-87"><a href="#cb32-87" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-88"><a href="#cb32-88" tabindex="-1"></a>                                              <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-89"><a href="#cb32-89" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos,<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-90"><a href="#cb32-90" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-91"><a href="#cb32-91" tabindex="-1"></a>                                              <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-92"><a href="#cb32-92" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-93"><a href="#cb32-93" tabindex="-1"></a>                                              <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-94"><a href="#cb32-94" tabindex="-1"></a>                       winteringPos,</span>
<span id="cb32-95"><a href="#cb32-95" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-96"><a href="#cb32-96" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-97"><a href="#cb32-97" tabindex="-1"></a>                                              <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>,</span>
<span id="cb32-98"><a href="#cb32-98" tabindex="-1"></a>                       winteringPos,</span>
<span id="cb32-99"><a href="#cb32-99" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each=</span><span class="dv">10</span>))<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb32-100"><a href="#cb32-100" tabindex="-1"></a>                       <span class="fu">rowsum</span>(winteringPos, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb32-101"><a href="#cb32-101" tabindex="-1"></a>                                              <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))<span class="sc">/</span><span class="dv">25</span>)</span>
<span id="cb32-102"><a href="#cb32-102" tabindex="-1"></a></span>
<span id="cb32-103"><a href="#cb32-103" tabindex="-1"></a></span>
<span id="cb32-104"><a href="#cb32-104" tabindex="-1"></a><span class="co"># Calculate distances between defined breeding populations</span></span>
<span id="cb32-105"><a href="#cb32-105" tabindex="-1"></a>breedDist14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingPos14, distFromPos, <span class="at">surface =</span> <span class="st">&#39;ellipsoid&#39;</span>)</span>
<span id="cb32-106"><a href="#cb32-106" tabindex="-1"></a></span>
<span id="cb32-107"><a href="#cb32-107" tabindex="-1"></a><span class="co"># Calculate distances between defined non-breeding populations</span></span>
<span id="cb32-108"><a href="#cb32-108" tabindex="-1"></a>nonbreedDist14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(winteringPos14, distFromPos, <span class="at">surface =</span> <span class="st">&#39;ellipsoid&#39;</span>)</span>
<span id="cb32-109"><a href="#cb32-109" tabindex="-1"></a></span>
<span id="cb32-110"><a href="#cb32-110" tabindex="-1"></a><span class="co"># Numbers of defined populations</span></span>
<span id="cb32-111"><a href="#cb32-111" tabindex="-1"></a>nBreeding14 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb32-112"><a href="#cb32-112" tabindex="-1"></a></span>
<span id="cb32-113"><a href="#cb32-113" tabindex="-1"></a>nWintering14 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">4</span>)</span>
<span id="cb32-114"><a href="#cb32-114" tabindex="-1"></a></span>
<span id="cb32-115"><a href="#cb32-115" tabindex="-1"></a><span class="co"># Relative abundance by scenario and breeding population</span></span>
<span id="cb32-116"><a href="#cb32-116" tabindex="-1"></a>breedingRelN14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(nBreeding14, <span class="cf">function</span>(x) <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>x, x))</span>
<span id="cb32-117"><a href="#cb32-117" tabindex="-1"></a></span>
<span id="cb32-118"><a href="#cb32-118" tabindex="-1"></a>MC14 <span class="ot">&lt;-</span> <span class="fl">0.25</span> <span class="co"># Same for all scenarios in this set</span></span>
<span id="cb32-119"><a href="#cb32-119" tabindex="-1"></a></span>
<span id="cb32-120"><a href="#cb32-120" tabindex="-1"></a>nSample14 <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Total number sampled per simulation</span></span>
<span id="cb32-121"><a href="#cb32-121" tabindex="-1"></a></span>
<span id="cb32-122"><a href="#cb32-122" tabindex="-1"></a><span class="co"># How many sampled from each natural population (sampling scenarios separate </span></span>
<span id="cb32-123"><a href="#cb32-123" tabindex="-1"></a><span class="co"># from definition scenarios)</span></span>
<span id="cb32-124"><a href="#cb32-124" tabindex="-1"></a></span>
<span id="cb32-125"><a href="#cb32-125" tabindex="-1"></a>sampleBreeding14 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">round</span>(breedingRelN14[[<span class="dv">1</span>]]<span class="sc">*</span>nSample14),</span>
<span id="cb32-126"><a href="#cb32-126" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample14),</span>
<span id="cb32-127"><a href="#cb32-127" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">2</span>]<span class="sc">*</span>nSample14),</span>
<span id="cb32-128"><a href="#cb32-128" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">3</span>]<span class="sc">*</span>nSample14),</span>
<span id="cb32-129"><a href="#cb32-129" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">4</span>]<span class="sc">*</span>nSample14),</span>
<span id="cb32-130"><a href="#cb32-130" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>)),</span>
<span id="cb32-131"><a href="#cb32-131" tabindex="-1"></a>                         <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), </span>
<span id="cb32-132"><a href="#cb32-132" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="fu">round</span>(breedingRelN14[[<span class="dv">2</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample14<span class="sc">/</span><span class="dv">2</span>), <span class="dv">2</span>),</span>
<span id="cb32-133"><a href="#cb32-133" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="dv">10</span>))</span>
<span id="cb32-134"><a href="#cb32-134" tabindex="-1"></a></span>
<span id="cb32-135"><a href="#cb32-135" tabindex="-1"></a><span class="co"># for the baseline use the simulation from above, sims</span></span>
<span id="cb32-136"><a href="#cb32-136" tabindex="-1"></a></span>
<span id="cb32-137"><a href="#cb32-137" tabindex="-1"></a>animalLoc14base <span class="ot">&lt;-</span> sims<span class="sc">$</span>animalLoc</span>
<span id="cb32-138"><a href="#cb32-138" tabindex="-1"></a></span>
<span id="cb32-139"><a href="#cb32-139" tabindex="-1"></a></span>
<span id="cb32-140"><a href="#cb32-140" tabindex="-1"></a><span class="co"># Number of scenarios and number of simulations to run</span></span>
<span id="cb32-141"><a href="#cb32-141" tabindex="-1"></a>nScenarios14 <span class="ot">&lt;-</span> <span class="fu">length</span>(breedingSiteTrans14)</span>
<span id="cb32-142"><a href="#cb32-142" tabindex="-1"></a>nSims14 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb32-143"><a href="#cb32-143" tabindex="-1"></a></span>
<span id="cb32-144"><a href="#cb32-144" tabindex="-1"></a><span class="co"># Connections between scenarios and sampling regimes</span></span>
<span id="cb32-145"><a href="#cb32-145" tabindex="-1"></a>scenarioToSampleMap14 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>), <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb32-146"><a href="#cb32-146" tabindex="-1"></a></span>
<span id="cb32-147"><a href="#cb32-147" tabindex="-1"></a><span class="co"># Set up data structures for storing results</span></span>
<span id="cb32-148"><a href="#cb32-148" tabindex="-1"></a>animalLoc14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14) <span class="co">#making an empty list to fill</span></span>
<span id="cb32-149"><a href="#cb32-149" tabindex="-1"></a></span>
<span id="cb32-150"><a href="#cb32-150" tabindex="-1"></a>compare14 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Scenario =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>, scenarios14),</span>
<span id="cb32-151"><a href="#cb32-151" tabindex="-1"></a>                        <span class="at">MC =</span> <span class="fu">c</span>(MC14, <span class="fu">rep</span>(<span class="cn">NA</span>, nScenarios14)), </span>
<span id="cb32-152"><a href="#cb32-152" tabindex="-1"></a>                        <span class="at">Mantel =</span> <span class="fu">c</span>(MC14, <span class="fu">rep</span>(<span class="cn">NA</span>, nScenarios14)))</span>
<span id="cb32-153"><a href="#cb32-153" tabindex="-1"></a></span>
<span id="cb32-154"><a href="#cb32-154" tabindex="-1"></a>compare14.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims14, nScenarios14, <span class="dv">2</span>), <span class="at">dimnames =</span> </span>
<span id="cb32-155"><a href="#cb32-155" tabindex="-1"></a>                           <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims14,</span>
<span id="cb32-156"><a href="#cb32-156" tabindex="-1"></a>                           scenarios14,</span>
<span id="cb32-157"><a href="#cb32-157" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb32-158"><a href="#cb32-158" tabindex="-1"></a></span>
<span id="cb32-159"><a href="#cb32-159" tabindex="-1"></a>results14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14)</span>
<span id="cb32-160"><a href="#cb32-160" tabindex="-1"></a></span>
<span id="cb32-161"><a href="#cb32-161" tabindex="-1"></a><span class="co"># Run simulations</span></span>
<span id="cb32-162"><a href="#cb32-162" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSims14) {</span>
<span id="cb32-163"><a href="#cb32-163" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims14, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb32-164"><a href="#cb32-164" tabindex="-1"></a>  sim14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sampleBreeding14, </span>
<span id="cb32-165"><a href="#cb32-165" tabindex="-1"></a>                  simMove, </span>
<span id="cb32-166"><a href="#cb32-166" tabindex="-1"></a>                  <span class="at">breedingDist =</span> breedDist14[[<span class="dv">1</span>]],</span>
<span id="cb32-167"><a href="#cb32-167" tabindex="-1"></a>                  <span class="at">winteringDist=</span>nonbreedDist14[[<span class="dv">1</span>]], </span>
<span id="cb32-168"><a href="#cb32-168" tabindex="-1"></a>                  <span class="at">psi=</span>psi, </span>
<span id="cb32-169"><a href="#cb32-169" tabindex="-1"></a>                  <span class="at">nYears=</span>nYears,</span>
<span id="cb32-170"><a href="#cb32-170" tabindex="-1"></a>                  <span class="at">nMonths=</span>nMonths)</span>
<span id="cb32-171"><a href="#cb32-171" tabindex="-1"></a>  </span>
<span id="cb32-172"><a href="#cb32-172" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios14) {</span>
<span id="cb32-173"><a href="#cb32-173" tabindex="-1"></a>   <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\t</span><span class="st">Scenario&quot;</span>, i, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb32-174"><a href="#cb32-174" tabindex="-1"></a>   animalLoc14[[i]]<span class="ot">&lt;-</span><span class="fu">changeLocations</span>(</span>
<span id="cb32-175"><a href="#cb32-175" tabindex="-1"></a>     sim14[[scenarioToSampleMap14[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb32-176"><a href="#cb32-176" tabindex="-1"></a>                                     breedingSiteTrans14[[i]], </span>
<span id="cb32-177"><a href="#cb32-177" tabindex="-1"></a>                                     winteringSiteTrans14[[i]])</span>
<span id="cb32-178"><a href="#cb32-178" tabindex="-1"></a>      </span>
<span id="cb32-179"><a href="#cb32-179" tabindex="-1"></a>   results14[[i]] <span class="ot">&lt;-</span> <span class="fu">calcPsiMC</span>(breedDist14[[i]], nonbreedDist14[[i]],</span>
<span id="cb32-180"><a href="#cb32-180" tabindex="-1"></a>                               animalLoc14[[i]], </span>
<span id="cb32-181"><a href="#cb32-181" tabindex="-1"></a>                               <span class="at">originRelAbund =</span> breedingRelN14[[i]], </span>
<span id="cb32-182"><a href="#cb32-182" tabindex="-1"></a>                               <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-183"><a href="#cb32-183" tabindex="-1"></a>      </span>
<span id="cb32-184"><a href="#cb32-184" tabindex="-1"></a>   compare14.array[sim, i, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results14[[i]]<span class="sc">$</span>MC</span>
<span id="cb32-185"><a href="#cb32-185" tabindex="-1"></a>      </span>
<span id="cb32-186"><a href="#cb32-186" tabindex="-1"></a>   compare14.array[sim,i,<span class="st">&#39;Mantel&#39;</span>]<span class="ot">&lt;-</span><span class="fu">calcStrengthInd</span>(breedDist14[[<span class="dv">1</span>]],</span>
<span id="cb32-187"><a href="#cb32-187" tabindex="-1"></a>                                                    nonbreedDist14[[<span class="dv">1</span>]],</span>
<span id="cb32-188"><a href="#cb32-188" tabindex="-1"></a>                                   sim14[[scenarioToSampleMap14[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb32-189"><a href="#cb32-189" tabindex="-1"></a>                                                    <span class="at">resamp=</span><span class="dv">0</span>)<span class="sc">$</span>correlation</span>
<span id="cb32-190"><a href="#cb32-190" tabindex="-1"></a>  }</span>
<span id="cb32-191"><a href="#cb32-191" tabindex="-1"></a>}</span>
<span id="cb32-192"><a href="#cb32-192" tabindex="-1"></a></span>
<span id="cb32-193"><a href="#cb32-193" tabindex="-1"></a><span class="co"># Compute means for each scenario</span></span>
<span id="cb32-194"><a href="#cb32-194" tabindex="-1"></a>compare14<span class="sc">$</span>MC[<span class="dv">1</span><span class="sc">:</span>nScenarios14 <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.array[,,<span class="st">&#39;MC&#39;</span>], <span class="dv">2</span>, mean)</span>
<span id="cb32-195"><a href="#cb32-195" tabindex="-1"></a>compare14<span class="sc">$</span>Mantel[<span class="dv">1</span><span class="sc">:</span>nScenarios14 <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.array[,,<span class="st">&#39;Mantel&#39;</span>], <span class="dv">2</span>, </span>
<span id="cb32-196"><a href="#cb32-196" tabindex="-1"></a>                                              mean)</span>
<span id="cb32-197"><a href="#cb32-197" tabindex="-1"></a></span>
<span id="cb32-198"><a href="#cb32-198" tabindex="-1"></a>compare14 <span class="ot">&lt;-</span> <span class="fu">transform</span>(compare14, <span class="at">MC.diff=</span>MC <span class="sc">-</span> MC[<span class="dv">1</span>], </span>
<span id="cb32-199"><a href="#cb32-199" tabindex="-1"></a>                       <span class="at">Mantel.diff=</span>Mantel <span class="sc">-</span> Mantel[<span class="dv">1</span>])</span>
<span id="cb32-200"><a href="#cb32-200" tabindex="-1"></a>compare14</span></code></pre></div>
<p>###EXAMPLE 6</p>
<p>Sampling regime 2 of 3</p>
<p>Researchers divide populations differently than reality PLUS<br />
Different distributions of sampling animals across breeding range
PLUS<br />
Sample sizes don’t always match relative abundances PLUS<br />
Compare our approach and simple Mantel approach</p>
<ol style="list-style-type: decimal">
<li>Base (10 years, uneven abundances but matches sampling)</li>
<li>Breeding pops divided into 4 squares, sample across breeding
range</li>
<li>Breeding pops divided into 4 squares, sample at centroid of each
square</li>
<li>Sampling high in low abundance populations plus base</li>
<li>Scenarios 2 plus 4</li>
<li>Scenarios 3 plus 4</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">75</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co"># Transfer between true populations and researcher defined ones (only for</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co"># breeding, as not messing with winter populations here)</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>breedingSiteTrans15 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)), </span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>                            <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>nScenarios15 <span class="ot">&lt;-</span> <span class="fu">length</span>(breedingSiteTrans15)</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>nSims15 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="co"># Basing positions of researcher defined breeding populations on above</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>breedingPos15 <span class="ot">&lt;-</span> <span class="fu">list</span>(breedingPos, </span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>                      breedingPos14[[<span class="dv">5</span>]],</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>                      breedingPos14[[<span class="dv">5</span>]], </span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>                      breedingPos,</span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>                      breedingPos14[[<span class="dv">5</span>]], </span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>                      breedingPos14[[<span class="dv">5</span>]])</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>winteringPos15 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">list</span>(winteringPos), nScenarios15)</span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>breedDist15 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingPos15, distFromPos)</span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>nonbreedDist15 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(winteringPos15, distFromPos)</span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a>nBreeding15 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">4</span>), <span class="dv">2</span>)</span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a>nWintering15 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">100</span>, nScenarios15)</span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a><span class="co"># Highest abundance in lower right corner, lowest in top left</span></span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a><span class="co"># Making symmetrical</span></span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a></span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a>breedingN15base <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">100</span>)</span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co">#row</span></span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)  <span class="co">#column</span></span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a>    breedingN15base[i<span class="sc">+</span><span class="dv">10</span><span class="sc">*</span>(j<span class="dv">-1</span>)] <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="sc">+</span> <span class="dv">850</span><span class="sc">*</span>i<span class="sc">*</span>j</span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" tabindex="-1"></a><span class="fu">sum</span>(breedingN15base)</span>
<span id="cb33-44"><a href="#cb33-44" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" tabindex="-1"></a><span class="co"># For researcher defined populations</span></span>
<span id="cb33-46"><a href="#cb33-46" tabindex="-1"></a>breedingN15 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingSiteTrans15, rowsum, <span class="at">x=</span>breedingN15base) </span>
<span id="cb33-47"><a href="#cb33-47" tabindex="-1"></a></span>
<span id="cb33-48"><a href="#cb33-48" tabindex="-1"></a>breedingRelN15 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingN15, <span class="st">&quot;/&quot;</span>, <span class="fu">sum</span>(breedingN15base))</span>
<span id="cb33-49"><a href="#cb33-49" tabindex="-1"></a></span>
<span id="cb33-50"><a href="#cb33-50" tabindex="-1"></a>nSample15 <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Total number sampled per simulation</span></span>
<span id="cb33-51"><a href="#cb33-51" tabindex="-1"></a></span>
<span id="cb33-52"><a href="#cb33-52" tabindex="-1"></a><span class="co"># Number sampled per natural population</span></span>
<span id="cb33-53"><a href="#cb33-53" tabindex="-1"></a>sampleBreeding15 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">round</span>(breedingRelN15[[<span class="dv">1</span>]]<span class="sc">*</span>nSample15),</span>
<span id="cb33-54"><a href="#cb33-54" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-55"><a href="#cb33-55" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">2</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-56"><a href="#cb33-56" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">3</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-57"><a href="#cb33-57" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">4</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-58"><a href="#cb33-58" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>)),</span>
<span id="cb33-59"><a href="#cb33-59" tabindex="-1"></a>                         <span class="fu">round</span>(breedingRelN15[[<span class="dv">1</span>]]<span class="sc">*</span>nSample15)[<span class="dv">100</span><span class="sc">:</span><span class="dv">1</span>],</span>
<span id="cb33-60"><a href="#cb33-60" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-61"><a href="#cb33-61" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">2</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-62"><a href="#cb33-62" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">3</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-63"><a href="#cb33-63" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN15[[<span class="dv">3</span>]][<span class="dv">4</span>]<span class="sc">*</span>nSample15),</span>
<span id="cb33-64"><a href="#cb33-64" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>))[<span class="dv">100</span><span class="sc">:</span><span class="dv">1</span>])</span>
<span id="cb33-65"><a href="#cb33-65" tabindex="-1"></a></span>
<span id="cb33-66"><a href="#cb33-66" tabindex="-1"></a><span class="co"># Set up psi matrix</span></span>
<span id="cb33-67"><a href="#cb33-67" tabindex="-1"></a>o15 <span class="ot">&lt;-</span> <span class="fu">optimize</span>(mlogitMC, <span class="at">MC.in =</span> <span class="fl">0.25</span>, <span class="at">origin.dist =</span> breedDist15[[<span class="dv">1</span>]],</span>
<span id="cb33-68"><a href="#cb33-68" tabindex="-1"></a>                <span class="at">target.dist =</span> nonbreedDist15[[<span class="dv">1</span>]],</span>
<span id="cb33-69"><a href="#cb33-69" tabindex="-1"></a>                <span class="at">origin.abund =</span> breedingN15[[<span class="dv">1</span>]]<span class="sc">/</span><span class="fu">sum</span>(breedingN15[[<span class="dv">1</span>]]),</span>
<span id="cb33-70"><a href="#cb33-70" tabindex="-1"></a>                <span class="at">sample.size =</span> <span class="fu">sum</span>(breedingN15[[<span class="dv">1</span>]]),</span>
<span id="cb33-71"><a href="#cb33-71" tabindex="-1"></a>                <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb33-72"><a href="#cb33-72" tabindex="-1"></a>                <span class="at">tol =</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb33-73"><a href="#cb33-73" tabindex="-1"></a></span>
<span id="cb33-74"><a href="#cb33-74" tabindex="-1"></a>slope15 <span class="ot">&lt;-</span> o15<span class="sc">$</span>minimum</span>
<span id="cb33-75"><a href="#cb33-75" tabindex="-1"></a></span>
<span id="cb33-76"><a href="#cb33-76" tabindex="-1"></a>psi15 <span class="ot">&lt;-</span> <span class="fu">mlogitMat</span>(slope15, breedDist15[[<span class="dv">1</span>]])</span>
<span id="cb33-77"><a href="#cb33-77" tabindex="-1"></a></span>
<span id="cb33-78"><a href="#cb33-78" tabindex="-1"></a><span class="co"># Baseline strength of migratory connectivity</span></span>
<span id="cb33-79"><a href="#cb33-79" tabindex="-1"></a>MC15 <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> breedDist15[[<span class="dv">1</span>]], </span>
<span id="cb33-80"><a href="#cb33-80" tabindex="-1"></a>               <span class="at">targetDist =</span> nonbreedDist15[[<span class="dv">1</span>]],</span>
<span id="cb33-81"><a href="#cb33-81" tabindex="-1"></a>               <span class="at">psi =</span> psi15,</span>
<span id="cb33-82"><a href="#cb33-82" tabindex="-1"></a>               <span class="at">originRelAbund =</span> breedingN15[[<span class="dv">1</span>]]<span class="sc">/</span><span class="fu">sum</span>(breedingN15[[<span class="dv">1</span>]]),</span>
<span id="cb33-83"><a href="#cb33-83" tabindex="-1"></a>               <span class="at">sampleSize =</span> <span class="fu">sum</span>(breedingN15[[<span class="dv">1</span>]]))</span>
<span id="cb33-84"><a href="#cb33-84" tabindex="-1"></a></span>
<span id="cb33-85"><a href="#cb33-85" tabindex="-1"></a><span class="co"># Run sampling regimes</span></span>
<span id="cb33-86"><a href="#cb33-86" tabindex="-1"></a>scenarioToSampleMap15 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb33-87"><a href="#cb33-87" tabindex="-1"></a></span>
<span id="cb33-88"><a href="#cb33-88" tabindex="-1"></a>animalLoc15 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios15)</span>
<span id="cb33-89"><a href="#cb33-89" tabindex="-1"></a></span>
<span id="cb33-90"><a href="#cb33-90" tabindex="-1"></a>results15 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios15)</span>
<span id="cb33-91"><a href="#cb33-91" tabindex="-1"></a></span>
<span id="cb33-92"><a href="#cb33-92" tabindex="-1"></a>compare15 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Scenario =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>, </span>
<span id="cb33-93"><a href="#cb33-93" tabindex="-1"></a>                                     <span class="st">&quot;Base&quot;</span>, </span>
<span id="cb33-94"><a href="#cb33-94" tabindex="-1"></a>                                     <span class="st">&quot;Breeding4&quot;</span>,</span>
<span id="cb33-95"><a href="#cb33-95" tabindex="-1"></a>                                     <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,</span>
<span id="cb33-96"><a href="#cb33-96" tabindex="-1"></a>                                     <span class="st">&quot;BiasedSample&quot;</span>, </span>
<span id="cb33-97"><a href="#cb33-97" tabindex="-1"></a>                                     <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,</span>
<span id="cb33-98"><a href="#cb33-98" tabindex="-1"></a>                                     <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),</span>
<span id="cb33-99"><a href="#cb33-99" tabindex="-1"></a>                        <span class="at">MC =</span> <span class="fu">c</span>(MC15, <span class="fu">rep</span>(<span class="cn">NA</span>, nScenarios15)), </span>
<span id="cb33-100"><a href="#cb33-100" tabindex="-1"></a>                        <span class="at">Mantel =</span> <span class="fu">c</span>(MC15, <span class="fu">rep</span>(<span class="cn">NA</span>, nScenarios15)))</span>
<span id="cb33-101"><a href="#cb33-101" tabindex="-1"></a></span>
<span id="cb33-102"><a href="#cb33-102" tabindex="-1"></a>compare15.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims15, nScenarios15, <span class="dv">2</span>),</span>
<span id="cb33-103"><a href="#cb33-103" tabindex="-1"></a>                         <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims15,</span>
<span id="cb33-104"><a href="#cb33-104" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="st">&quot;Base&quot;</span>, <span class="st">&quot;Breeding4&quot;</span>, </span>
<span id="cb33-105"><a href="#cb33-105" tabindex="-1"></a>                                      <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,</span>
<span id="cb33-106"><a href="#cb33-106" tabindex="-1"></a>                                      <span class="st">&quot;BiasedSample&quot;</span>, <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,</span>
<span id="cb33-107"><a href="#cb33-107" tabindex="-1"></a>                                      <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),</span>
<span id="cb33-108"><a href="#cb33-108" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb33-109"><a href="#cb33-109" tabindex="-1"></a></span>
<span id="cb33-110"><a href="#cb33-110" tabindex="-1"></a></span>
<span id="cb33-111"><a href="#cb33-111" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSims15) {</span>
<span id="cb33-112"><a href="#cb33-112" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims15, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb33-113"><a href="#cb33-113" tabindex="-1"></a>  </span>
<span id="cb33-114"><a href="#cb33-114" tabindex="-1"></a>  sim15 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sampleBreeding15, </span>
<span id="cb33-115"><a href="#cb33-115" tabindex="-1"></a>                  simMove, </span>
<span id="cb33-116"><a href="#cb33-116" tabindex="-1"></a>                  <span class="at">breedingDist =</span> breedDist15[[<span class="dv">1</span>]],</span>
<span id="cb33-117"><a href="#cb33-117" tabindex="-1"></a>                  <span class="at">winteringDist=</span>nonbreedDist15[[<span class="dv">1</span>]],</span>
<span id="cb33-118"><a href="#cb33-118" tabindex="-1"></a>                  <span class="at">psi=</span>psi15,</span>
<span id="cb33-119"><a href="#cb33-119" tabindex="-1"></a>                  <span class="at">nYears=</span>nYears,</span>
<span id="cb33-120"><a href="#cb33-120" tabindex="-1"></a>                  <span class="at">nMonths=</span>nMonths)</span>
<span id="cb33-121"><a href="#cb33-121" tabindex="-1"></a>  </span>
<span id="cb33-122"><a href="#cb33-122" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios15) {</span>
<span id="cb33-123"><a href="#cb33-123" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\t</span><span class="st">Scenario&quot;</span>, i, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb33-124"><a href="#cb33-124" tabindex="-1"></a>    animalLoc15[[i]] <span class="ot">&lt;-</span> <span class="fu">changeLocations</span>(</span>
<span id="cb33-125"><a href="#cb33-125" tabindex="-1"></a>                        <span class="at">animalLoc=</span>sim15[[scenarioToSampleMap15[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb33-126"><a href="#cb33-126" tabindex="-1"></a>                        <span class="at">breedingSiteTrans =</span> breedingSiteTrans15[[i]],</span>
<span id="cb33-127"><a href="#cb33-127" tabindex="-1"></a>                        <span class="at">winteringSiteTrans =</span> <span class="dv">1</span><span class="sc">:</span>nWintering15[i])</span>
<span id="cb33-128"><a href="#cb33-128" tabindex="-1"></a>    </span>
<span id="cb33-129"><a href="#cb33-129" tabindex="-1"></a>    results15[[i]] <span class="ot">&lt;-</span> <span class="fu">calcPsiMC</span>(<span class="at">originDist =</span> breedDist15[[i]], </span>
<span id="cb33-130"><a href="#cb33-130" tabindex="-1"></a>                                <span class="at">targetDist =</span> nonbreedDist15[[i]],</span>
<span id="cb33-131"><a href="#cb33-131" tabindex="-1"></a>                                <span class="at">originRelAbund =</span> breedingRelN15[[i]],</span>
<span id="cb33-132"><a href="#cb33-132" tabindex="-1"></a>                                <span class="at">locations =</span> animalLoc15[[i]], </span>
<span id="cb33-133"><a href="#cb33-133" tabindex="-1"></a>                                <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-134"><a href="#cb33-134" tabindex="-1"></a>    </span>
<span id="cb33-135"><a href="#cb33-135" tabindex="-1"></a>compare15.array[sim, i, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results15[[i]]<span class="sc">$</span>MC</span>
<span id="cb33-136"><a href="#cb33-136" tabindex="-1"></a></span>
<span id="cb33-137"><a href="#cb33-137" tabindex="-1"></a>compare15.array[sim, i, <span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> <span class="fu">calcStrengthInd</span>(breedDist15[[<span class="dv">1</span>]],</span>
<span id="cb33-138"><a href="#cb33-138" tabindex="-1"></a>                                                     nonbreedDist15[[<span class="dv">1</span>]],</span>
<span id="cb33-139"><a href="#cb33-139" tabindex="-1"></a>                                   sim15[[scenarioToSampleMap15[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb33-140"><a href="#cb33-140" tabindex="-1"></a>                                                    <span class="at">resamp=</span><span class="dv">0</span>)<span class="sc">$</span>correlation</span>
<span id="cb33-141"><a href="#cb33-141" tabindex="-1"></a>  }</span>
<span id="cb33-142"><a href="#cb33-142" tabindex="-1"></a>}</span>
<span id="cb33-143"><a href="#cb33-143" tabindex="-1"></a></span>
<span id="cb33-144"><a href="#cb33-144" tabindex="-1"></a>compare15<span class="sc">$</span>MC[<span class="dv">1</span><span class="sc">:</span>nScenarios15<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare15.array[,,<span class="st">&#39;MC&#39;</span>], <span class="dv">2</span>, mean, </span>
<span id="cb33-145"><a href="#cb33-145" tabindex="-1"></a>                                        <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-146"><a href="#cb33-146" tabindex="-1"></a></span>
<span id="cb33-147"><a href="#cb33-147" tabindex="-1"></a>compare15<span class="sc">$</span>Mantel[<span class="dv">1</span><span class="sc">:</span>nScenarios15<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare15.array[,,<span class="st">&#39;Mantel&#39;</span>], <span class="dv">2</span>,</span>
<span id="cb33-148"><a href="#cb33-148" tabindex="-1"></a>                                            mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-149"><a href="#cb33-149" tabindex="-1"></a>compare15 <span class="ot">&lt;-</span> <span class="fu">transform</span>(compare15, <span class="at">MC.diff=</span>MC <span class="sc">-</span> MC[<span class="dv">1</span>], </span>
<span id="cb33-150"><a href="#cb33-150" tabindex="-1"></a>                       <span class="at">Mantel.diff=</span>Mantel <span class="sc">-</span> Mantel[<span class="dv">1</span>],</span>
<span id="cb33-151"><a href="#cb33-151" tabindex="-1"></a>                       <span class="at">MC.prop=</span>MC<span class="sc">/</span>MC[<span class="dv">1</span>],  </span>
<span id="cb33-152"><a href="#cb33-152" tabindex="-1"></a>                       <span class="at">Mantel.prop=</span>Mantel<span class="sc">/</span>Mantel[<span class="dv">1</span>])</span>
<span id="cb33-153"><a href="#cb33-153" tabindex="-1"></a></span>
<span id="cb33-154"><a href="#cb33-154" tabindex="-1"></a></span>
<span id="cb33-155"><a href="#cb33-155" tabindex="-1"></a>compare15a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(compare15[<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span>nScenarios15, </span>
<span id="cb33-156"><a href="#cb33-156" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;MC.diff&quot;</span>, <span class="st">&quot;Mantel&quot;</span>, <span class="st">&quot;Mantel.diff&quot;</span>)])</span>
<span id="cb33-157"><a href="#cb33-157" tabindex="-1"></a></span>
<span id="cb33-158"><a href="#cb33-158" tabindex="-1"></a><span class="fu">rownames</span>(compare15a) <span class="ot">&lt;-</span> compare15<span class="sc">$</span>Scenario[<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span>nScenarios15]</span></code></pre></div>
<p>###EXAMPLE 7 Sampling regime 3 of 3 Researchers divide populations
differently than reality (simulations) PLUS Different distributions of
sampled animals across breeding range PLUS Sample sizes don’t always
match relative abundances PLUS Compare our approach and simple Mantel
approach PLUS MC not same across subsections of range</p>
<ol style="list-style-type: decimal">
<li>Base (uneven MC (0.15 for NW breeding, 0.3 for SW, 0.45 for NE, and
0.6 for SE), uneven abundances (lowest in NW, highest in SE), sampling
proportional to abundance</li>
<li>Breeding pops divided into 4 squares, sample across breeding
range</li>
<li>Breeding pops divided into 4 squares, sample at centroid of each
square</li>
<li>Sampling high in low abundance populations</li>
<li>Scenarios 2 plus 4</li>
<li>Scenarios 3 plus 4</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">75</span>)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co"># Transfer between true populations and researcher defined ones</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co"># (only for breeding, as not messing with winter populations here)</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>breedingSiteTrans16 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)), <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)),</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>                            <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="at">each=</span><span class="dv">5</span>)))</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="co">#lapply(breedingSiteTrans16, matrix, nrow=10, ncol=10)</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>nScenarios16 <span class="ot">&lt;-</span> <span class="fu">length</span>(breedingSiteTrans16)</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>nSims16 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="co"># Basing positions of researcher defined breeding populations on above</span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>breedingPos16 <span class="ot">&lt;-</span> breedingPos15</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>winteringPos16 <span class="ot">&lt;-</span> winteringPos15</span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>breedDist16 <span class="ot">&lt;-</span> breedDist15</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>nonbreedDist16 <span class="ot">&lt;-</span> nonbreedDist15</span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>nBreeding16 <span class="ot">&lt;-</span> nBreeding15</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>nWintering16 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">100</span>, nScenarios16)</span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a><span class="co"># Highest abundance in lower right corner, lowest in top left</span></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="co"># In fact basing on distance from top left population</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a>breedingN16base <span class="ot">&lt;-</span> breedingN15base</span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a>breedingN16 <span class="ot">&lt;-</span> breedingN15</span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a>breedingRelN16 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingN16, <span class="st">&quot;/&quot;</span>, <span class="fu">sum</span>(breedingN16base))</span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a><span class="co"># Set up psi matrix</span></span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a><span class="co"># Each quadrant of breeding range has different MC</span></span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a>MC.levels16 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.15</span>, <span class="fl">0.6</span>, <span class="fl">0.15</span>)</span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a>nLevels16 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a>psi16 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nBreeding16[<span class="dv">1</span>], nWintering16[<span class="dv">1</span>])</span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a></span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nLevels16) {</span>
<span id="cb34-43"><a href="#cb34-43" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;MC&quot;</span>, MC.levels16[i])</span>
<span id="cb34-44"><a href="#cb34-44" tabindex="-1"></a>  <span class="co"># Find a psi matrix that produces the given MC (for whole species)</span></span>
<span id="cb34-45"><a href="#cb34-45" tabindex="-1"></a>  o16a <span class="ot">&lt;-</span> <span class="fu">optimize</span>(mlogitMC, <span class="at">MC.in =</span> MC.levels16[i],</span>
<span id="cb34-46"><a href="#cb34-46" tabindex="-1"></a>                   <span class="at">origin.dist =</span> breedDist16[[<span class="dv">1</span>]],</span>
<span id="cb34-47"><a href="#cb34-47" tabindex="-1"></a>                   <span class="at">target.dist =</span> nonbreedDist16[[<span class="dv">1</span>]],</span>
<span id="cb34-48"><a href="#cb34-48" tabindex="-1"></a>                   <span class="at">origin.abund =</span> breedingN16[[<span class="dv">1</span>]]<span class="sc">/</span><span class="fu">sum</span>(breedingN16[[<span class="dv">1</span>]]),</span>
<span id="cb34-49"><a href="#cb34-49" tabindex="-1"></a>                   <span class="at">sample.size =</span> <span class="fu">sum</span>(breedingN16[[<span class="dv">1</span>]]),</span>
<span id="cb34-50"><a href="#cb34-50" tabindex="-1"></a>                   <span class="at">interval=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="at">tol=</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb34-51"><a href="#cb34-51" tabindex="-1"></a>  </span>
<span id="cb34-52"><a href="#cb34-52" tabindex="-1"></a>  slope16a <span class="ot">&lt;-</span> o16a<span class="sc">$</span>minimum</span>
<span id="cb34-53"><a href="#cb34-53" tabindex="-1"></a>  </span>
<span id="cb34-54"><a href="#cb34-54" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot; slope&quot;</span>, slope16a, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb34-55"><a href="#cb34-55" tabindex="-1"></a>  </span>
<span id="cb34-56"><a href="#cb34-56" tabindex="-1"></a>  psi16a <span class="ot">&lt;-</span> <span class="fu">mlogitMat</span>(slope16a, breedDist16[[<span class="dv">1</span>]])</span>
<span id="cb34-57"><a href="#cb34-57" tabindex="-1"></a>  </span>
<span id="cb34-58"><a href="#cb34-58" tabindex="-1"></a>  <span class="co"># Then use the rows of that psi matrix only for the one breeding quadrant</span></span>
<span id="cb34-59"><a href="#cb34-59" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="dv">50</span><span class="sc">*</span>(i <span class="sc">%/%</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="dv">10</span>), <span class="at">each=</span><span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb34-60"><a href="#cb34-60" tabindex="-1"></a>    ((i<span class="dv">-1</span>) <span class="sc">%%</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb34-61"><a href="#cb34-61" tabindex="-1"></a>  psi16[rows, ] <span class="ot">&lt;-</span> psi16a[rows, ]</span>
<span id="cb34-62"><a href="#cb34-62" tabindex="-1"></a>}</span>
<span id="cb34-63"><a href="#cb34-63" tabindex="-1"></a></span>
<span id="cb34-64"><a href="#cb34-64" tabindex="-1"></a></span>
<span id="cb34-65"><a href="#cb34-65" tabindex="-1"></a><span class="co"># Baseline strength of migratory connectivity</span></span>
<span id="cb34-66"><a href="#cb34-66" tabindex="-1"></a>MC16 <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(<span class="at">originDist =</span> breedDist16[[<span class="dv">1</span>]],</span>
<span id="cb34-67"><a href="#cb34-67" tabindex="-1"></a>               <span class="at">targetDist =</span> nonbreedDist16[[<span class="dv">1</span>]], </span>
<span id="cb34-68"><a href="#cb34-68" tabindex="-1"></a>               <span class="at">psi =</span> psi16,</span>
<span id="cb34-69"><a href="#cb34-69" tabindex="-1"></a>               <span class="at">originRelAbund =</span> breedingN16[[<span class="dv">1</span>]]<span class="sc">/</span><span class="fu">sum</span>(breedingN16[[<span class="dv">1</span>]]),</span>
<span id="cb34-70"><a href="#cb34-70" tabindex="-1"></a>               <span class="at">sampleSize =</span> <span class="fu">sum</span>(breedingN16[[<span class="dv">1</span>]]))</span>
<span id="cb34-71"><a href="#cb34-71" tabindex="-1"></a></span>
<span id="cb34-72"><a href="#cb34-72" tabindex="-1"></a></span>
<span id="cb34-73"><a href="#cb34-73" tabindex="-1"></a><span class="co"># Set up sampling regimes (different number than number of scenarios)</span></span>
<span id="cb34-74"><a href="#cb34-74" tabindex="-1"></a>nSample16 <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb34-75"><a href="#cb34-75" tabindex="-1"></a>sampleBreeding16 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">round</span>(breedingRelN16[[<span class="dv">1</span>]]<span class="sc">*</span>nSample16),</span>
<span id="cb34-76"><a href="#cb34-76" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-77"><a href="#cb34-77" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">2</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-78"><a href="#cb34-78" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">3</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-79"><a href="#cb34-79" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">4</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-80"><a href="#cb34-80" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>)),</span>
<span id="cb34-81"><a href="#cb34-81" tabindex="-1"></a>                         <span class="fu">round</span>(breedingRelN16[[<span class="dv">1</span>]]<span class="sc">*</span>nSample16)[<span class="dv">100</span><span class="sc">:</span><span class="dv">1</span>],</span>
<span id="cb34-82"><a href="#cb34-82" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-83"><a href="#cb34-83" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">2</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-84"><a href="#cb34-84" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">44</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">3</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-85"><a href="#cb34-85" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">round</span>(breedingRelN16[[<span class="dv">3</span>]][<span class="dv">4</span>]<span class="sc">*</span>nSample16),</span>
<span id="cb34-86"><a href="#cb34-86" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>))[<span class="dv">100</span><span class="sc">:</span><span class="dv">1</span>])</span>
<span id="cb34-87"><a href="#cb34-87" tabindex="-1"></a></span>
<span id="cb34-88"><a href="#cb34-88" tabindex="-1"></a><span class="fu">sapply</span>(sampleBreeding16, sum)</span>
<span id="cb34-89"><a href="#cb34-89" tabindex="-1"></a></span>
<span id="cb34-90"><a href="#cb34-90" tabindex="-1"></a><span class="co"># Run sampling regimes</span></span>
<span id="cb34-91"><a href="#cb34-91" tabindex="-1"></a>scenarioToSampleMap16 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb34-92"><a href="#cb34-92" tabindex="-1"></a>animalLoc16 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios16)</span>
<span id="cb34-93"><a href="#cb34-93" tabindex="-1"></a>results16 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios16)</span>
<span id="cb34-94"><a href="#cb34-94" tabindex="-1"></a>compare16 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Scenario =</span> <span class="fu">c</span>(<span class="st">&quot;True&quot;</span>,</span>
<span id="cb34-95"><a href="#cb34-95" tabindex="-1"></a>                                     <span class="st">&quot;Base&quot;</span>,</span>
<span id="cb34-96"><a href="#cb34-96" tabindex="-1"></a>                                     <span class="st">&quot;Breeding4&quot;</span>,</span>
<span id="cb34-97"><a href="#cb34-97" tabindex="-1"></a>                                     <span class="st">&quot;CentroidSampleBreeding4&quot;</span>, </span>
<span id="cb34-98"><a href="#cb34-98" tabindex="-1"></a>                                     <span class="st">&quot;BiasedSample&quot;</span>,</span>
<span id="cb34-99"><a href="#cb34-99" tabindex="-1"></a>                                     <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,</span>
<span id="cb34-100"><a href="#cb34-100" tabindex="-1"></a>                                     <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),</span>
<span id="cb34-101"><a href="#cb34-101" tabindex="-1"></a>                        <span class="at">MC =</span> <span class="fu">c</span>(MC16, <span class="fu">rep</span>(<span class="cn">NA</span>, nScenarios16)),</span>
<span id="cb34-102"><a href="#cb34-102" tabindex="-1"></a>                        <span class="at">Mantel =</span> <span class="fu">c</span>(MC16, <span class="fu">rep</span>(<span class="cn">NA</span>, nScenarios16)))</span>
<span id="cb34-103"><a href="#cb34-103" tabindex="-1"></a></span>
<span id="cb34-104"><a href="#cb34-104" tabindex="-1"></a>compare16.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims16, nScenarios16, <span class="dv">2</span>), </span>
<span id="cb34-105"><a href="#cb34-105" tabindex="-1"></a>                         <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims16,</span>
<span id="cb34-106"><a href="#cb34-106" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="st">&quot;Base&quot;</span>, <span class="st">&quot;Breeding4&quot;</span>,</span>
<span id="cb34-107"><a href="#cb34-107" tabindex="-1"></a>                                           <span class="st">&quot;CentroidSampleBreeding4&quot;</span>,</span>
<span id="cb34-108"><a href="#cb34-108" tabindex="-1"></a>                                           <span class="st">&quot;BiasedSample&quot;</span>,</span>
<span id="cb34-109"><a href="#cb34-109" tabindex="-1"></a>                                           <span class="st">&quot;BiasedSampleBreeding4&quot;</span>,</span>
<span id="cb34-110"><a href="#cb34-110" tabindex="-1"></a>                                           <span class="st">&quot;BiasedCentroidSampleBreeding4&quot;</span>),</span>
<span id="cb34-111"><a href="#cb34-111" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb34-112"><a href="#cb34-112" tabindex="-1"></a></span>
<span id="cb34-113"><a href="#cb34-113" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">80</span>)</span>
<span id="cb34-114"><a href="#cb34-114" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSims16) {</span>
<span id="cb34-115"><a href="#cb34-115" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims16, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb34-116"><a href="#cb34-116" tabindex="-1"></a>  </span>
<span id="cb34-117"><a href="#cb34-117" tabindex="-1"></a>  sim16 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sampleBreeding16, simMove, <span class="at">breedingDist =</span> breedDist16[[<span class="dv">1</span>]],</span>
<span id="cb34-118"><a href="#cb34-118" tabindex="-1"></a>                  <span class="at">winteringDist=</span>nonbreedDist16[[<span class="dv">1</span>]], <span class="at">psi=</span>psi16, <span class="at">nYears=</span>nYears,</span>
<span id="cb34-119"><a href="#cb34-119" tabindex="-1"></a>                  <span class="at">nMonths=</span>nMonths)</span>
<span id="cb34-120"><a href="#cb34-120" tabindex="-1"></a>  </span>
<span id="cb34-121"><a href="#cb34-121" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nScenarios16) {</span>
<span id="cb34-122"><a href="#cb34-122" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\t</span><span class="st">Scenario&quot;</span>, i, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb34-123"><a href="#cb34-123" tabindex="-1"></a>  animalLoc16[[i]]<span class="ot">&lt;-</span><span class="fu">changeLocations</span>(sim16[[scenarioToSampleMap16[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb34-124"><a href="#cb34-124" tabindex="-1"></a>                                      breedingSiteTrans16[[i]], </span>
<span id="cb34-125"><a href="#cb34-125" tabindex="-1"></a>                                      <span class="dv">1</span><span class="sc">:</span>nWintering16[i])</span>
<span id="cb34-126"><a href="#cb34-126" tabindex="-1"></a>    </span>
<span id="cb34-127"><a href="#cb34-127" tabindex="-1"></a>  results16[[i]] <span class="ot">&lt;-</span> <span class="fu">calcPsiMC</span>(<span class="at">originDist =</span> breedDist16[[i]],</span>
<span id="cb34-128"><a href="#cb34-128" tabindex="-1"></a>                              <span class="at">targetDist =</span> nonbreedDist16[[i]],</span>
<span id="cb34-129"><a href="#cb34-129" tabindex="-1"></a>                              <span class="at">locations =</span> animalLoc16[[i]],</span>
<span id="cb34-130"><a href="#cb34-130" tabindex="-1"></a>                              <span class="at">originRelAbund =</span> breedingRelN16[[i]],</span>
<span id="cb34-131"><a href="#cb34-131" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-132"><a href="#cb34-132" tabindex="-1"></a>    </span>
<span id="cb34-133"><a href="#cb34-133" tabindex="-1"></a>compare16.array[sim, i, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results16[[i]]<span class="sc">$</span>MC</span>
<span id="cb34-134"><a href="#cb34-134" tabindex="-1"></a>    </span>
<span id="cb34-135"><a href="#cb34-135" tabindex="-1"></a>compare16.array[sim, i, <span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> <span class="fu">calcStrengthInd</span>(breedDist16[[<span class="dv">1</span>]],</span>
<span id="cb34-136"><a href="#cb34-136" tabindex="-1"></a>                                                         nonbreedDist16[[<span class="dv">1</span>]],</span>
<span id="cb34-137"><a href="#cb34-137" tabindex="-1"></a>                                   sim16[[scenarioToSampleMap16[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb34-138"><a href="#cb34-138" tabindex="-1"></a>                                                         <span class="at">resamp=</span><span class="dv">0</span>)<span class="sc">$</span>correlation</span>
<span id="cb34-139"><a href="#cb34-139" tabindex="-1"></a>  }</span>
<span id="cb34-140"><a href="#cb34-140" tabindex="-1"></a>}</span>
<span id="cb34-141"><a href="#cb34-141" tabindex="-1"></a></span>
<span id="cb34-142"><a href="#cb34-142" tabindex="-1"></a>compare16<span class="sc">$</span>MC[<span class="dv">1</span><span class="sc">:</span>nScenarios16<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare16.array[,,<span class="st">&#39;MC&#39;</span>], <span class="dv">2</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-143"><a href="#cb34-143" tabindex="-1"></a></span>
<span id="cb34-144"><a href="#cb34-144" tabindex="-1"></a>compare16<span class="sc">$</span>Mantel[<span class="dv">1</span><span class="sc">:</span>nScenarios16<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare16.array[,,<span class="st">&#39;Mantel&#39;</span>], <span class="dv">2</span>, </span>
<span id="cb34-145"><a href="#cb34-145" tabindex="-1"></a>                                            mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-146"><a href="#cb34-146" tabindex="-1"></a></span>
<span id="cb34-147"><a href="#cb34-147" tabindex="-1"></a>compare16 <span class="ot">&lt;-</span> <span class="fu">transform</span>(compare16, <span class="at">MC.diff=</span>MC <span class="sc">-</span> MC[<span class="dv">1</span>], </span>
<span id="cb34-148"><a href="#cb34-148" tabindex="-1"></a>                       <span class="at">Mantel.diff=</span>Mantel <span class="sc">-</span> Mantel[<span class="dv">1</span>])</span>
<span id="cb34-149"><a href="#cb34-149" tabindex="-1"></a></span>
<span id="cb34-150"><a href="#cb34-150" tabindex="-1"></a>compare16a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(compare16[<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span>nScenarios16, <span class="fu">c</span>(<span class="st">&#39;MC&#39;</span>,<span class="st">&#39;MC.diff&#39;</span>,</span>
<span id="cb34-151"><a href="#cb34-151" tabindex="-1"></a>                                                        <span class="st">&quot;Mantel&quot;</span>,</span>
<span id="cb34-152"><a href="#cb34-152" tabindex="-1"></a>                                                        <span class="st">&quot;Mantel.diff&quot;</span>)])</span>
<span id="cb34-153"><a href="#cb34-153" tabindex="-1"></a></span>
<span id="cb34-154"><a href="#cb34-154" tabindex="-1"></a><span class="fu">rownames</span>(compare16a) <span class="ot">&lt;-</span> compare16<span class="sc">$</span>Scenario[<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span>nScenarios16]</span></code></pre></div>
<p>###EXAMPLE 8 <code>estMC</code> Estimate strength of migratory
connectivity incorporating uncertainty from limited sample size (no
other sampling error). Here we simulated data using the 13th scenario
from example 5 above (“CentroidSampleBreeding4”; make sure you run
example 5 code before running this section). We changed the total sample
size from 1000 to 100 animals and the total abundance from 50000 to 2500
animals.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># Load in projections</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;projections&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">75</span>)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>capLocs14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingPos14, </span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>                    <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>                      <span class="fu">colnames</span>(x)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>                      sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(x),</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>                                   <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>                                   <span class="at">crs =</span> <span class="dv">4326</span>)})</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>targLocs14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(winteringPos14,</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>                     <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>                      <span class="fu">colnames</span>(x)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>                      sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(x),</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>                                   <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>                                   <span class="at">crs =</span> <span class="dv">4326</span>)})</span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a><span class="co"># Relative abundance by scenario and breeding population</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>breedingN14base <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">25</span>, nBreeding14[<span class="dv">1</span>])</span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>breedingN14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingSiteTrans14, rowsum, <span class="at">x=</span>breedingN14base)</span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>breedingRelN14 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(breedingN14, <span class="st">&quot;/&quot;</span>, <span class="fu">sum</span>(breedingN14base))</span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>MC14 <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>nSample14<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Total number sampled per simulation</span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a><span class="co"># How many sampled from each natural population (sampling scenarios separate</span></span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a><span class="co"># from definition scenarios)</span></span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a>sampleBreeding14<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">round</span>(breedingRelN14[[<span class="dv">1</span>]]<span class="sc">*</span>nSample14<span class="fl">.1</span>),</span>
<span id="cb35-33"><a href="#cb35-33" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>),<span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample14<span class="fl">.1</span>),</span>
<span id="cb35-34"><a href="#cb35-34" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">2</span>]<span class="sc">*</span>nSample14<span class="fl">.1</span>),</span>
<span id="cb35-35"><a href="#cb35-35" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">44</span>),<span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">3</span>]<span class="sc">*</span>nSample14<span class="fl">.1</span>),</span>
<span id="cb35-36"><a href="#cb35-36" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">4</span>]<span class="sc">*</span>nSample14<span class="fl">.1</span>),</span>
<span id="cb35-37"><a href="#cb35-37" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>)),</span>
<span id="cb35-38"><a href="#cb35-38" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>),</span>
<span id="cb35-39"><a href="#cb35-39" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="fu">round</span>(breedingRelN14[[<span class="dv">2</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample14<span class="fl">.1</span><span class="sc">/</span><span class="dv">2</span>), <span class="dv">2</span>),</span>
<span id="cb35-40"><a href="#cb35-40" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="dv">10</span>))</span>
<span id="cb35-41"><a href="#cb35-41" tabindex="-1"></a></span>
<span id="cb35-42"><a href="#cb35-42" tabindex="-1"></a><span class="fu">lapply</span>(sampleBreeding14<span class="fl">.1</span>, matrix, <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">10</span>)</span>
<span id="cb35-43"><a href="#cb35-43" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" tabindex="-1"></a><span class="co"># Number of simulations to run</span></span>
<span id="cb35-45"><a href="#cb35-45" tabindex="-1"></a>nSims14 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb35-46"><a href="#cb35-46" tabindex="-1"></a>nSimsLarge14 <span class="ot">&lt;-</span> <span class="dv">250</span> <span class="co">#0riginally 2500</span></span>
<span id="cb35-47"><a href="#cb35-47" tabindex="-1"></a>nYears <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-48"><a href="#cb35-48" tabindex="-1"></a>nMonths <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-49"><a href="#cb35-49" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" tabindex="-1"></a><span class="co"># Set up data structures for storing results</span></span>
<span id="cb35-51"><a href="#cb35-51" tabindex="-1"></a>animalLoc14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14) <span class="co">#making an empty list to fill</span></span>
<span id="cb35-52"><a href="#cb35-52" tabindex="-1"></a>sim14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nSimsLarge14) <span class="co">#making an empty list to fill</span></span>
<span id="cb35-53"><a href="#cb35-53" tabindex="-1"></a></span>
<span id="cb35-54"><a href="#cb35-54" tabindex="-1"></a>compare14.<span class="fl">1.</span>array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSimsLarge14, <span class="dv">2</span>), </span>
<span id="cb35-55"><a href="#cb35-55" tabindex="-1"></a>                           <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSimsLarge14,</span>
<span id="cb35-56"><a href="#cb35-56" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb35-57"><a href="#cb35-57" tabindex="-1"></a></span>
<span id="cb35-58"><a href="#cb35-58" tabindex="-1"></a>results14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14)</span>
<span id="cb35-59"><a href="#cb35-59" tabindex="-1"></a></span>
<span id="cb35-60"><a href="#cb35-60" tabindex="-1"></a><span class="co"># Run simulations</span></span>
<span id="cb35-61"><a href="#cb35-61" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb35-62"><a href="#cb35-62" tabindex="-1"></a></span>
<span id="cb35-63"><a href="#cb35-63" tabindex="-1"></a><span class="fu">system.time</span>(<span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSimsLarge14) {</span>
<span id="cb35-64"><a href="#cb35-64" tabindex="-1"></a>  </span>
<span id="cb35-65"><a href="#cb35-65" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSimsLarge14, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb35-66"><a href="#cb35-66" tabindex="-1"></a>  </span>
<span id="cb35-67"><a href="#cb35-67" tabindex="-1"></a>  sim14[[sim]] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sampleBreeding14<span class="fl">.1</span>,</span>
<span id="cb35-68"><a href="#cb35-68" tabindex="-1"></a>                         simMove, </span>
<span id="cb35-69"><a href="#cb35-69" tabindex="-1"></a>                         <span class="at">breedingDist =</span> breedDist14[[<span class="dv">1</span>]],</span>
<span id="cb35-70"><a href="#cb35-70" tabindex="-1"></a>                         <span class="at">winteringDist=</span>nonbreedDist14[[<span class="dv">1</span>]],</span>
<span id="cb35-71"><a href="#cb35-71" tabindex="-1"></a>                         <span class="at">psi=</span>psi,</span>
<span id="cb35-72"><a href="#cb35-72" tabindex="-1"></a>                         <span class="at">nYears=</span>nYears,</span>
<span id="cb35-73"><a href="#cb35-73" tabindex="-1"></a>                         <span class="at">nMonths=</span>nMonths)</span>
<span id="cb35-74"><a href="#cb35-74" tabindex="-1"></a>  </span>
<span id="cb35-75"><a href="#cb35-75" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">13</span>) {</span>
<span id="cb35-76"><a href="#cb35-76" tabindex="-1"></a> animalLoc14[[i]] <span class="ot">&lt;-</span> <span class="fu">changeLocations</span>(sim14[[sim]][[scenarioToSampleMap14[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb35-77"><a href="#cb35-77" tabindex="-1"></a>                                     breedingSiteTrans14[[i]], </span>
<span id="cb35-78"><a href="#cb35-78" tabindex="-1"></a>                                     winteringSiteTrans14[[i]])</span>
<span id="cb35-79"><a href="#cb35-79" tabindex="-1"></a> </span>
<span id="cb35-80"><a href="#cb35-80" tabindex="-1"></a> results14[[i]] <span class="ot">&lt;-</span> <span class="fu">calcPsiMC</span>(breedDist14[[i]], </span>
<span id="cb35-81"><a href="#cb35-81" tabindex="-1"></a>                             nonbreedDist14[[i]],</span>
<span id="cb35-82"><a href="#cb35-82" tabindex="-1"></a>                             animalLoc14[[i]],</span>
<span id="cb35-83"><a href="#cb35-83" tabindex="-1"></a>                             <span class="at">originRelAbund =</span> breedingRelN14[[i]],</span>
<span id="cb35-84"><a href="#cb35-84" tabindex="-1"></a>                             <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-85"><a href="#cb35-85" tabindex="-1"></a> </span>
<span id="cb35-86"><a href="#cb35-86" tabindex="-1"></a>  compare14.<span class="fl">1.</span>array[sim,<span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results14[[i]]<span class="sc">$</span>MC</span>
<span id="cb35-87"><a href="#cb35-87" tabindex="-1"></a>    </span>
<span id="cb35-88"><a href="#cb35-88" tabindex="-1"></a>  compare14.<span class="fl">1.</span>array[sim,<span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> <span class="fu">calcStrengthInd</span>(breedDist14[[<span class="dv">1</span>]],</span>
<span id="cb35-89"><a href="#cb35-89" tabindex="-1"></a>                                                  nonbreedDist14[[<span class="dv">1</span>]],</span>
<span id="cb35-90"><a href="#cb35-90" tabindex="-1"></a>                            sim14[[sim]][[scenarioToSampleMap14[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb35-91"><a href="#cb35-91" tabindex="-1"></a>                                                  <span class="at">resamp=</span><span class="dv">0</span>)<span class="sc">$</span>correlation</span>
<span id="cb35-92"><a href="#cb35-92" tabindex="-1"></a>  }</span>
<span id="cb35-93"><a href="#cb35-93" tabindex="-1"></a>})</span>
<span id="cb35-94"><a href="#cb35-94" tabindex="-1"></a></span>
<span id="cb35-95"><a href="#cb35-95" tabindex="-1"></a>means14 <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.<span class="fl">1.</span>array, <span class="dv">2</span>, mean)</span>
<span id="cb35-96"><a href="#cb35-96" tabindex="-1"></a></span>
<span id="cb35-97"><a href="#cb35-97" tabindex="-1"></a>vars14 <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.<span class="fl">1.</span>array, <span class="dv">2</span>, var)</span>
<span id="cb35-98"><a href="#cb35-98" tabindex="-1"></a></span>
<span id="cb35-99"><a href="#cb35-99" tabindex="-1"></a>rmse14 <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.<span class="fl">1.</span>array, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">mean</span>((x <span class="sc">-</span> MC14)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb35-100"><a href="#cb35-100" tabindex="-1"></a></span>
<span id="cb35-101"><a href="#cb35-101" tabindex="-1"></a><span class="co"># Set up data structures for storing estimation results</span></span>
<span id="cb35-102"><a href="#cb35-102" tabindex="-1"></a>est14.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims14, <span class="dv">2</span>), </span>
<span id="cb35-103"><a href="#cb35-103" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims14,<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb35-104"><a href="#cb35-104" tabindex="-1"></a></span>
<span id="cb35-105"><a href="#cb35-105" tabindex="-1"></a>var14.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims14, <span class="dv">2</span>), </span>
<span id="cb35-106"><a href="#cb35-106" tabindex="-1"></a>                     <span class="at">dimnames =</span><span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims14,<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb35-107"><a href="#cb35-107" tabindex="-1"></a></span>
<span id="cb35-108"><a href="#cb35-108" tabindex="-1"></a>ci14.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims14, <span class="dv">2</span>, <span class="dv">2</span>), </span>
<span id="cb35-109"><a href="#cb35-109" tabindex="-1"></a>                    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims14,</span>
<span id="cb35-110"><a href="#cb35-110" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>),</span>
<span id="cb35-111"><a href="#cb35-111" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="st">&#39;lower&#39;</span>, <span class="st">&#39;upper&#39;</span>)))</span>
<span id="cb35-112"><a href="#cb35-112" tabindex="-1"></a></span>
<span id="cb35-113"><a href="#cb35-113" tabindex="-1"></a><span class="co">#making an empty list to fill</span></span>
<span id="cb35-114"><a href="#cb35-114" tabindex="-1"></a></span>
<span id="cb35-115"><a href="#cb35-115" tabindex="-1"></a>animalLoc14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nSims14) </span>
<span id="cb35-116"><a href="#cb35-116" tabindex="-1"></a></span>
<span id="cb35-117"><a href="#cb35-117" tabindex="-1"></a>results14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nSims14)</span>
<span id="cb35-118"><a href="#cb35-118" tabindex="-1"></a></span>
<span id="cb35-119"><a href="#cb35-119" tabindex="-1"></a><span class="co"># Run estimations</span></span>
<span id="cb35-120"><a href="#cb35-120" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">567</span>)</span>
<span id="cb35-121"><a href="#cb35-121" tabindex="-1"></a></span>
<span id="cb35-122"><a href="#cb35-122" tabindex="-1"></a>sim14.sub <span class="ot">&lt;-</span> sim14[<span class="fu">sample.int</span>(nSimsLarge14, nSims14, <span class="cn">TRUE</span>)]</span>
<span id="cb35-123"><a href="#cb35-123" tabindex="-1"></a></span>
<span id="cb35-124"><a href="#cb35-124" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSims14) {</span>
<span id="cb35-125"><a href="#cb35-125" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Estimation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims14, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb35-126"><a href="#cb35-126" tabindex="-1"></a>  </span>
<span id="cb35-127"><a href="#cb35-127" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">13</span>) {<span class="co">#:nScenarios14) {</span></span>
<span id="cb35-128"><a href="#cb35-128" tabindex="-1"></a>  animalLoc14[[sim]] <span class="ot">&lt;-</span> </span>
<span id="cb35-129"><a href="#cb35-129" tabindex="-1"></a>    <span class="fu">changeLocations</span>(sim14.sub[[sim]][[scenarioToSampleMap14[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb35-130"><a href="#cb35-130" tabindex="-1"></a>                                        breedingSiteTrans14[[i]], </span>
<span id="cb35-131"><a href="#cb35-131" tabindex="-1"></a>                                        winteringSiteTrans14[[i]])</span>
<span id="cb35-132"><a href="#cb35-132" tabindex="-1"></a>  </span>
<span id="cb35-133"><a href="#cb35-133" tabindex="-1"></a>  results14[[sim]] <span class="ot">&lt;-</span> <span class="fu">estMC</span>(<span class="at">originDist =</span> breedDist14[[i]], </span>
<span id="cb35-134"><a href="#cb35-134" tabindex="-1"></a>                            <span class="at">targetDist =</span> nonbreedDist14[[i]],</span>
<span id="cb35-135"><a href="#cb35-135" tabindex="-1"></a>                            <span class="at">originRelAbund =</span> breedingRelN14[[i]],</span>
<span id="cb35-136"><a href="#cb35-136" tabindex="-1"></a>              <span class="at">originPoints =</span> capLocs14[[i]][animalLoc14[[sim]][, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], ],</span>
<span id="cb35-137"><a href="#cb35-137" tabindex="-1"></a>              <span class="at">targetPoints =</span> targLocs14[[i]][animalLoc14[[sim]][, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>], ],</span>
<span id="cb35-138"><a href="#cb35-138" tabindex="-1"></a>                            <span class="at">originAssignment =</span> animalLoc14[[sim]][, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb35-139"><a href="#cb35-139" tabindex="-1"></a>                            <span class="at">targetAssignment =</span> animalLoc14[[sim]][, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb35-140"><a href="#cb35-140" tabindex="-1"></a>                            <span class="at">nSamples =</span> <span class="dv">1000</span>,</span>
<span id="cb35-141"><a href="#cb35-141" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="dv">1</span>,</span>
<span id="cb35-142"><a href="#cb35-142" tabindex="-1"></a>                            <span class="at">calcCorr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-143"><a href="#cb35-143" tabindex="-1"></a>                            <span class="at">geoBias =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb35-144"><a href="#cb35-144" tabindex="-1"></a>                            <span class="at">geoVCov =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb35-145"><a href="#cb35-145" tabindex="-1"></a>  </span>
<span id="cb35-146"><a href="#cb35-146" tabindex="-1"></a>    est14.array[sim, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>MC<span class="sc">$</span>mean</span>
<span id="cb35-147"><a href="#cb35-147" tabindex="-1"></a>    est14.array[sim, <span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>corr<span class="sc">$</span>mean</span>
<span id="cb35-148"><a href="#cb35-148" tabindex="-1"></a>    var14.array[sim, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>MC<span class="sc">$</span>se <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb35-149"><a href="#cb35-149" tabindex="-1"></a>    var14.array[sim, <span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>corr<span class="sc">$</span>se <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb35-150"><a href="#cb35-150" tabindex="-1"></a>    ci14.array[sim, <span class="st">&#39;MC&#39;</span>, ] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>MC<span class="sc">$</span>bcCI</span>
<span id="cb35-151"><a href="#cb35-151" tabindex="-1"></a>    ci14.array[sim, <span class="st">&#39;Mantel&#39;</span>, ] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>corr<span class="sc">$</span>bcCI</span>
<span id="cb35-152"><a href="#cb35-152" tabindex="-1"></a>  }</span>
<span id="cb35-153"><a href="#cb35-153" tabindex="-1"></a>}</span>
<span id="cb35-154"><a href="#cb35-154" tabindex="-1"></a></span>
<span id="cb35-155"><a href="#cb35-155" tabindex="-1"></a><span class="co"># Crude point estimates (bootstrap means are better)</span></span>
<span id="cb35-156"><a href="#cb35-156" tabindex="-1"></a>pointEsts14<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(results14, <span class="cf">function</span>(x) <span class="fu">c</span>(x<span class="sc">$</span>MC<span class="sc">$</span>point, x<span class="sc">$</span>corr<span class="sc">$</span>point)))</span>
<span id="cb35-157"><a href="#cb35-157" tabindex="-1"></a></span>
<span id="cb35-158"><a href="#cb35-158" tabindex="-1"></a><span class="co"># Summarize results</span></span>
<span id="cb35-159"><a href="#cb35-159" tabindex="-1"></a><span class="fu">summary</span>(var14.array)</span>
<span id="cb35-160"><a href="#cb35-160" tabindex="-1"></a>vars14</span>
<span id="cb35-161"><a href="#cb35-161" tabindex="-1"></a><span class="fu">summary</span>(est14.array)</span>
<span id="cb35-162"><a href="#cb35-162" tabindex="-1"></a><span class="fu">summary</span>(pointEsts14<span class="fl">.1</span>)</span>
<span id="cb35-163"><a href="#cb35-163" tabindex="-1"></a>means14</span>
<span id="cb35-164"><a href="#cb35-164" tabindex="-1"></a><span class="fu">colMeans</span>(pointEsts14<span class="fl">.1</span>) <span class="sc">-</span> MC14</span>
<span id="cb35-165"><a href="#cb35-165" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">colMeans</span>((pointEsts14<span class="fl">.1</span> <span class="sc">-</span> MC14)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-166"><a href="#cb35-166" tabindex="-1"></a><span class="fu">summary</span>(ci14.array[, <span class="st">&quot;MC&quot;</span>, <span class="st">&#39;lower&#39;</span>] <span class="sc">&lt;=</span> MC14 <span class="sc">&amp;</span> </span>
<span id="cb35-167"><a href="#cb35-167" tabindex="-1"></a>          ci14.array[, <span class="st">&quot;MC&quot;</span>, <span class="st">&#39;upper&#39;</span>] <span class="sc">&gt;=</span> MC14)</span>
<span id="cb35-168"><a href="#cb35-168" tabindex="-1"></a><span class="fu">summary</span>(ci14.array[, <span class="st">&quot;Mantel&quot;</span>, <span class="st">&#39;lower&#39;</span>] <span class="sc">&lt;=</span> MC14 <span class="sc">&amp;</span> </span>
<span id="cb35-169"><a href="#cb35-169" tabindex="-1"></a>          ci14.array[, <span class="st">&quot;Mantel&quot;</span>, <span class="st">&#39;upper&#39;</span>] <span class="sc">&gt;=</span> MC14)</span>
<span id="cb35-170"><a href="#cb35-170" tabindex="-1"></a></span>
<span id="cb35-171"><a href="#cb35-171" tabindex="-1"></a><span class="co"># Plot histograms of bootstrap estimation results</span></span>
<span id="cb35-172"><a href="#cb35-172" tabindex="-1"></a>est.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&#39;rM&#39;</span>), <span class="dv">2</span>, <span class="at">each =</span> nSims14),</span>
<span id="cb35-173"><a href="#cb35-173" tabindex="-1"></a>                     <span class="at">Quantity =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>), <span class="at">each =</span> <span class="dv">2</span> <span class="sc">*</span> nSims14),</span>
<span id="cb35-174"><a href="#cb35-174" tabindex="-1"></a>                     <span class="at">sim =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nSims14, <span class="dv">4</span>), </span>
<span id="cb35-175"><a href="#cb35-175" tabindex="-1"></a>                     <span class="at">Estimate =</span> <span class="fu">c</span>(est14.array, var14.array))</span>
<span id="cb35-176"><a href="#cb35-176" tabindex="-1"></a></span>
<span id="cb35-177"><a href="#cb35-177" tabindex="-1"></a>trues.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&#39;rM&#39;</span>), <span class="dv">2</span>),</span>
<span id="cb35-178"><a href="#cb35-178" tabindex="-1"></a>                       <span class="at">Quantity =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb35-179"><a href="#cb35-179" tabindex="-1"></a>                       <span class="at">Value =</span> <span class="fu">c</span>(MC14, MC14, vars14))</span>
<span id="cb35-180"><a href="#cb35-180" tabindex="-1"></a></span>
<span id="cb35-181"><a href="#cb35-181" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-182"><a href="#cb35-182" tabindex="-1"></a>g.est <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(est.df, <span class="fu">aes</span>(Estimate)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb35-183"><a href="#cb35-183" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Parameter <span class="sc">~</span> Quantity, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>) <span class="sc">+</span></span>
<span id="cb35-184"><a href="#cb35-184" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> Value), <span class="at">data =</span> trues.df) <span class="sc">+</span></span>
<span id="cb35-185"><a href="#cb35-185" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.002</span>, <span class="fl">0.003</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>))</span>
<span id="cb35-186"><a href="#cb35-186" tabindex="-1"></a></span>
<span id="cb35-187"><a href="#cb35-187" tabindex="-1"></a>g.est</span>
<span id="cb35-188"><a href="#cb35-188" tabindex="-1"></a></span>
<span id="cb35-189"><a href="#cb35-189" tabindex="-1"></a></span>
<span id="cb35-190"><a href="#cb35-190" tabindex="-1"></a><span class="co"># Summary table of bootstrap estimation results</span></span>
<span id="cb35-191"><a href="#cb35-191" tabindex="-1"></a>qualities14 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&#39;rM&#39;</span>), <span class="dv">5</span>),</span>
<span id="cb35-192"><a href="#cb35-192" tabindex="-1"></a>                          <span class="at">Quantity =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)), </span>
<span id="cb35-193"><a href="#cb35-193" tabindex="-1"></a>                                         <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb35-194"><a href="#cb35-194" tabindex="-1"></a>                          <span class="at">Measure =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Bias&#39;</span>, <span class="st">&#39;RMSE&#39;</span>, <span class="st">&quot;Coverage&quot;</span>), </span>
<span id="cb35-195"><a href="#cb35-195" tabindex="-1"></a>                                        <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>)),</span>
<span id="cb35-196"><a href="#cb35-196" tabindex="-1"></a>                          <span class="at">Value =</span> <span class="fu">c</span>(<span class="fu">colMeans</span>(est14.array <span class="sc">-</span> MC14),</span>
<span id="cb35-197"><a href="#cb35-197" tabindex="-1"></a>                                    <span class="fu">colMeans</span>(var14.array) <span class="sc">-</span> vars14,</span>
<span id="cb35-198"><a href="#cb35-198" tabindex="-1"></a>                                    <span class="fu">sqrt</span>(<span class="fu">colMeans</span>((est14.array <span class="sc">-</span> MC14)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb35-199"><a href="#cb35-199" tabindex="-1"></a>                                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((var14.array[,<span class="dv">1</span>]<span class="sc">-</span>vars14[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb35-200"><a href="#cb35-200" tabindex="-1"></a>                                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((var14.array[,<span class="dv">2</span>]<span class="sc">-</span>vars14[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb35-201"><a href="#cb35-201" tabindex="-1"></a>                                    <span class="fu">mean</span>(ci14.array[, <span class="st">&quot;MC&quot;</span>, <span class="st">&#39;lower&#39;</span>] <span class="sc">&lt;=</span> MC14 <span class="sc">&amp;</span> </span>
<span id="cb35-202"><a href="#cb35-202" tabindex="-1"></a>                                         ci14.array[, <span class="st">&quot;MC&quot;</span>, <span class="st">&#39;upper&#39;</span>] <span class="sc">&gt;=</span> MC14),</span>
<span id="cb35-203"><a href="#cb35-203" tabindex="-1"></a>                                    <span class="fu">mean</span>(ci14.array[,<span class="st">&quot;Mantel&quot;</span>,<span class="st">&#39;lower&#39;</span>]<span class="sc">&lt;=</span>MC14 <span class="sc">&amp;</span></span>
<span id="cb35-204"><a href="#cb35-204" tabindex="-1"></a>                                         ci14.array[,<span class="st">&quot;Mantel&quot;</span>,<span class="st">&#39;upper&#39;</span>]<span class="sc">&gt;=</span>MC14)))</span>
<span id="cb35-205"><a href="#cb35-205" tabindex="-1"></a></span>
<span id="cb35-206"><a href="#cb35-206" tabindex="-1"></a><span class="fu">format</span>(qualities14, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>###EXAMPLE 9 <code>estMC</code> Estimate strength of migratory
connectivity incorporating uncertainty from location error associated
with light-level geolocators. Again, we simulated data using the 13th
scenario from example 5 above (“CentroidSampleBreeding4”; make sure you
run examples 5 and 8 code before running this section).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Simulation using error associated with light-level geolocators</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="co"># Assign geolocator bias / variance co-variance matrix</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>geoBias <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10000</span>, <span class="dv">50000</span>)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>geoVCov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.2e+8</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">1.2e+9</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(geoVCov))</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>targLocs14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lapply</span>(targLocs14,</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>                       <span class="at">FUN =</span> <span class="cf">function</span>(x){sf<span class="sc">::</span><span class="fu">st_transform</span>(x, <span class="dv">6933</span>)})</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co"># convert wintering locations to polygons using the helper function</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>WinteringPolys <span class="ot">&lt;-</span> <span class="fu">lapply</span>(winteringPos14,</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>                         toPoly,</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>                         <span class="at">projection.in =</span> <span class="dv">4326</span>, </span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>                         <span class="at">projection.out =</span> <span class="dv">6933</span>)</span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>winteringPolys <span class="ot">&lt;-</span> <span class="fu">lapply</span>(winteringPos14,</span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>                         toPoly,</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>                         <span class="at">projection.in =</span> <span class="dv">4326</span>,</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>                         <span class="at">projection.out =</span> <span class="dv">4326</span>)</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>winteringPolys2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(winteringPos14,</span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>                          toPoly,</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>                          <span class="at">projection.in =</span> <span class="dv">4326</span>,</span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>                          <span class="at">projection.out =</span> <span class="st">&#39;ESRI:54027&#39;</span>)</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a><span class="co"># Double check that the input center points and output polygons are ordered</span></span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a><span class="co"># correctly </span></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a><span class="co">#cbind(breedingPos14[[1]][,1:2],</span></span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a><span class="co">#      t(sapply(slot(breedingPolys[[1]], &quot;polygons&quot;),</span></span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a><span class="co">#               function(x){ slot(x,&quot;labpt&quot;)})))</span></span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a></span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a><span class="co">#cbind(winteringPos14[[1]][,1:2],</span></span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a><span class="co">#      t(sapply(slot(winteringPolys[[1]], &quot;polygons&quot;),</span></span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a><span class="co">#               function(x){ slot(x,&quot;labpt&quot;)})))</span></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a>  </span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a><span class="co"># Simulate capture and non-breeding locations of 100 individuals #</span></span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a></span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a>nSample14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Total number sampled per simulation</span></span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a></span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a><span class="co"># How many sampled from each natural population (sampling scenarios separate</span></span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a><span class="co"># from definition scenarios)</span></span>
<span id="cb36-43"><a href="#cb36-43" tabindex="-1"></a>sampleBreeding14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">round</span>(breedingRelN14[[<span class="dv">1</span>]]<span class="sc">*</span>nSample14<span class="fl">.2</span>),</span>
<span id="cb36-44"><a href="#cb36-44" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>),<span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample14<span class="fl">.2</span>),</span>
<span id="cb36-45"><a href="#cb36-45" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>),<span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">2</span>]<span class="sc">*</span>nSample14<span class="fl">.2</span>),</span>
<span id="cb36-46"><a href="#cb36-46" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">44</span>),<span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">3</span>]<span class="sc">*</span>nSample14<span class="fl">.2</span>),</span>
<span id="cb36-47"><a href="#cb36-47" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>),<span class="fu">round</span>(breedingRelN14[[<span class="dv">5</span>]][<span class="dv">4</span>]<span class="sc">*</span>nSample14<span class="fl">.2</span>),</span>
<span id="cb36-48"><a href="#cb36-48" tabindex="-1"></a>                           <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">22</span>)),</span>
<span id="cb36-49"><a href="#cb36-49" tabindex="-1"></a>                         <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>),</span>
<span id="cb36-50"><a href="#cb36-50" tabindex="-1"></a>                               <span class="fu">rep</span>(<span class="fu">round</span>(breedingRelN14[[<span class="dv">2</span>]][<span class="dv">1</span>]<span class="sc">*</span>nSample14<span class="fl">.2</span><span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb36-51"><a href="#cb36-51" tabindex="-1"></a>                                   <span class="dv">2</span>),</span>
<span id="cb36-52"><a href="#cb36-52" tabindex="-1"></a>                               <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="dv">10</span>))</span>
<span id="cb36-53"><a href="#cb36-53" tabindex="-1"></a></span>
<span id="cb36-54"><a href="#cb36-54" tabindex="-1"></a><span class="fu">lapply</span>(sampleBreeding14<span class="fl">.2</span>, matrix, <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">10</span>)</span>
<span id="cb36-55"><a href="#cb36-55" tabindex="-1"></a></span>
<span id="cb36-56"><a href="#cb36-56" tabindex="-1"></a><span class="co"># Number of simulations to run</span></span>
<span id="cb36-57"><a href="#cb36-57" tabindex="-1"></a>nSims14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb36-58"><a href="#cb36-58" tabindex="-1"></a>nSimsLarge14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb36-59"><a href="#cb36-59" tabindex="-1"></a>nYears <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-60"><a href="#cb36-60" tabindex="-1"></a>nMonths <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-61"><a href="#cb36-61" tabindex="-1"></a></span>
<span id="cb36-62"><a href="#cb36-62" tabindex="-1"></a><span class="co"># Set up data structures for storing results</span></span>
<span id="cb36-63"><a href="#cb36-63" tabindex="-1"></a></span>
<span id="cb36-64"><a href="#cb36-64" tabindex="-1"></a><span class="co">#making an empty list to fill</span></span>
<span id="cb36-65"><a href="#cb36-65" tabindex="-1"></a>animalLoc14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14) </span>
<span id="cb36-66"><a href="#cb36-66" tabindex="-1"></a>sim14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nSimsLarge14<span class="fl">.2</span>) </span>
<span id="cb36-67"><a href="#cb36-67" tabindex="-1"></a></span>
<span id="cb36-68"><a href="#cb36-68" tabindex="-1"></a>compare14.<span class="fl">2.</span>array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSimsLarge14<span class="fl">.2</span>, <span class="dv">2</span>), </span>
<span id="cb36-69"><a href="#cb36-69" tabindex="-1"></a>                           <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSimsLarge14<span class="fl">.2</span>,</span>
<span id="cb36-70"><a href="#cb36-70" tabindex="-1"></a>                                           <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb36-71"><a href="#cb36-71" tabindex="-1"></a></span>
<span id="cb36-72"><a href="#cb36-72" tabindex="-1"></a>results14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nScenarios14)</span>
<span id="cb36-73"><a href="#cb36-73" tabindex="-1"></a>results14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nSimsLarge14<span class="fl">.2</span>)</span>
<span id="cb36-74"><a href="#cb36-74" tabindex="-1"></a>originDist1 <span class="ot">&lt;-</span> targetDist1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nSample14<span class="fl">.2</span>, nSample14<span class="fl">.2</span>)</span>
<span id="cb36-75"><a href="#cb36-75" tabindex="-1"></a>targetDist1[<span class="fu">lower.tri</span>(targetDist1)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-76"><a href="#cb36-76" tabindex="-1"></a>distIndices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(targetDist1), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-77"><a href="#cb36-77" tabindex="-1"></a></span>
<span id="cb36-78"><a href="#cb36-78" tabindex="-1"></a><span class="co"># Run simulations</span></span>
<span id="cb36-79"><a href="#cb36-79" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb36-80"><a href="#cb36-80" tabindex="-1"></a></span>
<span id="cb36-81"><a href="#cb36-81" tabindex="-1"></a><span class="fu">system.time</span>(<span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSimsLarge14<span class="fl">.2</span>) {</span>
<span id="cb36-82"><a href="#cb36-82" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSimsLarge14<span class="fl">.2</span>, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb36-83"><a href="#cb36-83" tabindex="-1"></a>  sim14<span class="fl">.2</span>[[sim]] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sampleBreeding14<span class="fl">.2</span>,</span>
<span id="cb36-84"><a href="#cb36-84" tabindex="-1"></a>                           simMove,</span>
<span id="cb36-85"><a href="#cb36-85" tabindex="-1"></a>                           <span class="at">breedingDist =</span> breedDist14[[<span class="dv">1</span>]],</span>
<span id="cb36-86"><a href="#cb36-86" tabindex="-1"></a>                           <span class="at">winteringDist=</span>nonbreedDist14[[<span class="dv">1</span>]],</span>
<span id="cb36-87"><a href="#cb36-87" tabindex="-1"></a>                           <span class="at">psi=</span>psi,</span>
<span id="cb36-88"><a href="#cb36-88" tabindex="-1"></a>                           <span class="at">nYears=</span>nYears,</span>
<span id="cb36-89"><a href="#cb36-89" tabindex="-1"></a>                           <span class="at">nMonths=</span>nMonths)</span>
<span id="cb36-90"><a href="#cb36-90" tabindex="-1"></a>  </span>
<span id="cb36-91"><a href="#cb36-91" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">13</span>) { <span class="co"># only run one scenario</span></span>
<span id="cb36-92"><a href="#cb36-92" tabindex="-1"></a>  animalLoc14<span class="fl">.0</span> <span class="ot">&lt;-</span> sim14<span class="fl">.2</span>[[sim]][[scenarioToSampleMap14[i]]]<span class="sc">$</span>animalLoc</span>
<span id="cb36-93"><a href="#cb36-93" tabindex="-1"></a>  animalLoc14[[i]] <span class="ot">&lt;-</span> <span class="fu">changeLocations</span>(animalLoc14<span class="fl">.0</span>,</span>
<span id="cb36-94"><a href="#cb36-94" tabindex="-1"></a>                                      breedingSiteTrans14[[i]],</span>
<span id="cb36-95"><a href="#cb36-95" tabindex="-1"></a>                                      winteringSiteTrans14[[i]])</span>
<span id="cb36-96"><a href="#cb36-96" tabindex="-1"></a>  </span>
<span id="cb36-97"><a href="#cb36-97" tabindex="-1"></a>    breedingTruePoints14 <span class="ot">&lt;-</span> capLocs14[[i]][animalLoc14[[i]][,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>], ]</span>
<span id="cb36-98"><a href="#cb36-98" tabindex="-1"></a>    </span>
<span id="cb36-99"><a href="#cb36-99" tabindex="-1"></a>    winteringTruePoints14 <span class="ot">&lt;-</span> targLocs14<span class="fl">.2</span>[[i]][animalLoc14<span class="fl">.0</span>[,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>], ]</span>
<span id="cb36-100"><a href="#cb36-100" tabindex="-1"></a>    </span>
<span id="cb36-101"><a href="#cb36-101" tabindex="-1"></a>    results14<span class="fl">.2</span>[[sim]] <span class="ot">&lt;-</span> <span class="fu">simLocationError</span>(winteringTruePoints14, </span>
<span id="cb36-102"><a href="#cb36-102" tabindex="-1"></a>                                           WinteringPolys[[i]], </span>
<span id="cb36-103"><a href="#cb36-103" tabindex="-1"></a>                                           geoBias,</span>
<span id="cb36-104"><a href="#cb36-104" tabindex="-1"></a>                                           geoVCov,</span>
<span id="cb36-105"><a href="#cb36-105" tabindex="-1"></a>                                           <span class="at">projection =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(winteringTruePoints14))</span>
<span id="cb36-106"><a href="#cb36-106" tabindex="-1"></a>    </span>
<span id="cb36-107"><a href="#cb36-107" tabindex="-1"></a>    animalLoc14<span class="fl">.2</span> <span class="ot">&lt;-</span> animalLoc14[[i]]</span>
<span id="cb36-108"><a href="#cb36-108" tabindex="-1"></a>    </span>
<span id="cb36-109"><a href="#cb36-109" tabindex="-1"></a>    animalLoc14<span class="fl">.2</span>[ , <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> results14<span class="fl">.2</span>[[sim]]<span class="sc">$</span>targetSample</span>
<span id="cb36-110"><a href="#cb36-110" tabindex="-1"></a>    </span>
<span id="cb36-111"><a href="#cb36-111" tabindex="-1"></a>    results14[[i]] <span class="ot">&lt;-</span> <span class="fu">calcPsiMC</span>(breedDist14[[i]], </span>
<span id="cb36-112"><a href="#cb36-112" tabindex="-1"></a>                                nonbreedDist14[[i]],</span>
<span id="cb36-113"><a href="#cb36-113" tabindex="-1"></a>                                animalLoc14<span class="fl">.2</span>,</span>
<span id="cb36-114"><a href="#cb36-114" tabindex="-1"></a>                                <span class="at">originRelAbund =</span> breedingRelN14[[i]],</span>
<span id="cb36-115"><a href="#cb36-115" tabindex="-1"></a>                                <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-116"><a href="#cb36-116" tabindex="-1"></a>    </span>
<span id="cb36-117"><a href="#cb36-117" tabindex="-1"></a>    compare14.<span class="fl">2.</span>array[sim, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results14[[i]]<span class="sc">$</span>MC</span>
<span id="cb36-118"><a href="#cb36-118" tabindex="-1"></a>    </span>
<span id="cb36-119"><a href="#cb36-119" tabindex="-1"></a>    originDist0 <span class="ot">&lt;-</span> geosphere<span class="sc">::</span><span class="fu">distVincentyEllipsoid</span>(</span>
<span id="cb36-120"><a href="#cb36-120" tabindex="-1"></a>                                     <span class="fu">as</span>(breedingTruePoints14[distIndices[,<span class="st">&#39;row&#39;</span>],],<span class="st">&quot;Spatial&quot;</span>),</span>
<span id="cb36-121"><a href="#cb36-121" tabindex="-1"></a>                                     <span class="fu">as</span>(breedingTruePoints14[distIndices[,<span class="st">&#39;col&#39;</span>],],<span class="st">&quot;Spatial&quot;</span>))</span>
<span id="cb36-122"><a href="#cb36-122" tabindex="-1"></a>    </span>
<span id="cb36-123"><a href="#cb36-123" tabindex="-1"></a>    originDist1[<span class="fu">lower.tri</span>(originDist1)] <span class="ot">&lt;-</span> originDist0</span>
<span id="cb36-124"><a href="#cb36-124" tabindex="-1"></a>    </span>
<span id="cb36-125"><a href="#cb36-125" tabindex="-1"></a>    target.point.sample <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(</span>
<span id="cb36-126"><a href="#cb36-126" tabindex="-1"></a>      <span class="fu">data.frame</span>(results14<span class="fl">.2</span>[[sim]]<span class="sc">$</span>targetPointSample),</span>
<span id="cb36-127"><a href="#cb36-127" tabindex="-1"></a>      <span class="at">coords =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb36-128"><a href="#cb36-128" tabindex="-1"></a>      <span class="at">crs =</span> <span class="dv">6933</span>)</span>
<span id="cb36-129"><a href="#cb36-129" tabindex="-1"></a>    </span>
<span id="cb36-130"><a href="#cb36-130" tabindex="-1"></a>    target.point.sample2 <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(target.point.sample, <span class="dv">4326</span>)</span>
<span id="cb36-131"><a href="#cb36-131" tabindex="-1"></a>    </span>
<span id="cb36-132"><a href="#cb36-132" tabindex="-1"></a>    targetDist0 <span class="ot">&lt;-</span>geosphere<span class="sc">::</span><span class="fu">distGeo</span>(<span class="fu">as</span>(target.point.sample2[distIndices[,<span class="st">&#39;row&#39;</span>],],<span class="st">&quot;Spatial&quot;</span>),</span>
<span id="cb36-133"><a href="#cb36-133" tabindex="-1"></a>                                     <span class="fu">as</span>(target.point.sample2[distIndices[,<span class="st">&#39;col&#39;</span>],],<span class="st">&quot;Spatial&quot;</span>))</span>
<span id="cb36-134"><a href="#cb36-134" tabindex="-1"></a>    </span>
<span id="cb36-135"><a href="#cb36-135" tabindex="-1"></a>    targetDist1[<span class="fu">lower.tri</span>(targetDist1)] <span class="ot">&lt;-</span> targetDist0</span>
<span id="cb36-136"><a href="#cb36-136" tabindex="-1"></a>    </span>
<span id="cb36-137"><a href="#cb36-137" tabindex="-1"></a>    compare14.<span class="fl">2.</span>array[sim, <span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> <span class="fu">calcMantel</span>(<span class="at">originDist =</span> originDist1, </span>
<span id="cb36-138"><a href="#cb36-138" tabindex="-1"></a>                                                   <span class="at">targetDist =</span> targetDist1)<span class="sc">$</span>pointCorr</span>
<span id="cb36-139"><a href="#cb36-139" tabindex="-1"></a>  }</span>
<span id="cb36-140"><a href="#cb36-140" tabindex="-1"></a>})</span>
<span id="cb36-141"><a href="#cb36-141" tabindex="-1"></a></span>
<span id="cb36-142"><a href="#cb36-142" tabindex="-1"></a>means14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.<span class="fl">2.</span>array, <span class="dv">2</span>, mean)</span>
<span id="cb36-143"><a href="#cb36-143" tabindex="-1"></a>vars14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.<span class="fl">2.</span>array, <span class="dv">2</span>, var)</span>
<span id="cb36-144"><a href="#cb36-144" tabindex="-1"></a>rmse14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">apply</span>(compare14.<span class="fl">2.</span>array, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">mean</span>((x <span class="sc">-</span> MC14)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb36-145"><a href="#cb36-145" tabindex="-1"></a></span>
<span id="cb36-146"><a href="#cb36-146" tabindex="-1"></a><span class="co"># Set up data structures for storing estimation results</span></span>
<span id="cb36-147"><a href="#cb36-147" tabindex="-1"></a>est14.<span class="fl">2.</span>array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims14<span class="fl">.2</span>, <span class="dv">2</span>), </span>
<span id="cb36-148"><a href="#cb36-148" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims14<span class="fl">.2</span>,</span>
<span id="cb36-149"><a href="#cb36-149" tabindex="-1"></a>                                       <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb36-150"><a href="#cb36-150" tabindex="-1"></a></span>
<span id="cb36-151"><a href="#cb36-151" tabindex="-1"></a>var14.<span class="fl">2.</span>array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims14<span class="fl">.2</span>, <span class="dv">2</span>), </span>
<span id="cb36-152"><a href="#cb36-152" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims14<span class="fl">.2</span>,</span>
<span id="cb36-153"><a href="#cb36-153" tabindex="-1"></a>                                       <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>)))</span>
<span id="cb36-154"><a href="#cb36-154" tabindex="-1"></a></span>
<span id="cb36-155"><a href="#cb36-155" tabindex="-1"></a>ci14.<span class="fl">2.</span>array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(nSims14<span class="fl">.2</span>, <span class="dv">2</span>, <span class="dv">2</span>), </span>
<span id="cb36-156"><a href="#cb36-156" tabindex="-1"></a>                      <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nSims14<span class="fl">.2</span>,</span>
<span id="cb36-157"><a href="#cb36-157" tabindex="-1"></a>                                      <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;Mantel&quot;</span>),</span>
<span id="cb36-158"><a href="#cb36-158" tabindex="-1"></a>                                      <span class="fu">c</span>(<span class="st">&#39;lower&#39;</span>, <span class="st">&#39;upper&#39;</span>)))</span>
<span id="cb36-159"><a href="#cb36-159" tabindex="-1"></a></span>
<span id="cb36-160"><a href="#cb36-160" tabindex="-1"></a>animalLoc14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nSims14<span class="fl">.2</span>) <span class="co">#making an empty list to fill</span></span>
<span id="cb36-161"><a href="#cb36-161" tabindex="-1"></a>results14 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, nSims14<span class="fl">.2</span>)</span>
<span id="cb36-162"><a href="#cb36-162" tabindex="-1"></a></span>
<span id="cb36-163"><a href="#cb36-163" tabindex="-1"></a><span class="co"># Run estimations</span></span>
<span id="cb36-164"><a href="#cb36-164" tabindex="-1"></a></span>
<span id="cb36-165"><a href="#cb36-165" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">567</span>)</span>
<span id="cb36-166"><a href="#cb36-166" tabindex="-1"></a>sim14.<span class="fl">2.</span>sub <span class="ot">&lt;-</span> sim14<span class="fl">.2</span>[<span class="fu">sample.int</span>(nSimsLarge14<span class="fl">.2</span>, nSims14<span class="fl">.2</span>, <span class="cn">TRUE</span>)]</span>
<span id="cb36-167"><a href="#cb36-167" tabindex="-1"></a></span>
<span id="cb36-168"><a href="#cb36-168" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSims14<span class="fl">.2</span>) {</span>
<span id="cb36-169"><a href="#cb36-169" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Estimation&quot;</span>, sim, <span class="st">&quot;of&quot;</span>, nSims14<span class="fl">.2</span>, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb36-170"><a href="#cb36-170" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">13</span>) {</span>
<span id="cb36-171"><a href="#cb36-171" tabindex="-1"></a>  points0 <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(results14<span class="fl">.2</span>[[sim]]<span class="sc">$</span>targetPointSample),</span>
<span id="cb36-172"><a href="#cb36-172" tabindex="-1"></a>                          <span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>),</span>
<span id="cb36-173"><a href="#cb36-173" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="dv">6933</span>)</span>
<span id="cb36-174"><a href="#cb36-174" tabindex="-1"></a>    </span>
<span id="cb36-175"><a href="#cb36-175" tabindex="-1"></a>  points1 <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(points0, <span class="at">crs =</span> <span class="st">&quot;ESRI:54027&quot;</span>)</span>
<span id="cb36-176"><a href="#cb36-176" tabindex="-1"></a>    </span>
<span id="cb36-177"><a href="#cb36-177" tabindex="-1"></a>  animalLoc14[[sim]] <span class="ot">&lt;-</span> <span class="fu">changeLocations</span>(</span>
<span id="cb36-178"><a href="#cb36-178" tabindex="-1"></a>    sim14.<span class="fl">2.</span>sub[[sim]][[scenarioToSampleMap14[i]]]<span class="sc">$</span>animalLoc,</span>
<span id="cb36-179"><a href="#cb36-179" tabindex="-1"></a>                                        breedingSiteTrans14[[i]],</span>
<span id="cb36-180"><a href="#cb36-180" tabindex="-1"></a>                                        winteringSiteTrans14[[i]])</span>
<span id="cb36-181"><a href="#cb36-181" tabindex="-1"></a>  </span>
<span id="cb36-182"><a href="#cb36-182" tabindex="-1"></a>  results14[[sim]] <span class="ot">&lt;-</span> <span class="fu">estMC</span>(<span class="at">originDist =</span> breedDist14[[i]],</span>
<span id="cb36-183"><a href="#cb36-183" tabindex="-1"></a>                            <span class="at">targetDist =</span> nonbreedDist14[[i]],</span>
<span id="cb36-184"><a href="#cb36-184" tabindex="-1"></a>                            <span class="at">originRelAbund =</span> breedingRelN14[[i]],</span>
<span id="cb36-185"><a href="#cb36-185" tabindex="-1"></a>                <span class="at">originPoints =</span> capLocs14[[i]][animalLoc14[[sim]][, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], ],</span>
<span id="cb36-186"><a href="#cb36-186" tabindex="-1"></a>                            <span class="at">targetPoints =</span> points1,</span>
<span id="cb36-187"><a href="#cb36-187" tabindex="-1"></a>                            <span class="at">originAssignment =</span> animalLoc14[[sim]][, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb36-188"><a href="#cb36-188" tabindex="-1"></a>                            <span class="at">targetAssignment =</span> results14<span class="fl">.2</span>[[sim]]<span class="sc">$</span>targetSample,</span>
<span id="cb36-189"><a href="#cb36-189" tabindex="-1"></a>                            <span class="at">nSamples =</span> <span class="dv">1000</span>,</span>
<span id="cb36-190"><a href="#cb36-190" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="dv">0</span>,</span>
<span id="cb36-191"><a href="#cb36-191" tabindex="-1"></a>                            <span class="at">calcCorr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-192"><a href="#cb36-192" tabindex="-1"></a>                            <span class="at">geoBias =</span> geoBias,</span>
<span id="cb36-193"><a href="#cb36-193" tabindex="-1"></a>                            <span class="at">geoVCov =</span> geoVCov,</span>
<span id="cb36-194"><a href="#cb36-194" tabindex="-1"></a>                            <span class="at">isGL =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-195"><a href="#cb36-195" tabindex="-1"></a>                            <span class="at">targetSites =</span> winteringPolys2[[i]], </span>
<span id="cb36-196"><a href="#cb36-196" tabindex="-1"></a>                            <span class="at">maintainLegacyOutput =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-197"><a href="#cb36-197" tabindex="-1"></a>  </span>
<span id="cb36-198"><a href="#cb36-198" tabindex="-1"></a>    est14.<span class="fl">2.</span>array[sim, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>meanMC</span>
<span id="cb36-199"><a href="#cb36-199" tabindex="-1"></a>    </span>
<span id="cb36-200"><a href="#cb36-200" tabindex="-1"></a>    est14.<span class="fl">2.</span>array[sim, <span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>meanCorr</span>
<span id="cb36-201"><a href="#cb36-201" tabindex="-1"></a>    </span>
<span id="cb36-202"><a href="#cb36-202" tabindex="-1"></a>    var14.<span class="fl">2.</span>array[sim, <span class="st">&#39;MC&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>seMC <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb36-203"><a href="#cb36-203" tabindex="-1"></a>    </span>
<span id="cb36-204"><a href="#cb36-204" tabindex="-1"></a>    var14.<span class="fl">2.</span>array[sim, <span class="st">&#39;Mantel&#39;</span>] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>seCorr <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb36-205"><a href="#cb36-205" tabindex="-1"></a>    </span>
<span id="cb36-206"><a href="#cb36-206" tabindex="-1"></a>    ci14.<span class="fl">2.</span>array[sim, <span class="st">&#39;MC&#39;</span>, ] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>bcCI</span>
<span id="cb36-207"><a href="#cb36-207" tabindex="-1"></a>    </span>
<span id="cb36-208"><a href="#cb36-208" tabindex="-1"></a>    ci14.<span class="fl">2.</span>array[sim, <span class="st">&#39;Mantel&#39;</span>, ] <span class="ot">&lt;-</span> results14[[sim]]<span class="sc">$</span>bcCICorr</span>
<span id="cb36-209"><a href="#cb36-209" tabindex="-1"></a>    </span>
<span id="cb36-210"><a href="#cb36-210" tabindex="-1"></a>  }</span>
<span id="cb36-211"><a href="#cb36-211" tabindex="-1"></a>}</span>
<span id="cb36-212"><a href="#cb36-212" tabindex="-1"></a></span>
<span id="cb36-213"><a href="#cb36-213" tabindex="-1"></a>pointEsts14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(results14, <span class="cf">function</span>(x) <span class="fu">c</span>(x<span class="sc">$</span>pointMC, x<span class="sc">$</span>pointCorr)))</span>
<span id="cb36-214"><a href="#cb36-214" tabindex="-1"></a></span>
<span id="cb36-215"><a href="#cb36-215" tabindex="-1"></a><span class="co"># Summarize estimation results</span></span>
<span id="cb36-216"><a href="#cb36-216" tabindex="-1"></a><span class="fu">summary</span>(var14.<span class="fl">2.</span>array)</span>
<span id="cb36-217"><a href="#cb36-217" tabindex="-1"></a>vars14<span class="fl">.2</span></span>
<span id="cb36-218"><a href="#cb36-218" tabindex="-1"></a><span class="fu">summary</span>(est14.<span class="fl">2.</span>array)</span>
<span id="cb36-219"><a href="#cb36-219" tabindex="-1"></a><span class="fu">summary</span>(pointEsts14<span class="fl">.2</span>)</span>
<span id="cb36-220"><a href="#cb36-220" tabindex="-1"></a><span class="fu">colMeans</span>(pointEsts14<span class="fl">.2</span>) <span class="sc">-</span> MC14</span>
<span id="cb36-221"><a href="#cb36-221" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">colMeans</span>((pointEsts14<span class="fl">.2</span> <span class="sc">-</span> MC14)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb36-222"><a href="#cb36-222" tabindex="-1"></a>means14<span class="fl">.2</span></span>
<span id="cb36-223"><a href="#cb36-223" tabindex="-1"></a><span class="fu">mean</span>(ci14.<span class="fl">2.</span>array[, <span class="st">&quot;MC&quot;</span>, <span class="st">&#39;lower&#39;</span>] <span class="sc">&lt;=</span> MC14 <span class="sc">&amp;</span> </span>
<span id="cb36-224"><a href="#cb36-224" tabindex="-1"></a>       ci14.<span class="fl">2.</span>array[, <span class="st">&quot;MC&quot;</span>, <span class="st">&#39;upper&#39;</span>] <span class="sc">&gt;=</span> MC14)</span>
<span id="cb36-225"><a href="#cb36-225" tabindex="-1"></a><span class="fu">mean</span>(ci14.<span class="fl">2.</span>array[, <span class="st">&quot;Mantel&quot;</span>, <span class="st">&#39;lower&#39;</span>] <span class="sc">&lt;=</span> MC14 <span class="sc">&amp;</span> </span>
<span id="cb36-226"><a href="#cb36-226" tabindex="-1"></a>       ci14.<span class="fl">2.</span>array[, <span class="st">&quot;Mantel&quot;</span>, <span class="st">&#39;upper&#39;</span>] <span class="sc">&gt;=</span> MC14)</span>
<span id="cb36-227"><a href="#cb36-227" tabindex="-1"></a><span class="fu">sqrt</span>(vars14<span class="fl">.2</span>) <span class="sc">/</span> MC14</span>
<span id="cb36-228"><a href="#cb36-228" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">sqrt</span>(var14.<span class="fl">2.</span>array)<span class="sc">/</span>est14.<span class="fl">2.</span>array)</span>
<span id="cb36-229"><a href="#cb36-229" tabindex="-1"></a></span>
<span id="cb36-230"><a href="#cb36-230" tabindex="-1"></a><span class="co"># Plot histograms of bootstrap estimation results</span></span>
<span id="cb36-231"><a href="#cb36-231" tabindex="-1"></a>est14.<span class="fl">2.</span>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&#39;rM&#39;</span>), <span class="dv">2</span>, <span class="at">each =</span> nSims14<span class="fl">.2</span>),</span>
<span id="cb36-232"><a href="#cb36-232" tabindex="-1"></a>                     <span class="at">Quantity =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>), </span>
<span id="cb36-233"><a href="#cb36-233" tabindex="-1"></a>                                    <span class="at">each =</span> <span class="dv">2</span> <span class="sc">*</span> nSims14<span class="fl">.2</span>),</span>
<span id="cb36-234"><a href="#cb36-234" tabindex="-1"></a>                     <span class="at">sim =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nSims14<span class="fl">.2</span>, <span class="dv">4</span>), </span>
<span id="cb36-235"><a href="#cb36-235" tabindex="-1"></a>                     <span class="at">Estimate =</span> <span class="fu">c</span>(est14.<span class="fl">2.</span>array, var14.<span class="fl">2.</span>array))</span>
<span id="cb36-236"><a href="#cb36-236" tabindex="-1"></a></span>
<span id="cb36-237"><a href="#cb36-237" tabindex="-1"></a>trues14.<span class="fl">2.</span>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&#39;rM&#39;</span>), <span class="dv">2</span>),</span>
<span id="cb36-238"><a href="#cb36-238" tabindex="-1"></a>                       <span class="at">Quantity =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb36-239"><a href="#cb36-239" tabindex="-1"></a>                       <span class="at">Value =</span> <span class="fu">c</span>(MC14, MC14, vars14<span class="fl">.2</span>))</span>
<span id="cb36-240"><a href="#cb36-240" tabindex="-1"></a></span>
<span id="cb36-241"><a href="#cb36-241" tabindex="-1"></a>g.est <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(est14.<span class="fl">2.</span>df, <span class="fu">aes</span>(Estimate)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb36-242"><a href="#cb36-242" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Parameter <span class="sc">~</span> Quantity, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>) <span class="sc">+</span></span>
<span id="cb36-243"><a href="#cb36-243" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> Value), <span class="at">data =</span> trues14.<span class="fl">2.</span>df) <span class="sc">+</span></span>
<span id="cb36-244"><a href="#cb36-244" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.002</span>, <span class="fl">0.003</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>))</span>
<span id="cb36-245"><a href="#cb36-245" tabindex="-1"></a></span>
<span id="cb36-246"><a href="#cb36-246" tabindex="-1"></a>g.est</span>
<span id="cb36-247"><a href="#cb36-247" tabindex="-1"></a></span>
<span id="cb36-248"><a href="#cb36-248" tabindex="-1"></a></span>
<span id="cb36-249"><a href="#cb36-249" tabindex="-1"></a><span class="co"># Summary table of bootstrap estimation results</span></span>
<span id="cb36-250"><a href="#cb36-250" tabindex="-1"></a>qualities14<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&#39;rM&#39;</span>), <span class="dv">5</span>),</span>
<span id="cb36-251"><a href="#cb36-251" tabindex="-1"></a>                            <span class="at">Quantity =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>), </span>
<span id="cb36-252"><a href="#cb36-252" tabindex="-1"></a>                                               <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)), <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb36-253"><a href="#cb36-253" tabindex="-1"></a>                            <span class="at">Measure =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Bias&#39;</span>, <span class="st">&#39;RMSE&#39;</span>, <span class="st">&quot;Coverage&quot;</span>), </span>
<span id="cb36-254"><a href="#cb36-254" tabindex="-1"></a>                                          <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>)),</span>
<span id="cb36-255"><a href="#cb36-255" tabindex="-1"></a>                            <span class="at">Value =</span> <span class="fu">c</span>(<span class="fu">colMeans</span>(est14.<span class="fl">2.</span>array <span class="sc">-</span> MC14),</span>
<span id="cb36-256"><a href="#cb36-256" tabindex="-1"></a>                                      <span class="fu">colMeans</span>(var14.<span class="fl">2.</span>array) <span class="sc">-</span> vars14<span class="fl">.2</span>,</span>
<span id="cb36-257"><a href="#cb36-257" tabindex="-1"></a>                                      <span class="fu">sqrt</span>(<span class="fu">colMeans</span>((est14.<span class="fl">2.</span>array <span class="sc">-</span> MC14)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb36-258"><a href="#cb36-258" tabindex="-1"></a>                                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((var14.<span class="fl">2.</span>array[,<span class="dv">1</span>] <span class="sc">-</span> </span>
<span id="cb36-259"><a href="#cb36-259" tabindex="-1"></a>                                                   vars14[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb36-260"><a href="#cb36-260" tabindex="-1"></a>                                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((var14.<span class="fl">2.</span>array[,<span class="dv">2</span>] <span class="sc">-</span> </span>
<span id="cb36-261"><a href="#cb36-261" tabindex="-1"></a>                                                   vars14[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb36-262"><a href="#cb36-262" tabindex="-1"></a>                                      <span class="fu">mean</span>(ci14.<span class="fl">2.</span>array[,<span class="st">&quot;MC&quot;</span>,<span class="st">&#39;lower&#39;</span>]<span class="sc">&lt;=</span>MC14 <span class="sc">&amp;</span></span>
<span id="cb36-263"><a href="#cb36-263" tabindex="-1"></a>                                           ci14.<span class="fl">2.</span>array[,<span class="st">&quot;MC&quot;</span>,<span class="st">&#39;upper&#39;</span>]<span class="sc">&gt;=</span>MC14),</span>
<span id="cb36-264"><a href="#cb36-264" tabindex="-1"></a>                              <span class="fu">mean</span>(ci14.<span class="fl">2.</span>array[, <span class="st">&quot;Mantel&quot;</span>, <span class="st">&#39;lower&#39;</span>] <span class="sc">&lt;=</span> MC14 <span class="sc">&amp;</span> </span>
<span id="cb36-265"><a href="#cb36-265" tabindex="-1"></a>                                   ci14.<span class="fl">2.</span>array[, <span class="st">&quot;Mantel&quot;</span>, <span class="st">&#39;upper&#39;</span>] <span class="sc">&gt;=</span> MC14)))</span>
<span id="cb36-266"><a href="#cb36-266" tabindex="-1"></a></span>
<span id="cb36-267"><a href="#cb36-267" tabindex="-1"></a><span class="fu">format</span>(qualities14<span class="fl">.2</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-268"><a href="#cb36-268" tabindex="-1"></a></span>
<span id="cb36-269"><a href="#cb36-269" tabindex="-1"></a></span>
<span id="cb36-270"><a href="#cb36-270" tabindex="-1"></a></span>
<span id="cb36-271"><a href="#cb36-271" tabindex="-1"></a><span class="co"># Make summary table and figures of results with (Example 9) and without </span></span>
<span id="cb36-272"><a href="#cb36-272" tabindex="-1"></a><span class="co"># (Example 8) location error</span></span>
<span id="cb36-273"><a href="#cb36-273" tabindex="-1"></a></span>
<span id="cb36-274"><a href="#cb36-274" tabindex="-1"></a>qualities.all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">DataType =</span> <span class="st">&#39;GPS&#39;</span>, qualities14),</span>
<span id="cb36-275"><a href="#cb36-275" tabindex="-1"></a>                       <span class="fu">data.frame</span>(<span class="at">DataType =</span> <span class="st">&#39;GL&#39;</span>, qualities14<span class="fl">.2</span>))</span>
<span id="cb36-276"><a href="#cb36-276" tabindex="-1"></a></span>
<span id="cb36-277"><a href="#cb36-277" tabindex="-1"></a></span>
<span id="cb36-278"><a href="#cb36-278" tabindex="-1"></a>est14.all.df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">DataType =</span> <span class="st">&#39;GPS&#39;</span>, est.df),</span>
<span id="cb36-279"><a href="#cb36-279" tabindex="-1"></a>                       <span class="fu">data.frame</span>(<span class="at">DataType =</span> <span class="st">&#39;GL&#39;</span>, est14.<span class="fl">2.</span>df))</span>
<span id="cb36-280"><a href="#cb36-280" tabindex="-1"></a></span>
<span id="cb36-281"><a href="#cb36-281" tabindex="-1"></a>trues14.all.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DataType =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;GPS&quot;</span>, <span class="st">&quot;GL&quot;</span>), <span class="dv">2</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb36-282"><a href="#cb36-282" tabindex="-1"></a>                             <span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&#39;rM&#39;</span>), <span class="dv">4</span>),</span>
<span id="cb36-283"><a href="#cb36-283" tabindex="-1"></a>                       <span class="at">Quantity =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Variance&#39;</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb36-284"><a href="#cb36-284" tabindex="-1"></a>                       <span class="at">Value =</span> <span class="fu">c</span>(<span class="fu">rep</span>(MC14, <span class="dv">4</span>), vars14, vars14<span class="fl">.2</span>))</span>
<span id="cb36-285"><a href="#cb36-285" tabindex="-1"></a></span>
<span id="cb36-286"><a href="#cb36-286" tabindex="-1"></a>g.est <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(est14.all.df, <span class="fu">aes</span>(Estimate)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb36-287"><a href="#cb36-287" tabindex="-1"></a>  <span class="fu">facet_grid</span>(DataType <span class="sc">+</span> Parameter <span class="sc">~</span> Quantity, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>) <span class="sc">+</span></span>
<span id="cb36-288"><a href="#cb36-288" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> Value), <span class="at">data =</span> trues14.all.df) <span class="sc">+</span></span>
<span id="cb36-289"><a href="#cb36-289" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.002</span>, <span class="fl">0.003</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>))</span>
<span id="cb36-290"><a href="#cb36-290" tabindex="-1"></a></span>
<span id="cb36-291"><a href="#cb36-291" tabindex="-1"></a>g.est</span></code></pre></div>
<p>###EXAMPLE 10 <code>estMC</code> Estimate strength of migratory
connectivity incorporating uncertainty in estimates of breeding
abundance (see estMC help file)</p>
<p>###EXAMPLE 11 <code>estMC</code> Estimate strength of migratory
connectivity incorporating detection heterogeneity (see estMC help
file)</p>
<p>###EXAMPLE 12 <code>estMC</code> Estimate strength of migratory
connectivity incorporating location uncertainty</p>
<p>Estimates of MC may also be influenced by error in individual
assignment to regions. Data types vary in location accuracy and
precision, which are likely to influence the accuracy with which
individuals are assigned to regions. We measured MC for bootstrapped
data of birds tracked from breeding to non-breeding regions using
light-level and GPS geolocation when 1) GPS location uncertainty was
applied to all individuals, 2) GPS and light-level location uncertainty
were applied to individuals with those devices, and 3) light-level
location uncertainty was applied to all individuals. See Example 2 above
and estMC help file.</p>
<p>###EXAMPLE 13 (from process error simulation in Cohen et
al. 2018)</p>
<p><code>simMove</code> for measuring the influence of dispersal rates
on MC</p>
<p>Long-distance dispersal occurs when individuals that originate or
breed in one population do not return to the same population to breed
the next year. To quantify the sensitivity of MC to dispersal, we used
simulations in which dispersal probability between breeding regions
varied from low to high to measure the sensitivity of MC to
dispersal.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="do">## Simulation ----</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>nBreeding <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>nWintering <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>breedingPos <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">99</span>, <span class="sc">-</span><span class="dv">81</span>, <span class="dv">2</span>), <span class="at">each=</span><span class="fu">sqrt</span>(nBreeding)),</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>                        <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">49</span>, <span class="dv">31</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="fu">sqrt</span>(nBreeding))), nBreeding, <span class="dv">2</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>winteringPos <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">79</span>, <span class="sc">-</span><span class="dv">61</span>, <span class="dv">2</span>), <span class="at">each=</span><span class="fu">sqrt</span>(nWintering)),</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>                         <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">9</span>, <span class="sc">-</span><span class="dv">9</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="fu">sqrt</span>(nWintering))), nWintering, <span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="fu">head</span>(breedingPos)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="fu">tail</span>(breedingPos)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="fu">head</span>(winteringPos)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="fu">tail</span>(winteringPos)</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>breedDist <span class="ot">&lt;-</span> <span class="fu">distFromPos</span>(breedingPos, <span class="st">&#39;ellipsoid&#39;</span>)</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>nonbreedDist <span class="ot">&lt;-</span> <span class="fu">distFromPos</span>(winteringPos, <span class="st">&#39;ellipsoid&#39;</span>)</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="co"># Breeding Abundance</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>breedingN <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">5000</span>, nBreeding)</span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a>breedingRelN <span class="ot">&lt;-</span> breedingN<span class="sc">/</span><span class="fu">sum</span>(breedingN)</span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a><span class="co"># Set up psi matrix</span></span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">optimize</span>(mlogitMC, <span class="at">MC.in =</span> <span class="fl">0.25</span>, <span class="at">origin.dist =</span> breedDist,</span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a>              <span class="at">target.dist =</span> nonbreedDist, <span class="at">origin.abund =</span> breedingRelN,</span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a>              <span class="at">sample.size =</span> <span class="fu">sum</span>(breedingN),</span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a>              <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">tol =</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a>slope <span class="ot">&lt;-</span> o<span class="sc">$</span>minimum</span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">mlogitMat</span>(slope, breedDist)</span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a><span class="co"># Baseline strength of migratory connectivity</span></span>
<span id="cb37-30"><a href="#cb37-30" tabindex="-1"></a>MC <span class="ot">&lt;-</span> <span class="fu">calcMC</span>(breedDist, nonbreedDist, breedingRelN, psi, <span class="fu">sum</span>(breedingN))</span>
<span id="cb37-31"><a href="#cb37-31" tabindex="-1"></a>MC</span>
<span id="cb37-32"><a href="#cb37-32" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" tabindex="-1"></a><span class="co"># Other basic simulation parameters</span></span>
<span id="cb37-34"><a href="#cb37-34" tabindex="-1"></a></span>
<span id="cb37-35"><a href="#cb37-35" tabindex="-1"></a><span class="do">## Dispersal simulations---</span></span>
<span id="cb37-36"><a href="#cb37-36" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1516</span>)</span>
<span id="cb37-37"><a href="#cb37-37" tabindex="-1"></a></span>
<span id="cb37-38"><a href="#cb37-38" tabindex="-1"></a>nYears <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb37-39"><a href="#cb37-39" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" tabindex="-1"></a>nMonths <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># Each season</span></span>
<span id="cb37-41"><a href="#cb37-41" tabindex="-1"></a></span>
<span id="cb37-42"><a href="#cb37-42" tabindex="-1"></a>Drates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.08</span>, <span class="fl">0.16</span>, <span class="fl">0.32</span>, <span class="fl">0.64</span>)    <span class="co">#rates of dispersal</span></span>
<span id="cb37-43"><a href="#cb37-43" tabindex="-1"></a></span>
<span id="cb37-44"><a href="#cb37-44" tabindex="-1"></a>birdLocDisp <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&#39;list&#39;</span>, <span class="fu">length</span>(Drates))</span>
<span id="cb37-45"><a href="#cb37-45" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" tabindex="-1"></a>Disp.df  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Year=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nYears, <span class="fu">length</span>(Drates)),</span>
<span id="cb37-47"><a href="#cb37-47" tabindex="-1"></a>                       <span class="at">Rate=</span><span class="fu">rep</span>(Drates, <span class="at">each =</span> nYears), <span class="at">MC =</span> <span class="cn">NA</span>)</span>
<span id="cb37-48"><a href="#cb37-48" tabindex="-1"></a></span>
<span id="cb37-49"><a href="#cb37-49" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Drates)){</span>
<span id="cb37-50"><a href="#cb37-50" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Dispersal Rate&#39;</span>, Drates[i], <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb37-51"><a href="#cb37-51" tabindex="-1"></a>  birdLocDisp[[i]] <span class="ot">&lt;-</span> <span class="fu">simMove</span>(breedingN, </span>
<span id="cb37-52"><a href="#cb37-52" tabindex="-1"></a>                              breedDist, </span>
<span id="cb37-53"><a href="#cb37-53" tabindex="-1"></a>                              nonbreedDist, </span>
<span id="cb37-54"><a href="#cb37-54" tabindex="-1"></a>                              psi, </span>
<span id="cb37-55"><a href="#cb37-55" tabindex="-1"></a>                              nYears, </span>
<span id="cb37-56"><a href="#cb37-56" tabindex="-1"></a>                              nMonths,</span>
<span id="cb37-57"><a href="#cb37-57" tabindex="-1"></a>                              <span class="at">sumDispRate =</span> Drates[i])</span>
<span id="cb37-58"><a href="#cb37-58" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nYears){</span>
<span id="cb37-59"><a href="#cb37-59" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\t</span><span class="st">Year&#39;</span>, j, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb37-60"><a href="#cb37-60" tabindex="-1"></a>    temp.results <span class="ot">&lt;-</span> <span class="fu">calcPsiMC</span>(breedDist,</span>
<span id="cb37-61"><a href="#cb37-61" tabindex="-1"></a>                              nonbreedDist,</span>
<span id="cb37-62"><a href="#cb37-62" tabindex="-1"></a>                              breedingRelN,</span>
<span id="cb37-63"><a href="#cb37-63" tabindex="-1"></a>                              birdLocDisp[[i]]<span class="sc">$</span>animalLoc,</span>
<span id="cb37-64"><a href="#cb37-64" tabindex="-1"></a>                              <span class="at">years=</span>j,</span>
<span id="cb37-65"><a href="#cb37-65" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-66"><a href="#cb37-66" tabindex="-1"></a>    </span>
<span id="cb37-67"><a href="#cb37-67" tabindex="-1"></a>    Disp.df<span class="sc">$</span>MC[j <span class="sc">+</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> nYears] <span class="ot">&lt;-</span> temp.results<span class="sc">$</span>MC</span>
<span id="cb37-68"><a href="#cb37-68" tabindex="-1"></a>  }</span>
<span id="cb37-69"><a href="#cb37-69" tabindex="-1"></a>} <span class="co"># end i loop</span></span>
<span id="cb37-70"><a href="#cb37-70" tabindex="-1"></a></span>
<span id="cb37-71"><a href="#cb37-71" tabindex="-1"></a>Disp.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> Disp.df<span class="sc">$</span>Year <span class="sc">-</span> <span class="dv">1</span> <span class="co">#just run once!</span></span>
<span id="cb37-72"><a href="#cb37-72" tabindex="-1"></a></span>
<span id="cb37-73"><a href="#cb37-73" tabindex="-1"></a><span class="fu">data.frame</span>(Disp.df, <span class="at">roundMC =</span> <span class="fu">round</span>(Disp.df<span class="sc">$</span>MC, <span class="dv">2</span>), </span>
<span id="cb37-74"><a href="#cb37-74" tabindex="-1"></a>           <span class="at">nearZero =</span> Disp.df<span class="sc">$</span>MC <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb37-75"><a href="#cb37-75" tabindex="-1"></a></span>
<span id="cb37-76"><a href="#cb37-76" tabindex="-1"></a></span>
<span id="cb37-77"><a href="#cb37-77" tabindex="-1"></a><span class="co"># Convert dispersal rates to probabilities of dispersing at least certain distance</span></span>
<span id="cb37-78"><a href="#cb37-78" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-79"><a href="#cb37-79" tabindex="-1"></a>probFarDisp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, nBreeding, <span class="fu">length</span>(Drates), <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, Drates))</span>
<span id="cb37-80"><a href="#cb37-80" tabindex="-1"></a></span>
<span id="cb37-81"><a href="#cb37-81" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Drates)) {</span>
<span id="cb37-82"><a href="#cb37-82" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nBreeding) {</span>
<span id="cb37-83"><a href="#cb37-83" tabindex="-1"></a>    probFarDisp[k, i] <span class="ot">&lt;-</span> </span>
<span id="cb37-84"><a href="#cb37-84" tabindex="-1"></a>      <span class="fu">sum</span>(birdLocDisp[[i]]<span class="sc">$</span>natalDispMat[k, <span class="fu">which</span>(breedDist[k, ]<span class="sc">&gt;=</span> threshold)])</span>
<span id="cb37-85"><a href="#cb37-85" tabindex="-1"></a>  }</span>
<span id="cb37-86"><a href="#cb37-86" tabindex="-1"></a>}</span>
<span id="cb37-87"><a href="#cb37-87" tabindex="-1"></a></span>
<span id="cb37-88"><a href="#cb37-88" tabindex="-1"></a><span class="fu">summary</span>(probFarDisp)</span>
<span id="cb37-89"><a href="#cb37-89" tabindex="-1"></a></span>
<span id="cb37-90"><a href="#cb37-90" tabindex="-1"></a><span class="co">#plot results</span></span>
<span id="cb37-91"><a href="#cb37-91" tabindex="-1"></a>\dontrun{</span>
<span id="cb37-92"><a href="#cb37-92" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb37-93"><a href="#cb37-93" tabindex="-1"></a><span class="fu">require</span>(ggthemes)</span>
<span id="cb37-94"><a href="#cb37-94" tabindex="-1"></a></span>
<span id="cb37-95"><a href="#cb37-95" tabindex="-1"></a>line_set<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>, <span class="fl">1.25</span>, <span class="fl">1.75</span>, <span class="fl">2.25</span>)</span>
<span id="cb37-96"><a href="#cb37-96" tabindex="-1"></a><span class="fu">ggplot</span>(Disp.df, <span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y=</span>MC, <span class="at">size=</span><span class="fu">as.factor</span>(Rate)))<span class="sc">+</span></span>
<span id="cb37-97"><a href="#cb37-97" tabindex="-1"></a> <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb37-98"><a href="#cb37-98" tabindex="-1"></a> <span class="fu">scale_size_manual</span>(<span class="at">values=</span>line_set)<span class="sc">+</span></span>
<span id="cb37-99"><a href="#cb37-99" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">size=</span><span class="st">&quot;Dispersal Rate&quot;</span>)<span class="sc">+</span></span>
<span id="cb37-100"><a href="#cb37-100" tabindex="-1"></a> <span class="fu">scale_y_continuous</span>(<span class="st">&quot;MC&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">005</span>, <span class="fl">0.26</span>), </span>
<span id="cb37-101"><a href="#cb37-101" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb37-102"><a href="#cb37-102" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>))<span class="sc">+</span></span>
<span id="cb37-103"><a href="#cb37-103" tabindex="-1"></a> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb37-104"><a href="#cb37-104" tabindex="-1"></a> <span class="fu">theme</span>(<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>, <span class="at">face =</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb37-105"><a href="#cb37-105" tabindex="-1"></a>       <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb37-106"><a href="#cb37-106" tabindex="-1"></a>       <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">&quot;grey90&quot;</span>),</span>
<span id="cb37-107"><a href="#cb37-107" tabindex="-1"></a>       <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-108"><a href="#cb37-108" tabindex="-1"></a>       <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb37-109"><a href="#cb37-109" tabindex="-1"></a>       <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))</span>
<span id="cb37-110"><a href="#cb37-110" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
